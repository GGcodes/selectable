(function(){define("modules/clean/react/tabs/tabs",["jquery","external/underscore","external/classnames","external/react","modules/clean/react/tabs/tab_bar","modules/clean/react/tabs/tab_util","modules/core/browser"],function(e,t,n,s,r,o,a){var i,l,d,c;return c=s.DOM,i=s.PropTypes,d=s.createClass({displayName:"Tabs",propTypes:{idPrefix:i.string,variant:i.string,selectedIndex:i.number,onChange:i.func,className:i.string},getDefaultProps:function(){return{variant:o.variants.DEFAULT,onChange:function(){}}},getInitialState:function(){var e;return e=this.props.idPrefix?this.props.idPrefix:"tabset"+t.uniqueId(),{selectedIndex:0,idPrefix:e}},componentWillMount:function(){var t,n,r;return r=[],n=this.state.selectedIndex,t=this.state.idPrefix,s.Children.forEach(this.props.children,function(e,s){var a;if(a=o.getTabContentId(t,s),r.push({label:e.props.title,contentId:a,hashPrefix:e.props.hashPrefix,hashURL:e.props.hashURL,rightAlign:e.props.rightAlign}),e.props.isSelected)return n=s}),this.setState({tabs:r,selectedIndex:n}),e(window).on("hashchange",this._selectTabFromHash)},componentWillReceiveProps:function(e){if(void 0!==e.selectedIndex&&e.selectedIndex!==this.state.selectedIndex)return this.setState({selectedIndex:e.selectedIndex})},componentWillUnmount:function(){return e(window).off("hashchange",this._selectTabFromHash)},componentDidMount:function(){return this._selectTabFromHash()},_onChange:function(e,t){var n;return this.setState({selectedIndex:t}),n=this.state.tabs[t],n.hashURL&&a.set_hash(n.hashURL),this.props.onChange(e,t)},_selectTabFromHash:function(){var e,t,n,s,r,o,i,l,d;if(e=a.get_hash(),null!=e){for(d=this.state.tabs,i=[],s=r=0,o=d.length;r<o;s=++r){if(l=d[s],t=l.hashPrefix,n=l.hashURL,null!=t&&0===(null!=e?e.indexOf(t):void 0)||e===n){this.setState({selectedIndex:s});break}i.push(void 0)}return i}},render:function(){return c.div({className:n(this.props.variant,this.props.className)},s.createElement(r,{tabs:this.state.tabs,onChange:this._onChange,idPrefix:this.state.idPrefix,selectedIndex:this.state.selectedIndex}),s.Children.map(this.props.children,(function(e){return function(t,n){return s.cloneElement(t,{isSelected:n===e.state.selectedIndex,id:o.getTabContentId(e.state.idPrefix,n),tabId:o.getTabId(e.state.idPrefix,n)})}})(this)))}}),l=s.createClass({displayName:"TabContent",propTypes:{id:i.string,isSelected:i.bool,tabId:i.string,hashPrefix:i.string,hashURL:i.string,title:i.string},render:function(){var e;return e={"c-tabs__content":!0,"c-tabs__content--selected":this.props.isSelected},c.div({id:this.props.id,className:n(e),role:"tabpanel","aria-labelledby":this.props.tabId},this.props.children)}}),{Tabs:d,TabContent:l}})}).call(this),function(){define("modules/clean/react/tabs/tab_bar",["jquery","external/classnames","external/underscore","external/react","external/react-dom","modules/clean/css","modules/clean/keycode","modules/clean/react/tabs/tab_util"],function(e,t,n,s,r,o,a,i){var l,d;return l=a.KeyCode,d=s.PropTypes,s.createClass({displayName:"TabBar",propTypes:{tabs:d.arrayOf(d.oneOfType([d.string,d.number,d.shape({value:d.oneOfType([d.string,d.number]),label:d.string,rightAlign:d.bool})])).isRequired,selectedIndex:d.number,onChange:d.func,idPrefix:d.string},getDefaultProps:function(){return{selectedIndex:0,onChange:function(){}}},componentDidMount:function(){return this._fixTabWidth()},componentDidUpdate:function(){return this._fixTabWidth()},_cleanUpTabWidth:function(){return e("a",r.findDOMNode(this)).css("width","")},_fixTabWidth:function(){return this._cleanUpTabWidth(),e("a",r.findDOMNode(this)).width(function(){return e(this).width()})},_normalizedTabs:function(){return this.props.tabs.map(function(e){return"string"!=typeof e&&"number"!=typeof e||(e={value:e,label:e}),e})},_onKeydown:function(e){var t,n,s,r;if(r=this._normalizedTabs(),t=null,(n=e.keyCode)===l.LEFT||n===l.UP?t=0===this.props.selectedIndex?r.length-1:this.props.selectedIndex-1:(s=e.keyCode)!==l.RIGHT&&s!==l.DOWN||(t=this.props.selectedIndex===r.length-1?0:this.props.selectedIndex+1),null!=t)return e.preventDefault(),this._selectTab(t,{focusOnTab:!0})},_selectTab:function(e,t){var n;if(null==t&&(t={}),n=this._normalizedTabs()[e],this.props.onChange(n.value,e),t.focusOnTab===!0)return r.findDOMNode(this.refs[e]).focus()},_onClick:function(e,t){if(t.preventDefault(),e!==this.props.selectedIndex)return this._selectTab(e,{focusOnTab:!0})},_renderTab:function(e,n,r){var o,a,l,d,c;return a=t({"c-tabs__tab":!0,"c-tabs__tab--selected":n===this.props.selectedIndex,"c-tabs__tab--fr":e.rightAlign,"c-tabs__tab--rightmost":r}),d=n===this.props.selectedIndex,l=e.contentId?e.contentId:d?i.getTabContentId(this.props.idPrefix):"",c=d?"0":"-1",o=s.createElement("a",{href:"#",ref:n,id:i.getTabId(this.props.idPrefix,n),onClick:this._onClick.bind(this,n),onKeyDown:this._onKeydown,role:"tab","aria-selected":d,"aria-controls":l,tabIndex:c,className:"c-tabs__label"},e.label),s.createElement("li",{key:n,className:a,role:"presentation","data-value":e.value},o)},render:function(){var e,t,n,r;return r=this._normalizedTabs(),t=function(){var t,s,o;for(o=[],e=t=0,s=r.length;t<s;e=++t)n=r[e],o.push(this._renderTab(n,e,e===r.length-1));return o}.call(this),s.createElement("ul",{className:"c-tabs__bar",role:"tablist",ref:"tablist"},t)}})})}.call(this),function(){define("modules/clean/react/tabs/tab_util",[],function(){return{variants:{DEFAULT:"c-tabs",CENTER:"c-tabs c-tabs--center",MINIMAL:"c-tabs c-tabs--minimal",UNDERLINE:"c-tabs--underline",OVERLINE:"c-tabs--overline"},getTabId:function(e,t){return e+"_tab"+(null!=t?t:"")},getTabContentId:function(e,t){return e+"_tabcontent"+(null!=t?t:"")}}})}.call(this),function(){define("modules/clean/react/tabs/tab_nav",["jquery","external/underscore","external/classnames","external/react","modules/clean/react/css","modules/clean/react/tabs/tab_bar","modules/clean/react/tabs/tab_util","modules/clean/react/tabs/tabs"],function(e,t,n,s,r,o,a,i){var l,d,c,p;return d=i.TabContent,p=s.DOM,l=s.PropTypes,c=s.createClass({displayName:"TabNav",propTypes:{tabs:l.arrayOf(l.oneOfType([l.string,l.number,l.shape({value:l.oneOfType([l.string,l.number]),label:l.string,rightAlign:l.bool})])),defaultSelectedIndex:l.number,onChange:l.func,idPrefix:l.string,variant:l.string,className:l.string},getDefaultProps:function(){return{defaultSelectedIndex:0,variant:a.variants.DEFAULT,onChange:function(){}}},getInitialState:function(){return{selectedIndex:this.props.defaultSelectedIndex}},componentWillReceiveProps:function(e){if(this.props.defaultSelectedIndex!==e.defaultSelectedIndex)return this.setState({selectedIndex:e.defaultSelectedIndex})},_onChange:function(e,t){return this.props.onChange(e,t),this.setState({selectedIndex:t})},render:function(){var e;return e=this.props.idPrefix?this.props.idPrefix:"tabset"+t.uniqueId(),p.div({className:n(this.props.variant,this.props.className)},s.createElement(o,{tabs:this.props.tabs,onChange:this._onChange,idPrefix:e,selectedIndex:this.state.selectedIndex}),s.createElement(d,{isSelected:!0,id:a.getTabContentId(e),tabId:a.getTabId(e,this.state.selectedIndex)},this.props.children))}}),r(c,["/static/css/components/tabs-vflVBuar6.css"])})}.call(this),function(){var e={}.hasOwnProperty;define("modules/clean/flux/store_listener",["external/react"],function(t){var n;return n=function(n,s,r){var o;return t.createClass({displayName:"StoreListener("+(null!=(o=n.displayName)?o:"Unknown")+")",getInitialState:function(){return{childProps:r(this.props,s)}},componentDidMount:function(){var t,n;for(n in s)e.call(s,n)&&(t=s[n],t.add_change_listener(this._handleStoreChanged));return this.setState({childProps:r(this.props,s)})},componentWillUnmount:function(){var t,n,r;t=[];for(r in s)e.call(s,r)&&(n=s[r],t.push(n.remove_change_listener(this._handleStoreChanged)));return t},render:function(){var s,r,o,a;s={ref:"wrapped"},o=this.state.childProps;for(r in o)e.call(o,r)&&(a=o[r],s[r]=a);return t.createElement(n,s,this.props.children)},getWrappedComponent:function(){return this.refs.wrapped},getStores:function(){return s},_handleStoreChanged:function(){var e;if(this.isMounted()&&(e=r(this.props,s),null!=e))return this.setState({childProps:e})}})},{listenToStores:n}})}.call(this),function(){define("modules/clean/avatar/triple_avatars",["external/react","modules/clean/ajax","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/overflow_count_pill","modules/clean/avatar/size","modules/clean/react/css","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,s,r,o,a,i,l){var d,c,p,u,h;return d=o.AVATAR_DIMENSION_BY_SIZE,u=e.createElement,h=e.DOM,p=e.createClass({displayName:"TripleAvatars",getPropTypes:function(){return{contacts:e.PropTypes.arrayOf(e.PropTypes.shape({email:e.PropTypes.string,display_name:e.PropTypes.string,photo_url:e.PropTypes.string})),count:e.PropTypes.integer}},getAvatar:function(e){return u(n,{dimension:d.XLARGE,photoUrl:e.photo_url,defaultAvatar:u(s,{dimension:d.XLARGE,shape:"CIRCLE",initials:l.getInitials(e.display_name),name:e.display_name})})},render:function(){var e;return this.props.contacts&&0!==this.props.contacts.length?(e=this.props.contacts.length,this.props.count&&this.props.count>this.props.contacts.length&&(e=this.props.count),h.div({className:"triple-avatars-section"},this.getAvatar(this.props.contacts[0]),this.props.contacts.length>1?this.getAvatar(this.props.contacts[1]):void 0,3===e?this.getAvatar(this.props.contacts[2]):e>3?u(r,{dimension:d.XLARGE,count:e-2}):void 0)):h.div({})}}),c=a(p,["/static/css/scooter/scooter-scoped-vfl0UVTY2.css"]),{TripleAvatars:c}})}.call(this),function(){define("modules/clean/react/bubble",["external/react","external/underscore","modules/clean/css"],function(e,t,n){var s,r;return r=e.DOM,s={TOP:"top",TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM:"bottom",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",RIGHT:"right",RIGHT_TOP:"right-top",RIGHT_BOTTOM:"right-bottom",LEFT:"left",LEFT_TOP:"left-top",LEFT_BOTTOM:"left-bottom"},e.createClass({displayName:"Bubble",statics:{ARROW:s},propTypes:{arrow:e.PropTypes.oneOf(t.values(s)),className:e.PropTypes.string},getDefaultProps:function(){return{arrow:null,className:""}},componentWillMount:function(){if("undefined"!=typeof window&&null!==window)return n.require_css("/static/css/react/bubble_box-vflhusCtq.css")},render:function(){var e,n;return e=["react-bubble-box","react-bubble-box--arrow-"+this.props.arrow,this.props.className],n=t.extend({},t.omit(this.props,["arrow","className"]),{className:e.join(" ")}),r.div(n,this._renderArrow(),this.props.children)},_renderArrow:function(){return null!=this.props.arrow?[r.div({className:"react-bubble-box__arrow-border",key:"arrow-border"}),r.div({className:"react-bubble-box__arrow",key:"arrow"})]:[]}})})}.call(this),function(){define("modules/clean/clipboard",["jquery","modules/clean/static_urls","modules/core/dom","external/swfobject"],function(e,t,n,s){var r,o,a,i,l;return l=t.static_url,o=function(){var e,t;return e=(new Date).getTime(),t=("00000"+Math.floor(1e6*Math.random())).slice(-6),"swf_"+e+"_"+t},a=function(e,t){return e.on("mouseover",function(){return t.addClass("hovered")}),e.on("mousedown",function(){return t.addClass("pressed")}),e.on("mouseout",function(){return t.removeClass("hovered pressed")}),e.on("mouseup",function(){return t.removeClass("pressed")})},i=function(e,t){return window.ClipboardSWFRegister=window.ClipboardSWFRegister||{},window.ClipboardSWFRegister[e]=function(){return t()},"ClipboardSWFRegister."+e},r=function(t,r,d,c){var p,u,h;return null==d&&(d=null),null==c&&(c=null),c=c||e(document.body),h=o(),p=e("<div />",{id:"flash_copy_container"}).append(e("<div />",{id:h})).css({position:"absolute",zIndex:1}),a(p,r),c.append(p),n.clone_position(p,r,{}),u=i(h,d),window.copyLoaded=(function(n){return function(){var n;return n=e("#"+h)[0],n.setCopyText(t),n.setCallbackFunction(u)}})(this),s.embedSWF(l("/static/swf/copy_clipboard-vflvMcZTC.swf"),h,"100%","100%","6.0.65",!1,!1,{wmode:"transparent",scale:"exactfit",allowScriptAccess:"always"}),p},{clipboard_overlay:r}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/clipboard_v2",["jquery","external/flash_detect","external/react","modules/core/browser","modules/core/exception","modules/clean/clipboard"],function(t,n,s,r,o,a){return o.assert,(function(){function s(t,n,s,r){this.copyText=t,this.onSuccess=n,this.onError=s,this.clickHandler=r,this.do_copy=e(this.do_copy,this)}return s.prototype.setupCopy=function(e,n){var r,o,i;if(r=t(n),o=t(e),!s.is_flashless_clipboard_supported())return i=(function(e){return function(){return"function"==typeof e.onSuccess&&e.onSuccess(),"function"==typeof e.clickHandler?e.clickHandler():void 0}})(this),a.clipboard_overlay(this.copyText,o,i,r)},s.prototype.do_copy=function(){var e;if(s.is_supported())return s.is_flashless_clipboard_supported()?(e=document.execCommand("copy",!1),e?"function"==typeof this.onSuccess?this.onSuccess():void 0:"function"==typeof this.onError?this.onError():void 0):void 0},s.is_supported=function(){return s.is_flashless_clipboard_supported()||n.installed},s.is_flashless_clipboard_supported=function(){var e;return e=parseInt(r.version),r.chrome?e>=42:r.mozilla?e>=41:r.opera?e>=29:r.msie?e>=9:!!r.edge||!!r.safari&&e>=10},s})()})}.call(this),function(){define("modules/clean/file_events",[],function(){return{DELETE:"db:bulk_delete",COPY:"db:bulk_copy",MOVE:"db:bulk_move",RENAME:"db:bulk_rename",PURGE:"db:bulk_purge",RESTORE:"db:bulk_restore",UPLOAD:"db:upload",COMPRESS:"db:compress",SF_NEW:"db:sf_new",SF_LEAVE:"db:sf_leave",SF_UNSHARE:"db:sf_unshare",SF_ADD_TO_DROPBOX:"db:sf_add_to_dropbox",SF_INVITE:"db:sf_invite",SF_IGNORE:"db:sf_ignore",LINKS_REMOVE:"db:link_remove",LINKS_ADD:"db:link_add",FILE_ACTIVITY_UPDATE:"db:file_activity_update"}})}.call(this),function(){define("modules/clean/growth/experiments/logger",["modules/clean/ajax"],function(e){return(function(){function t(){}var n,s;return t.start_times={},t.DEFAULT_TIMER_NAME="view_time",t.get_timer_name=function(e){return null==e||"boolean"==typeof e?t.DEFAULT_TIMER_NAME:e},t.set_start_time=function(e){var n;return n=t.get_timer_name(e),t.start_times[n]=Date.now()},t.do_log_view_time=function(e,n){var s;return s=t.get_timer_name(n),e[s]=Math.round((Date.now()-t.start_times[s])/1e3)},s={},n=[5,15,60,120,300],t.start_counter=function(e,t){var r,o,a,i;for(a=[],r=0,o=n.length;r<o;r++)i=n[r],a.push((function(n){return s[e+n]=setTimeout(function(){return t(e,{time_since_first_view:n})},1e3*n)})(i));return a},t.stop_counter=function(e){var t,r,o,a;for(o=[],t=0,r=n.length;t<r;t++)a=n[t],o.push(clearTimeout(s[e+a]));return o},t.log=function(n,s,r,o){switch(null==o&&(o=!1),r=r||{},n){case"paywall_device_limit":return o&&t.do_log_view_time(r,o),e.SilentBackgroundRequest({url:"/growth_paywall_device_limit_log",data:{evt:s,extra:JSON.stringify(r)}});case"paywall_shared_folder":return o&&t.do_log_view_time(r,o),e.SilentBackgroundRequest({url:"/growth_paywall_shared_folder_log",data:{evt:s,extra:JSON.stringify(r)}});case"onboarding":return o&&t.do_log_view_time(r,o),e.SilentBackgroundRequest({url:"/growth_onboarding_log",data:{evt:s,extra:JSON.stringify(r)}});case"sharing":return t.do_log_view_time(r),e.SilentBackgroundRequest({url:"/growth_sharing_log",data:{evt:s,extra:JSON.stringify(r)}});case"post_client_install_tab":return o&&t.do_log_view_time(r,o),e.SilentBackgroundRequest({url:"/growth_post_client_install_tab_log",data:{evt:s,extra:JSON.stringify(r)}});case"secondary_client_link":return o&&t.do_log_view_time(r,o),e.SilentBackgroundRequest({url:"/secondary_client_link_upsell_log",data:{evt:s,extra:JSON.stringify(r)}});case"biz_trial_onboarding":return o&&t.do_log_view_time(r,o),e.SilentBackgroundRequest({url:"/biz_trial_onboarding_log",data:{evt:s,extra:JSON.stringify(r)}});default:throw new Error("Invalid series name")}},t})()})}.call(this),function(){define("modules/clean/growth/experiments/manage_shared_folders_modal",["external/classnames","external/react","external/underscore","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/list","modules/clean/avatar/size","modules/clean/datetime","modules/clean/flux/store_mixin","modules/clean/growth/experiments/sharing_paywall_actions_store","modules/clean/react/css","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react/title_bubble","modules/clean/sharing/member_avatars","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g){var y,b,v,S,I,E,w,C,N,T,P,M,A;return y=a.AVATAR_DIMENSION_BY_SIZE,S=d.ManageSharedFoldersStore,b=d.ManageSharedFoldersActionHandler,E=d.PAGES,P=p.reactFormat,I=u.Modal,M=f.i18n_default_project("growth-exps"),w=M._,A=M.ungettext,N=t.createElement,T=t.DOM,C=t.createClass({displayName:"ManageSharedFoldersModal",propTypes:{maxOwned:t.PropTypes.number.isRequired,numOwned:t.PropTypes.number.isRequired,user:t.PropTypes.object.isRequired,onUnshare:t.PropTypes.func.isRequired},mixins:[l(S)],_get_state_from_stores:function(){return{areFoldersLoaded:S.areFoldersLoaded(),currentPage:S.currentPage(),keepACopy:S.keepACopy(),ownedFolders:S.ownedFolders(),selectedFolderIds:S.selectedFolderIds(),isMembershipLoaded:S.membershipLoaded(),membershipInfoById:S.membershipInfo()}},componentWillMount:function(){return b.initFromProps(this.props),b.fetchOwnedSharedFolders(),b.fetchMembershipData(this.props.user),b.changePage(E.MANAGE_SHARED_FOLDERS)},_handleSelectFolder:function(e){if(this.state.currentPage===E.MANAGE_SHARED_FOLDERS)return this.state.selectedFolderIds.contains(e)?b.unselectFolder(e):b.selectFolder(e)},_handleContinueClick:function(){return b.changePage(E.CONFIRM_UNSHARE)},_handleKeepACopyClick:function(){var e;return e=Boolean(!this.state.keepACopy),b.keepACopy(e)},_handleCancelClick:function(){return b.resetAndCloseModal()},_handleUnshareClick:function(){return b.unshareFoldersSelected(this.state.selectedFolderIds),this.props.onUnshare(this.state.selectedFolderIds,this.state.keepACopy)},_handleUpgradeClick:function(){return b.clickUpgrade()},_renderKeepACopy:function(){var n,s;return s=this.state.keepACopy,n=e({manage_shared_folders_modal__table_checkbox:!0,checked:s}),t.createElement("tr",null,t.createElement("td",{className:"manage_shared_folders_modal__table_keep",colSpan:"2"},t.createElement("button",{role:"checkbox",className:n,onClick:this._handleKeepACopyClick,"aria-checked":s}),t.createElement("div",null,w("Let members keep a copy"))))},_renderFolderTable:function(){var e,s,r;return this.state.areFoldersLoaded?(this.state.currentPage===E.MANAGE_SHARED_FOLDERS?e=this.state.ownedFolders:(e=n.filter(this.state.ownedFolders,(function(e){return function(t){return e.state.selectedFolderIds.contains(t.id)}})(this)),r=this._renderKeepACopy()),e.sort((function(e){return function(e,t){return e.last_active<t.last_active}})(this)),s=e.map((function(e){return function(t){return e._renderFolderRow(t)}})(this))):s=t.createElement("tr",{className:"manage_shared_folders_modal__table_row"},t.createElement("th",{className:"manage_shared_folders_modal__table_loader"},t.createElement("div",{className:"c-loader"},"Loading..."))),t.createElement("table",{className:"manage_shared_folders_modal__table"},t.createElement("tbody",null,t.createElement("thead",null,t.createElement("tr",{className:"manage_shared_folders_modal__table_header"},t.createElement("th",{className:"manage_shared_folders_modal__table_header_item"},w("Shared folders you own")),t.createElement("th",{className:"manage_shared_folders_modal__table_header_item"},w("Shared with")))),t.createElement("tbody",{className:"manage_shared_folders_modal__table_rows"},s),t.createElement("tfoot",null,r)))},_renderFolderRow:function(n){var s,r,a,l,d,c,p,u,m,_,f;return s=null,u=null,f=e({manage_shared_folders_modal__table_row:!0}),this.state.currentPage===E.MANAGE_SHARED_FOLDERS&&(c=this.state.selectedFolderIds.contains(n.id),f=e({manage_shared_folders_modal__table_row:!0,"manage_shared_folders_modal__table_row--selected":c}),r=e({manage_shared_folders_modal__table_checkbox:!0,"manage_shared_folders_modal__folders_row--selected":c,checked:c}),s=t.createElement("button",{role:"checkbox",className:r,"aria-checked":c}),u=i.ago(new Date(n.last_active))),_=e({remove_icon:!0,hidden:!c&&this.state.currentPage!==E.CONFIRM_UNSHARE}),l=t.createElement("div",{className:"manage_shared_folders_modal__table_info"},t.createElement("div",{className:"manage_shared_folders_modal__table_name"},n.name),t.createElement("div",{className:"manage_shared_folders_modal__table_date"},u)),a="--",this.state.isMembershipLoaded&&this.state.membershipInfoById[n.id]&&(m=this.state.membershipInfoById[n.id],p=m.joinedMembers.map((function(e){return function(t){return e._renderAvatar(t.display_name,t.initials,t.photo_url)}})(this)),d=m.invitations.map((function(e){return function(t){return e._renderAvatar(t.email_or_fbname,g.getInitials(t.email_or_fbname))}})(this)),a=N(o,{avatars:p.concat(d),avatarDimension:y.SMALL,maxVisible:7,undisplayableCount:m.numUndisplayableUsersAndInvites})),t.createElement("tr",{className:f,onClick:(function(e){return function(){return e._handleSelectFolder(n.id)}})(this)},t.createElement("td",{className:"manage_shared_folders_modal__table_options"},s,t.createElement("div",{className:"manage_shared_folders_modal__table_icon"},t.createElement(h,{alt:"",group:"web",name:"folder_user_32"}),t.createElement("img",{className:_,width:"16",height:"16",src:"/static/images/growth/experiments/icon-remove-lrg-vflSBVc6s.svg"})),l),t.createElement("td",{className:"manage_shared_folders_modal__table_shared"},a))},_renderAvatar:function(e,t,n){var o,a;return o=w("Shared with %(name)s").format({name:e}),a={alt:o,dimension:y.SMALL,photoUrl:n,defaultAvatar:N(r,{dimension:y.SMALL,alt:o,name:e,initials:t,shape:"CIRCLE"})},this._renderTitleBubble(N(s,a),o)},_renderTitleBubble:function(e,t){return N(m,{content:t,position:m.POSITIONS.BOTTOM,isTargetPositionFixed:!0},e)},_renderUpgradeText:function(){return t.createElement("div",{className:"manage_shared_folders_modal__footer"},P(w("To keep sharing all these folders, <button>upgrade your plan</button>."),{button:t.createElement("button",{className:"button-as-link",onClick:this._handleUpgradeClick})}))},render:function(){var e,t,n,s,r;switch(this.state.currentPage){case E.MANAGE_SHARED_FOLDERS:s=this.props.numOwned-this.props.maxOwned+1,r=A("Unshare at least %(num)s folder","Unshare at least %(num)s folders",s).format({num:s}),n="Next",e=this._handleContinueClick,t=Boolean(s-this.state.selectedFolderIds.size>0);break;case E.CONFIRM_UNSHARE:s=this.state.selectedFolderIds.size,r=A("Unshare this folder?","Unshare these %(num)s folders?",s).format({num:s}),n="Unshare",e=this._handleUnshareClick,t=!1}return N(I,{autoClose:!1,className:"manage_shared_folders_modal",title:r,acceptButtonText:n,onAccept:e,acceptButtonDisabled:t,dismissButtonText:"Cancel",onDismiss:this._handleCancelClick,clickOutToClose:!1,showX:!0},T.div({className:"manage_shared_folders_modal__header"},w("Unshared folders will stay in your Dropbox, but all members will be removed.")),T.div({className:"manage_shared_folders_modal__content"},this._renderFolderTable(),this._renderUpgradeText()))}}),v=c(C,["/static/css/growth/experiments/sharing_paywall_modals-vfl5S3mYn.css"]),{ManageSharedFoldersModal:v}})}.call(this),function(){define("modules/clean/growth/experiments/shared_folder_paywall_view",["external/react","modules/clean/react_format","modules/clean/react/image","modules/clean/sharing/actions/share_modal","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,s,r,o){var a,i,l;return i=t.reactFormat,l=r.static_url,a=o.i18n_default_project("growth-exps")._,e.createElement,e.DOM,e.createClass({displayName:"SharedFolderPaywall",propTypes:{actionHandler:e.PropTypes.instanceOf(s).isRequired,maxOwned:e.PropTypes.number.isRequired,numOwned:e.PropTypes.number.isRequired,onLearnMoreClick:e.PropTypes.func.isRequired,onUpgradeClick:e.PropTypes.func.isRequired,onManageClick:e.PropTypes.func.isRequired},_handleAndLogManageSharedFoldersClick:function(){return this.props.actionHandler.logPaywallEvent("click_manage_shared_folders_from_paywall"),this.props.onManageClick()},_handleAndLogUpgradeClick:function(){return this.props.actionHandler.logPaywallEvent("click_upgrade_from_paywall"),this.props.onUpgradeClick()},render:function(){return e.createElement("div",{className:"paywall-blocker unified-share-modal__no-permission u-pad-l u-pad-bottom-l"},e.createElement(n,{className:"paywall-blocker__image u-mar-bottom-s",src:l("/static/images/sharing/db_shared_folder-vflK0RLgD.png"),srcHiRes:l("/static/images/sharing/db_shared_folder@2x-vflEd6s7Z.png")}),e.createElement("div",{className:"paywall-blocker__infotext"},a("You own %(folder_count)s shared folders (max is %(max)s).").format({folder_count:this.props.numOwned,max:this.props.maxOwned})),e.createElement("button",{className:"c-btn c-btn--primary u-mar-bottom-s",onClick:this._handleAndLogUpgradeClick},a("Upgrade for unlimited sharing")),e.createElement("div",null,i(a("<manage>Manage your shared folders</manage> or <learn>learn more</learn>"),{manage:e.createElement("button",{className:"paywall-blocker__link button-as-link",onClick:this._handleAndLogManageSharedFoldersClick}),learn:e.createElement("button",{className:"paywall-blocker__link button-as-link",onClick:this.props.onLearnMoreClick})})))}})})}.call(this),function(){var e=function(e,n){function s(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return s.prototype=n.prototype,e.prototype=new s,e.__super__=n.prototype,e},t={}.hasOwnProperty,n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/growth/experiments/sharing_paywall_actions_store",["external/immutable","external/react","external/underscore","modules/clean/api_v2/root_aware_client","modules/clean/flux/base_store","modules/clean/flux/dispatcher","modules/clean/growth/experiments/logger","modules/clean/sharing/api/client","modules/clean/ajax","modules/core/browser"],function(t,s,r,o,a,i,l,d,c,p){var u,h,m,_,f,g,y,b,v;return t.OrderedSet,v=t.Set,u=o.ApiV2RootAwareClient,h=d.FolderShareApiClient,y={MANAGE_SHARED_FOLDERS:"MANAGE_SHARED_FOLDERS",CONFIRM_UNSHARE:"CONFIRM_UNSHARE"},m=7,f={FETCH_OWNED_SF_REQUEST:"FETCH_OWNED_SF_REQUEST",FETCH_OWNED_SF_SUCCESS:"FETCH_OWNED_SF_SUCCESS",CHANGE_PAGE:"CHANGE_PAGE",SELECT_FOLDER:"SELECT_FOLDER",FETCH_MEMBERSHIP_REQUEST:"FETCH_MEMBERSHIP_REQUEST",FETCH_MEMBERSHIP_SUCCESS:"FETCH_MEMBERSHIP_SUCCESS",UNSELECT_FOLDER:"UNSELECT_FOLDER",UNSHARE_FOLDERS:"UNSHARE_FOLDERS",CLICK_UPGRADE:"CLICK_UPGRADE",TOGGLE_KEEP_A_COPY:"TOGGLE_KEEP_A_COPY",CLOSE_MODAL:"CLOSE_MODAL"},b="paywall_shared_folder",_=(function(){function e(){}return e.initFromProps=function(e){return this._client=new h({userId:e.user.id,client:new u})},e.fetchOwnedSharedFolders=function(){return i.dispatch({type:f.FETCH_OWNED_SF_REQUEST}),this._client.getOwnedSharedFolders().then(function(e){return i.dispatch({type:f.FETCH_OWNED_SF_SUCCESS,data:e})})},e.fetchMembershipData=function(e){return i.dispatch({type:f.FETCH_MEMBERSHIP_REQUEST}),c.WebRequest({url:"/share_ajax/shared_with",dataType:"json",subject_user:e,data:{max_results:m,fq_path_prefix:"",include_inherited:!1},success:function(e){return i.dispatch({type:f.FETCH_MEMBERSHIP_SUCCESS,data:e})}})},e.changePage=function(e){return i.dispatch({type:f.CHANGE_PAGE,data:e})},e.selectFolder=function(e){return i.dispatch({type:f.SELECT_FOLDER,data:e})},e.unselectFolder=function(e){return i.dispatch({type:f.UNSELECT_FOLDER,data:e})},e.unshareFoldersSelected=function(e){return i.dispatch({type:f.UNSHARE_FOLDERS,data:e})},e.clickUpgrade=function(){return i.dispatch({type:f.CLICK_UPGRADE})},e.keepACopy=function(e){return i.dispatch({type:f.TOGGLE_KEEP_A_COPY,data:e})},e.resetAndCloseModal=function(){return i.dispatch({type:f.CLOSE_MODAL})},e})(),g=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return e(s,t),s.prototype._init=function(){return this._selectedFolderIds=v(),this._keepACopy=!0,this._currentPage=y.MANAGE_SHARED_FOLDERS},s.prototype._clear=function(){return this._selectedFolderIds=v(),this._keepACopy=!0,this._currentPage=y.MANAGE_SHARED_FOLDERS},s.prototype._setOwnedSharedFolders=function(e){return this._ownedFolders=e,this.emit_change()},s.prototype._setFoldersLoaded=function(e){return this._areFoldersLoaded=e,this.emit_change()},s.prototype._setCurrentPage=function(e){return this._currentPage=e,this.emit_change()},s.prototype._setMembershipList=function(e){var t,s,r,o,a,i,l;for(r=this._ownedFolders.map(function(e){return e.id}),l={},t=0,s=e.length;t<s;t++)i=e[t],a=i.ns_id,n.call(r,a)>=0&&(o={numUndisplayableUsersAndInvites:i.num_avatars_not_shown,groups:i.groups,invitations:i.invitations,joinedMembers:i.joined_members,audienceDescription:i.audience_description},l[i.ns_id]=o);return this._membershipInfoById=l,this.emit_change()},s.prototype._setMembershipLoaded=function(e){return this._membershipLoaded=e,this.emit_change()},s.prototype._selectFolderId=function(e){return this._selectedFolderIds=this._selectedFolderIds.add(e),this.emit_change()},s.prototype._unselectFolderId=function(e){return this._selectedFolderIds=this._selectedFolderIds.delete(e),this.emit_change()},s.prototype._setKeepACopy=function(e){return this._keepACopy=e,this.emit_change()},s.prototype._logPaywallEvent=function(e,t){return t=t||{},t.num_folders_owned=this._ownedFolders.length,l.log(b,e,t)},s.prototype._logUnshareAction=function(){return this._logPaywallEvent("click_unshare",{num_folders_to_unshare:this._selectedFolderIds.size})},s.prototype._logUpgradeClick=function(){this._currentPage===y.MANAGE_SHARED_FOLDERS?this._logPaywallEvent("click_upgrade_from_manage_folders"):this._logPaywallEvent("click_upgrade_from_confirm_unshare")},s.prototype.ownedFolders=function(){return this._ownedFolders},s.prototype.areFoldersLoaded=function(){return this._areFoldersLoaded},s.prototype.currentPage=function(){return this._currentPage},s.prototype.membershipInfo=function(){return this._membershipInfoById},s.prototype.membershipLoaded=function(){return this._membershipLoaded},s.prototype.selectedFolderIds=function(){return this._selectedFolderIds},s.prototype.keepACopy=function(){return this._keepACopy},s.prototype._new_payload=function(e){var t;switch(t=e.action.data,e.action.type){case f.CHANGE_PAGE:return t===y.CONFIRM_UNSHARE&&this._logPaywallEvent("view_confirm_unshare_modal"),this._setCurrentPage(t);case f.CLICK_UPGRADE:return this._logUpgradeClick(),p.redirect("/upgrade?oqa=spw");case f.CLOSE_MODAL:return this._clear();case f.FETCH_MEMBERSHIP_REQUEST:return this._setMembershipLoaded(!1);case f.FETCH_MEMBERSHIP_SUCCESS:return this._setMembershipList(t),this._setMembershipLoaded(!0);case f.FETCH_OWNED_SF_REQUEST:return this._setFoldersLoaded(!1);case f.FETCH_OWNED_SF_SUCCESS:return this._setOwnedSharedFolders(t.entries),this._setFoldersLoaded(!0);case f.SELECT_FOLDER:return this._selectFolderId(t);case f.TOGGLE_KEEP_A_COPY:return this._setKeepACopy(t);case f.UNSELECT_FOLDER:return this._unselectFolderId(t);case f.UNSHARE_FOLDERS:return this._logUnshareAction(),this._clear()}},s})(a),{ManageSharedFoldersStore:new g,ManageSharedFoldersActionHandler:_,PAGES:y,PAYWALL_SERIES_LOGGING_NAME:b}})}.call(this),function(){define("modules/clean/growth/experiments/sharing_paywall_info_modal",["external/classnames","external/react","modules/clean/react_format","modules/clean/react/button","modules/clean/react/css","modules/clean/react/modal","modules/clean/sharing/actions/share_modal","modules/clean/viewer","modules/core/browser","modules/core/i18n"],function(e,t,n,s,r,o,a,i,l,d){var c,p,u,h,m,_,f,g;return g=n.reactFormat,c=s.Button,p=o.Modal,h=d._,_=t.createElement,f=t.DOM,i.get_viewer(),m=t.createClass({
displayName:"SharingPaywallInfoModal",propTypes:function(){return{actionHandler:t.PropTypes.instanceOf(a).isRequired,sharedFolderCount:t.PropTypes.number,grandfather:t.PropTypes.boolean,onDismiss:t.PropTypes.func,onManage:t.PropTypes.func}},_handleAndLogLearnMoreClick:function(){return this.props.actionHandler.logPaywallEvent("click_learn_more_from_grandfathered_notice"),this.navigateToHelpCenterArticle()},_handleAndLogNotNowClick:function(){return this.props.actionHandler.logPaywallEvent("click_not_now_from_grandfathered_notice"),this.props.onDismiss()},_handleAndLogManageSharedFoldersClick:function(){return this.props.actionHandler.logPaywallEvent("click_manage_shared_folders_from_grandfathered_notice"),this.props.onManage()},_handleAndLogUpgradeClick:function(){return this.props.grandfather?this.props.actionHandler.logPaywallEvent("click_upgrade_from_grandfathered_notice"):this.props.actionHandler.logPaywallEvent("click_upgrade_from_learn_more"),this.navigateToUpgradePage()},render:function(){var n;return n=e({"sharing-paywall-info-modal":!0,"sharing-paywall-grandfather":this.props.grandfather}),t.createElement(p,{className:n,buttonComponent:this.renderButtons(),style:"clean"},f.div({className:"sharing-paywall-info-modal__content"},f.img({src:"/static/images/sharing/db_shared_folder-vflK0RLgD.png",className:"sharing-paywall-info-modal__content_image"}),f.div({className:"sharing-paywall-info-modal__content_header"},this.getHeader()),f.div({className:"sharing-paywall-info-modal__content_subheader"},this.getSubheader())))},renderButtons:function(){return this.props.grandfather?f.div({className:"db-modal-buttons"},f.div({},_(c,{key:"primary",className:"dbmodal-button",importance:"primary",disabled:!1,onClick:this._handleAndLogUpgradeClick},h("Upgrade your Dropbox")),_(c,{key:"tertiary",className:"dbmodal-button",importance:"tertiary",disabled:!1,onClick:this._handleAndLogNotNowClick},h("Not now"))),f.div({},f.button({className:"button-as-link",onClick:this._handleAndLogManageSharedFoldersClick},h("Manage your shared folders")))):f.div({className:"db-modal-buttons"},_(c,{key:"primary",className:"dbmodal-button",importance:"primary",disabled:!1,onClick:this._handleAndLogUpgradeClick},h("Upgrade for unlimited sharing")))},getHeader:function(){return h(this.props.grandfather?"Shared folder limits have changed":"You can own 5 shared folders at a time")},getSubheader:function(){return this.props.grandfather?f.span({},f.div({},h("Now you can only own 5 shared folders with Dropbox Basic. Since you have  %(count)s, you’ll need to unshare some folders or upgrade.").format({count:this.props.sharedFolderCount}),g(h(" <learn>Learn more</learn>"),{learn:f.button({className:"button-as-link inline-link",onClick:this._handleAndLogLearnMoreClick})}))):f.span({},f.div({},h("Creating and sharing a folder makes you the owner, which gives you more  control over who can access it. Folders people have shared with you don’t  count towards your 5-folder limit.")))},navigateToHelpCenterArticle:function(){return l.open_tab("/help/9264")},navigateToUpgradePage:function(){return l.redirect("/upgrade?oqa=spw")}}),u=r(m,["/static/css/scooter/scooter-scoped-vfl0UVTY2.css","/static/css/growth/experiments/sharing_paywall_info_modal-vflke5gnX.css"]),{SharingPaywallInfoModal:u}})}.call(this),function(){var e=function(e,n){function s(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return s.prototype=n.prototype,e.prototype=new s,e.__super__=n.prototype,e},t={}.hasOwnProperty,n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/browse/shared_with",["jquery","external/react","external/react-dom","external/underscore","modules/core/i18n","modules/core/user_i18n","modules/clean/ajax","modules/clean/avatar/size","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/flux/dispatcher","modules/clean/flux/store_mixin","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/react/sharing/shared_with_view","modules/clean/sharing/api","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/share_modal_util","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/ui_util","modules/clean/file_events","modules/clean/web_timing_logger","modules/core/dom"],function(t,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,E,w,C,N,T,P,M){var A,k,F,x,L,R,O,D,U,B,q,H,V,G,W,K,Y,z,j,Q,X,J,Z,$,ee,te,ne;return a._,k=d.AVATAR_DIMENSION_BY_SIZE,F=m.BrowseActionTypes,m.FileTypes,q=m.LoadingStates,W=m.SharedWithActionTypes,x=_.BrowseContext,R=_.File,L=f.BrowseStore,Q=g.SharedWithView,J=y.SharingApi,O=b.FileShareApiClient,D=b.FolderShareApiClient,V=v.MemberCounts,Z=S.TRUELINK,te=I.shouldUsePublicFolderSharing,ne=E.showShareModal,ee=w.sharingInfoStore,X=C.SharingActions,$=s.createElement,H=5,U=3,A=5,B=100,G=100,"file_row_sharing_menu",j=(function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initializeWith=function(e){var t,n;return n=e.path,t=e.files,this._browseInitializeEverything({path:n,files:t})},n.prototype._init=function(){return this._sharedFolderDataByTargetNs={},this._sharedFolderMemberCountsByTargetNs={},this._sharedLinkDataMapsByFolderFQPath={},this._filesWeHaveSharedLinkDataFor={},this._sharedFileDataByFileId={},this._hasSharedDataLoadedByContainingPath={}},n.prototype.hasLinkDataForFile=function(e){return e.fq_path in this._filesWeHaveSharedLinkDataFor},n.prototype.clearSharedLinkDataCache=function(){return this._filesWeHaveSharedLinkDataFor={}},n.prototype.getDataForFile=function(e){var t,n,s;return t=null,null!=e.target_ns&&(t=this._sharedFolderDataByTargetNs[e.target_ns]),this._canBeSharedFile(e)&&(t=this._sharedFileDataByFileId[null!=(n=e.file_id)?n:e.fq_path]),s=this._getSharedLinkInfoByFile(e),s?(t||(t={}),t.sharedLinkInfo=s):null!=t&&delete t.sharedLinkInfo,t||(t={}),t.inheritedMemberCounts=this._getMemberCounts(),t.hasSharedDataLoaded=this._getHasSharedDataLoaded(),t},n.prototype.getAudienceBoxDataForFile=function(e){var t,n,s,r,a,i,l,d,c,p,u,h;return e&&!e.target_ns&&this._canBeSharedFile(e)?(t=this._sharedFileDataByFileId[null!=(a=e.file_id)?a:e.fq_path]||{},s=this._sharedFolderDataByTargetNs[L.context().currentNSID]||{},r={},(null!=(i=t.joinedMembers)?i.length:void 0)||(null!=(l=t.groups)?l.length:void 0)||(null!=(d=t.invitations)?d.length:void 0)||(r.audienceDescription=s.audienceDescription),r.groups=o.uniq(o.union(t.groups,s.groups),!1,function(e){return e.gid}),r.invitations=o.uniq(o.union(t.invitations,s.invitations),!1,function(e){return e.invitation_id}),r.joinedMembers=o.uniq(o.union(t.joinedMembers,s.joinedMembers),!1,function(e){return e.user_id}),r.numUndisplayableUsersAndInvites=(t.numUndisplayableUsersAndInvites||0)+(s.numUndisplayableUsersAndInvites||0),n=s.memberCount||0,n+=((null!=(c=t.joinedMembers)?c.length:void 0)||0)+((null!=(p=t.invitations)?p.length:void 0)||0)+(t.numUndisplayableUsersAndInvites||0),n+=(null!=(u=t.groups)?u.map(function(e){return e.num_users||1}).reduce(function(e,t){return e+t},0):void 0)||0,r.memberCount=n):r=e&&e.target_ns?this._sharedFolderDataByTargetNs[e.target_ns]:this._sharedFolderDataByTargetNs[L.context().currentNSID],h=this._getSharedLinkInfoByFile(e),h?(r||(r={}),r.sharedLinkInfo=h):null!=r&&delete r.sharedLinkInfo,r||(r={}),r.hasSharedDataLoaded=this._getHasSharedDataLoaded(),r},n.prototype._getSharedLinkInfoByFile=function(e){var t,n,s;return t=L.path(),s=this._sharedLinkDataMapsByFolderFQPath[t],s&&e&&(n=s[this._sharedLinkKey(e)]),n},n.prototype._sharedLinkKey=function(e){return e.fq_path+"_"+e.ns_id+"_"+e.sjid},n.prototype._new_payload=function(e){switch(e.action.type){case F.LOAD_PATH:return this._pathLoaded(e.action.data);case F.ADD_FILES:return this._filesAdded(e.action.data);case F.INITIALIZE_EVERYTHING:return this._browseInitializeEverything(e.action.data);case F.CHANGE_FILES:return this._filesChanged(e.action.data);case W.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE:return this._signalSharedFileDataOutOfDate(e.action.data);case W.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE:return this._signalSharedFolderDataOutOfDate(e.action.data);case W.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE:return this._signalSharedLinkDataOutOfDate(e.action.data);case W.SET_SHARED_FOLDER_DATA:return this._setNSSharedWithData(e.action.data);case W.SET_MEMBER_COUNTS_FOR_NS:return this._setMemberCountsForNs(e.action.data);case W.SET_SHARED_LINK_DATA:return this._setSharedLinkData(e.action.data);case W.SET_SHARED_FILE_DATA:return this._setSharedFileData(e.action.data);case W.CLEAR_SHARED_FOLDER_DATA_FOR_NS:return this._clearSharedFolderDataForNs(e.action.data);case W.REMOVE_SHARED_LINK_DATA:return this._removeSharedLinkData(e.action.data)}},n.prototype._fillInMissingSharedLinkData=function(e){var t,n,s,r,o,a,i;for(i=e.parentPath,s=e.files,r=[],o=0,a=s.length;o<a;o++)n=s[o],this.hasLinkDataForFile(n)||(this._filesWeHaveSharedLinkDataFor[n.fq_path]=!0,r.push(n));return K.loadLinkDataForFiles({parentPath:i,fileFqPaths:(function(){var e,n,s;for(s=[],e=0,n=r.length;e<n;e++)t=r[e],s.push(t.fq_path);return s})()}),K.loadLinkMetadata(r)},n.prototype._getMemberCounts=function(){var e;return e=L.context().currentNSID,e in this._sharedFolderMemberCountsByTargetNs?this._sharedFolderMemberCountsByTargetNs[e]:new V},n.prototype._getHasSharedDataLoaded=function(){var e;return e=L.path(),e in this._hasSharedDataLoadedByContainingPath&&this._hasSharedDataLoadedByContainingPath[e]},n.prototype._setHasSharedDataLoaded=function(e){var t;return t=L.path(),this._hasSharedDataLoadedByContainingPath[t]=e},n.prototype._canBeSharedFile=function(e){return!(e.is_dir||e.isDeleted)},n.prototype._loadSharedFileData=function(e){var t,n,s,r,o,a;for(s=(null!=e?e:{invalidateCache:!1}).invalidateCache,s&&(this._sharedFileDataByFileId={}),n=[],a=L.files().toArray(),r=0,o=a.length;r<o;r++)t=a[r],!this._canBeSharedFile(t)||t.file_id in this._sharedFileDataByFileId||n.push(t.file_id);return K.loadSharedFileDataForFiles({fileIds:n})},n.prototype._pathLoaded=function(e){var t,n;return t=e.files,n=e.path,this._setHasSharedDataLoaded(!1),K.loadMemberCountsForContainingNs(),K.loadSFDataForPath({parentPath:n,abortCurrentRequest:!0}),this._loadSharedFileData({invalidateCache:!0}),this._filesAdded({files:t,path:n})},n.prototype._filesAdded=function(e){var t,n;return t=e.files,n=e.path,this._fillInMissingSharedLinkData({parentPath:n,files:t}),this._loadSharedFileData()},n.prototype._filesChanged=function(e){var t,n,s;if(s=e.path,n=e.fileDeltas,s===L.path()&&null!=n&&n.length)return u.waitFor([L.dispatchToken]),K.loadSFDataForPath({parentPath:s}),this.clearSharedLinkDataCache(),t=L.files().toArray(),this._fillInMissingSharedLinkData({parentPath:s,files:t}),this._loadSharedFileData({invalidateCache:!0})},n.prototype._signalSharedFileDataOutOfDate=function(e){var t;return t=e.fileIds,K.loadSharedFileDataForFiles({fileIds:t})},n.prototype._signalSharedFolderDataOutOfDate=function(e){var t;return t=e.parentPath,null==t&&(t=L.path()),K.loadMemberCountsForContainingNs(),K.loadSFDataForPath({parentPath:t})},n.prototype._signalSharedLinkDataOutOfDate=function(e){var t,n;return n=e.parentPath,t=e.fileFqPaths,null==n&&(n=L.path()),K.loadLinkDataForFiles({parentPath:n,fileFqPaths:t})},n.prototype._setNSSharedWithData=function(e){var t,n;return n=e.sharedFolderData,t=e.containingPath,this._sharedFolderDataByTargetNs=n,this._hasSharedDataLoadedByContainingPath[t]=!0,this.emit_change()},n.prototype._setMemberCountsForNs=function(e){var t,n;return n=e.targetNs,t=e.memberCounts,this._sharedFolderMemberCountsByTargetNs[n]=t,this.emit_change()},n.prototype._setSharedLinkData=function(e){var t,n,s,r,o,a,i,l;for(r=e.parentPath,a=e.sharedLinkData,l=this._sharedLinkDataMapsByFolderFQPath[r]||{},n=0,s=a.length;n<s;n++)o=a[n],t=o.file,i=o.sharedLinkToken,l[this._sharedLinkKey(t)]=i;return this._sharedLinkDataMapsByFolderFQPath[r]=l,this.emit_change()},n.prototype._setSharedFileData=function(e){var t;return t=e.sharedFileData,o.extend(this._sharedFileDataByFileId,t),this.emit_change()},n.prototype._clearSharedFolderDataForNs=function(e){var t;return t=e.targetNs,this._sharedFolderDataByTargetNs[t]=void 0,this.emit_change()},n.prototype._browseInitializeEverything=function(e){var t,n;return n=e.path,t=e.files,K.loadMemberCountsForContainingNs(),K.loadSFDataForPath({parentPath:n}),this._filesAdded({path:n,files:t})},n.prototype._removeSharedLinkData=function(e){var t,n,s,r,o,a;for(o=e.parentPath,n=e.files,a=this._sharedLinkDataMapsByFolderFQPath[o]||{},s=0,r=n.length;s<r;s++)t=n[s],a[this._sharedLinkKey(t)]=void 0;return this._sharedLinkDataMapsByFolderFQPath[o]=a,this.emit_change()},n})(p),z=new j,t(document).on(J.REQUEST_SUCCEEDED_EVENT,function(e,t){var n;return n=t.request_url,n.indexOf("/share_ajax/leave")>-1?u.dispatch({type:W.CLEAR_SHARED_FOLDER_DATA_FOR_NS,data:{targetNs:t.ns_id}}):u.dispatch({type:W.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE,data:{parentPath:L.path()}})}),K=(function(){function e(){}return e.loadLinkMetadata=function(e){var t,n,s,r,o,a;if(a=L.user(),Z.TRUELINK_BROWSE_LINK_ICON[a.id]&&Z.TRUELINK_UI[a.id])return t=5,s=e.filter(function(e){return e.is_dir}).map(function(e){return"ns:"+e.ns_id+e.ns_path}),o=function(){var e;if(0!==s.length)return e=s.slice(0,t),s=s.slice(t),X.loadFolderLinkMetadataBatch(a,e).then(o)},n=e.filter(function(e){return!e.is_dir}).map(function(e){return e.file_id||e.fq_path}),r=function(){var e;if(0!==n.length)return e=n.slice(0,t),n=n.slice(t),X.loadFileMetadataBatch(a,e).then(r)},o(),r()},e.loadSFDataForPath=function(e){var t,n,s,r,o,a;return s=e.parentPath,t=null!=(r=e.abortCurrentRequest)&&r,a=L.user(),n=L.context().isNonUserRelativeContext,t&&null!=(o=this._currentSFDataRequest)&&o.abort(),this._currentSFDataRequest=l.WebRequest({url:"/share_ajax/shared_with",dataType:"json",subject_user:a,data:{max_results:H,fq_path_prefix:s,include_inherited:N.GoldenGate.hasAudienceBox(a.id),admin_console:n?"true":void 0,sort_by_name:N.GoldenGate.hasNewMembershipUI(a.id)},success:function(e){var t,n,r,o,a;for(a={},t=0,n=e.length;t<n;t++)o=e[t],r={numUndisplayableUsersAndInvites:o.num_avatars_not_shown,groups:o.groups,invitations:o.invitations,joinedMembers:o.joined_members,audienceDescription:o.audience_description,memberCount:o.num_users_and_invites},a[o.ns_id]=r;return u.dispatch({type:W.SET_SHARED_FOLDER_DATA,data:{sharedFolderData:a,containingPath:s}})},complete:(function(e){return function(){return e._currentSFDataRequest=null}})(this)})},e.loadMemberCountsForContainingNs=function(){var e,t,n,s;if(s=L.user(),n=L.context(),n.isNonUserRelativeContext&&(t=n.rootNSID?n.currentNSID:void 0,s.is_email_verified&&t))return e=new D({userId:s.id,isNonUserRelativeContext:n.isNonUserRelativeContext}),e.getMemberCounts({contentId:t}).then(function(e){return u.dispatch({type:W.SET_MEMBER_COUNTS_FOR_NS,data:{memberCounts:e,targetNs:t}})})},e.loadSharedFileDataForFiles=function(e){var t,n,s,r;if(n=e.fileIds,r=L.user(),r.is_email_verified)return t=new O({userId:r.id}),(s=function(e){var n,r,o;if(0!==e.length)return o=e.slice(0,G),n=e.slice(G),r=t.listMembersBatch({contentIds:o,limit:H}),r.then(function(e){var t;if(t={},e.forEach(function(e,n){return t[n]={numUndisplayableUsersAndInvites:0,groups:e.groups.valueSeq().map(N.apiGroupMemberToAvatarInfo).toArray(),invitations:e.invitees.valueSeq().map(N.apiInviteeMemberToAvatarInfo).toArray(),joinedMembers:e.users.valueSeq().map(N.apiUserMemberToAvatarInfo).toArray()}}),u.dispatch({type:W.SET_SHARED_FILE_DATA,data:{sharedFileData:t}}),n)return s(n)})})(n)},e.loadLinkDataForFiles=function(e){var t,s,r,o;if(s=e.parentPath,t=e.fileFqPaths,!Z.TRUELINK_UI[L.user().id])return o=L.user(),(r=function(e){var t,a;if(0!==e.length)return a=e.slice(0,B),t=e.slice(B),l.SilentBackgroundRequest({url:"/sm/get_token_info",dataType:"json",data:{paths:JSON.stringify(a)},subject_user:o,success:function(e){var o,i,l,d,c,p,h,m,_,f,g;for(l=L.filesMap(),_=[],h=e.shmodels,d=0,c=h.length;d<c;d++)g=h[d],g.disabled||(o=l.get(g.path),o&&_.push({file:o,sharedLinkToken:g}));if(_.length&&u.dispatch({type:W.SET_SHARED_LINK_DATA,data:{parentPath:s,sharedLinkData:_}}),f=(function(){var t,n,s,r;for(s=e.shmodels,r=[],t=0,n=s.length;t<n;t++)m=s[t],r.push(m.path);return r})(),i=(function(){var e,t,s;for(s=[],e=0,t=a.length;e<t;e++)p=a[e],n.call(f,p)>=0||s.push(l.get(p));return s})().filter(function(e){return null!=e}),i.length&&u.dispatch({type:W.REMOVE_SHARED_LINK_DATA,data:{parentPath:s,files:i}}),t)return r(t)}})})(t)},e})(),Y=s.createClass({displayName:"SharedWithController",mixins:[h(z,ee,L)],propTypes:{browseContext:s.PropTypes.instanceOf(x).isRequired,file:s.PropTypes.instanceOf(R),isInAudienceBox:s.PropTypes.bool,isMaestroDesign:s.PropTypes.bool,inSelectMode:s.PropTypes.bool,tabIndex:s.PropTypes.oneOf([0,-1]),actionHandlers:s.PropTypes.object},getDefaultProps:function(){return{isMaestroDesign:!0}},_get_state_from_stores:function(e){var t,n,s,r,o,a,i,l,d,c,p,u,h,m,_;return _=L.user().id,s=null!=(r=this.props.browseContext)?r.isNonUserRelativeContext:void 0,t=!N.GoldenGate.hasAudienceBox(_)||s&&!this.props.isMaestroDesign?z.getDataForFile(e.file):z.getAudienceBoxDataForFile(e.file),m=ee.getSharingInfo(_,null!=(o=e.file)?o.fq_path:void 0),n=L.loadingState()===q.LOADING_FIRST_PAGE,{audienceDescription:null!=t?t.audienceDescription:void 0,numUndisplayableUsersAndInvites:null!=(a=null!=t?t.numUndisplayableUsersAndInvites:void 0)?a:0,numInheritedMembers:null!=(i=null!=t&&null!=(l=t.inheritedMemberCounts)?l.total_unique_users:void 0)?i:0,groups:null!=(d=null!=t?t.groups:void 0)?d:[],hasSharedDataLoaded:(null!=t?t.hasSharedDataLoaded:void 0)&&!n,invitations:null!=(c=null!=t?t.invitations:void 0)?c:[],joinedMembers:null!=(p=null!=t?t.joinedMembers:void 0)?p:[],memberCount:null!=(u=null!=t?t.memberCount:void 0)?u:null,sharedLinkInfo:null!=(h=null!=t?t.sharedLinkInfo:void 0)?h:null,linkMetadata:null!=m?m.linkMetadata():void 0}},componentDidUpdate:function(){var e,t,n,s,o;if(null!=this.props.tabIndex){for(t=M.getFocusableElementsIn(r.findDOMNode(this),!1),o=[],n=0,s=t.length;n<s;n++)e=t[n],o.push(e.tabIndex=this.props.tabIndex);return o}},componentWillReceiveProps:function(e){return this.setState(this._get_state_from_stores(e))},_showSharingModal:function(){var e,t,n,s,r;if((null!=this.props.file||!L.context().isCurrentlyInRoot)&&(null==this.props.file||!R.isTeamMemberFolder(this.props.file))&&(null==this.props.file||R.canViewFileMembers(this.props.file,L.context())))return t=[L.user(),this.props.file?this.props.file:L.context()],r=t[0],e=t[1],this.props.browseContext.isNonUserRelativeContext&&null!=(null!=(n=this.props.actionHandlers)?n.onManage:void 0)?null!=(s=this.props.actionHandlers)?s.onManage(this.props.file):void 0:ne(r,e,{browseContext:this.props.browseContext,origin:"BROWSE_FILE_ROW"})},handleOverflowCountClick:function(){return this._showSharingModal()},handleAvatarClick:function(){return this._showSharingModal()},handleSharedLinkClick:function(){return ne(L.user(),this.props.file,{browseContext:this.props.browseContext,origin:"BROWSE_FILE_ROW"})},_getMaxVisibleAvatars:function(){return this.props.isMaestroDesign?A:N.GoldenGate.hasNewMembershipUI(L.user().id)?this.props.browseContext.isInsideSharedFolder?U:U+1:H},render:function(){var e,t,n,s,r,o,a;return t=L.context(),a=L.user(),t.isCurrentlyInRoot&&null==this.props.file&&!a.is_cdm_member?null:(t.isNonUserRelativeContext?(n=!t.rootNSID&&N.GoldenGate.hasContentManagerCdm(a.id),s=this.props.file.fq_path.split("/")[1]):(n=!1,s=t.getNameOfTargetFolder()),e=this.props.file?R.canViewFileMembers(this.props.file,t):t.canViewContainingNSMembers,$(Q,{user:L.user(),file:this.props.file,onOverflowCountClick:this.handleOverflowCountClick,onAvatarClick:this.handleAvatarClick,groups:this.state.groups,invitations:this.state.invitations,joinedMembers:this.state.joinedMembers,numUndisplayableUsersAndInvites:this.state.numUndisplayableUsersAndInvites,memberCount:this.state.memberCount,numInheritedMembers:this.state.numInheritedMembers,parentFolderName:s,animation:!1,avatarDimension:this.props.isInAudienceBox?k.MEDIUM:void 0,maxVisibleAvatars:this._getMaxVisibleAvatars(),sharedLinkInfo:this.state.sharedLinkInfo,onSharedLinkClick:this.handleSharedLinkClick,publicFolderSharing:this.props.file&&te(null!=(r=null!=(o=this.props.browseContext)?o.config:void 0)?r:{},this.props.file.fq_path),isMaestroDesign:this.props.isMaestroDesign,inSelectMode:this.props.inSelectMode,isInAudienceBox:this.props.isInAudienceBox,audienceDescription:this.state.audienceDescription,hasSharedDataLoaded:this.state.hasSharedDataLoaded,canViewMembers:e&&!t.isInsideDeletedFolder,inContentManagerCdmRoot:n,linkMetadata:this.state.linkMetadata}))}}),{SharedWithActions:K,SharedWithController:Y,SharedWithStore:z}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/content_manager/api",["jquery","external/underscore","modules/clean/analytics","modules/clean/ajax","modules/clean/react/browse/constants","modules/clean/filepath","modules/clean/history","modules/clean/pagination_manager","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/sort_helpers","modules/clean/react/browse/store","modules/clean/sharing/api/util/types","modules/clean/sharing/ui_util","modules/clean/teams/admin/api/admin_console_api_client","modules/clean/viewer","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/constants/browse","modules/constants/viewer","require"],function(t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,E,w){var C,N,T,P,M,A,k,F,x,L,R,O,D,U,B,q,H,V,G,W,K,Y,z,j,Q,X,J,Z,$,ee,te,ne,se,re,oe;return P=s.ContentManagerActionsLogger,o.LoadingStates,M=c.FileTypes,p.Config,p.BrowseContext,V=u.compare,T=h.BrowseStore,h.File,Y=m.folderMetadataApiToRecord,A=_.GoldenGate,N=f.AdminConsoleApiClient,O=b._,ne=b.ungettext,D=function(e){return{fq_path:"/"+e.name,href:"/work/"+e.name,is_dir:!0,bytes:0,target_ns:e.team_folder_id,icon:q[e.status[".tag"]],team_folder_status:e.status[".tag"],type:M.TEAM_SHARED_FOLDER}},C="undefined"!=typeof window&&null!==window?t(window):null,R=180,x=new RegExp('([\\u0000-\\u001F]|\\\\|\\/|:|\\?|\\*|<|>|\\"|\\|)'),k=new RegExp('([\\u0000-\\u001F]|\\\\|\\/|:|\\?|\\*|\\"|\\|)'),L=new RegExp("[\\ufffe-\\uffff\\ud800-\\udfff]"),F=[".",".."],re=function(t){return""===t?"":t.length>255?O("The folder name should be under 255 characters"):e.call(F,t)>=0?O("The names dot (.) and dot dot (..) are’t allowed"):x.test(t)?O("The following characters aren’t allowed: \\ / : ? * < > ” |"):L.test(t)?O("The folder name contains invalid characters"):null},se=function(e){return""===e?"":e.length>255?O("The file name should be under 255 characters"):k.test(e)?O("The following characters aren’t allowed: \\ / : ? * ” |"):L.test(e)?O("The file name contains invalid characters"):null},U=function(e,t){var n,s,r,o;for(o=[],n=0,r=e.length;n<r;n++)s=e[n],o.push(s.fq_path="/"+t+s.fq_path);return o},B=function(){var e;return e=A.hasContentManagerCdmInTSD(T.user().id),new N(isCMforCDM=e,flashError=!1)},Q=function(e){var t,s,o,a,i,l,d,c,p,u,h,m,_;return d=e.path,_=e.userId,h=e.sortFoldersFirst,o=e.includeDeletedFiles,a=e.nsId,l=e.onSuccess,i=e.onError,t=A.hasContentManagerCdmInTSD(_),s=B(),"/"!==d||t?(c=d.split("/"),p=c[1],u=t?1:2,m="/"+c.slice(u).join("/"),r.WebRequest({data:{show_deleted:o||"",admin_console:!0,ns_id:a,sort_folders_first:h},url:S({path:"/browse"+m}),subject_user:_,success:function(e){try{n.isString(e)&&(e=JSON.parse(e)),t||(e.paginated?U(e.first_page.items,p):U(e.file_info,p)),C.scrollTop(0),l({path:d,data:e})}catch(e){}},error:function(e,t,n){return"function"==typeof i?i(e,t,n):void 0}})):s.teamFoldersList().then(function(e){var t,n,s;return e.team_folders=e.team_folders.sort(function(e,t){return V(e.name.toUpperCase(),t.name.toUpperCase(),1)}),n=(function(){var t,n,r,o;for(r=e.team_folders,o=[],t=0,n=r.length;t<n;t++)s=r[t],o.push(D(s));return o})(),t={file_info:n,paginated:!1,inside_auto_team_folder:!0,is_non_user_relative_context:!0},l({path:d,data:t})}).catch(function(e){if(!e.headers)throw e;return"function"==typeof i?i(e.headers,e.raw.status,e.raw.responseBody):void 0})},G=function(e){var t,n,s,r,o,a;return r=e.files,o=e.newPath,e.userId,e.onSuccess,t=w("modules/clean/react/browse/actions"),n=B(),s=T.context(),a=s.rootNSID,v.info(O("Copying files...",R)),n.bulkFileCopy(a,r,o).then(function(e){var n;return v.success(O("Copy completed.")),t.setPath({path:T.path(),nsId:s.rootNSID}),n=1===r.length?"copy":"copyBatch",H(n)}).catch(function(e){var t;return"cant_copy_shared_folder"===(null!=(t=e.error)?t[".tag"]:void 0)?v.error(O("Copying a shared folder isn’t supported for beta.")):v.error(O("There was a problem completing this request."))})},K=function(e){var t,n,s,r;return r=e.files,s=e.context,t=w("modules/clean/react/browse/actions"),n=B(),v.info(O("Deleting files...",R)),n.bulkFileDelete(r).then(function(e){var n;return n=ne("Deleted %d item.","Deleted %d items.",r.length).format(r.length),v.success(n),t.setPath({path:T.path(),nsId:s.rootNSID}),H(1===r.length?r[0].is_dir?"deleteFolder":"deleteFile":"deleteBatch")}).catch(function(e){return v.error(O("There was a problem completing this request."))})},Z=function(e){var t,n,s,r,o,a,i;return o=e.file,e.userId,e.onSuccess,i=e.onError,a=e.newName,t=w("modules/clean/react/browse/actions"),s=T.context(),(r=o.is_dir?re(a):se(a))?(v.error(r),void i()):(n=B(),n.fileRename(o.ns_id,o.ns_path,a).then(function(e){return o.is_dir?v.success(O("Folder renamed.")):v.success(O("File renamed.")),t.setPath({path:T.path(),nsId:s.rootNSID}),H("rename")}).catch(function(e){return v.error(O("There was a problem completing this request."))}))},X=function(e){var t,n,s,r,o,a;return e.path,r=e.files,o=e.newPath,e.userId,e.onSuccess,t=w("modules/clean/react/browse/actions"),n=B(),s=T.context(),a=s.rootNSID,v.info(O("Moving files...",R)),n.bulkFileMove(a,r,o).then(function(e){var n;return v.success(O("Move completed.")),t.setPath({path:T.path(),nsId:s.rootNSID}),n=1===r.length?"move":"moveBatch",H(n)}).catch(function(e){var t;return"cant_move_folder_into_itself"===(null!=(t=e.error)?t[".tag"]:void 0)?v.error(O("Moving a folder into itself isn’t allowed.")):v.error(O("There was a problem completing this request."))})},z=function(e){throw e.path,e.userId,e.namespaceToJournalIdMap,e.includeDeletedFiles,e.onSuccess,new Error("Not Implemented")},W=function(e){var t,n,s,r,o,a,i,l;return l=e.pathName,r=e.folderName,o=e.nsId,e.userId,i=e.onSuccess,a=e.onError,t=w("modules/clean/react/browse/actions"),(s=re(r))?(v.error(s),void a()):(n=B(),n.folderCreate(o,l,r).then(function(e){var n;return v.success(O("Folder created.")),n={fq_path:"/"+r},i({changesets:null,createdFolder:n}),t.setPath({path:T.path(),nsId:o}),H("createFolder")}).catch(function(e){var t,n,s,r;return a(),"path"===(null!=(t=e.error)?t[".tag"]:void 0)&&"disallowed_name"===(null!=(n=e.error.path)?n[".tag"]:void 0)?v.error(O("The folder name is invalid.")):"path"===(null!=(s=e.error)?s[".tag"]:void 0)&&"conflict"===(null!=(r=e.error.path)?r[".tag"]:void 0)?v.error(O("A folder with the same name exists.")):v.error(O("Failed to create the folder."))}))},te=function(e){var t,n,s,r,o;return n=e.nsId,s=e.nsPath,o=e.policyUpdate,r=e.onSuccess,e.onError,t=new B,t.shareFolder(n,s,o).then(Y).then(r)},oe=function(e){var t,n,s,r,o;return r=e.nsId,o=e.nsPath,t=e.actions,s=e.listMembersArg,H("validateFolderPath"),n=B(),n.validateFolderPath(r,o,t,s)},$=function(e,t,n,s){var r;return r=B(),r.restoreFile(e,t,n).then(s)},J=function(e,t,n){var s;return s=B(),s.permanentDeleteFile(e,t).then(n)},H=function(e){return P.log(T.context().rootNSID,e)},q={},ee=function(e){return q=e},j=function(e){return"/"===e.path&&!A.hasContentManagerCdmInTSD(e.user.id)},{validateFolderName:re,loadPath:Q,renameFile:Z,copyFiles:G,deleteFiles:K,moveFiles:X,getChangesForDirectory:z,setIcons:ee,createNewFolder:W,shareFolder:te,validateFolderPath:oe,restoreFile:$,permanentDeleteFile:J,isInCMGoldenGateRoot:j}})}.call(this),define("modules/clean/react/exp_overquota_modal",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/image","modules/clean/react/modal","modules/clean/react/exp_overquota_modal_content"],function(e,t,n,s,r,o,a,i){"use strict";var l=(function(e){function t(t){var n=e.call(this,t)||this;return n.oqContent=i.OQContent[n.props.expOverquotaFileActionVariant],n._handleDismiss=n._handleDismiss.bind(n),n}return n.__extends(t,e),t.prototype._handleDismiss=function(){a.Modal.close()},t.prototype._renderButtons=function(){return s.createElement(a.ModalButtons,{className:"oq-modal__buttons"},s.createElement("a",{href:this.oqContent.redirectURL,id:"oq-cta-button",className:"mc-button mc-button-primary"},this.oqContent.acceptButtonText))},t.prototype._renderContentTitle=function(){return s.createElement("p",{className:"oq-modal__content--title"},this.oqContent.title)},t.prototype._renderImage=function(){return this.oqContent.image?s.createElement(o,{src:this.oqContent.image.image,srcHiRes:this.oqContent.image.imageHiRes}):null},t.prototype.render=function(){return s.createElement(a.Modal,{className:"exp_overquota_modal",title:this.oqContent.title,buttonComponent:this._renderButtons(),showX:this.oqContent.showX},s.createElement("div",{className:"oq-modal__content"},this._renderImage(),this._renderContentTitle(),s.createElement("p",null,this.oqContent.content)))},t})(s.Component);t.ExpOverquotaModalElement=l,t.ExpOverquotaModal=r(l,["/static/css/react/exp_overquota_modal-vfluow1Vx.css"])}),define("modules/clean/react/exp_overquota_modal_content",["require","exports","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,s){"use strict";t.OQContent={V3:{title:s._("Your Dropbox is full"),content:s._("Before you can update or move your files, you need more space."),image:{image:n.static_url("/static/images/pro/overquota/overquota-folder-vflgFxxXj.png"),imageHiRes:n.static_url("/static/images/pro/overquota/overquota-folder@2x-vfloUmya6.png")},acceptButtonText:s._("Get more space"),redirectURL:"/pro/out-of-space?oqa=upl_f",showX:!0}}}),function(){define("modules/clean/react/file_modal_controller",["external/react","external/underscore","modules/clean/filepath","modules/clean/react/browse/api","modules/clean/react/css","modules/clean/react/file_modals","modules/clean/react/modal","modules/clean/react/exp_overquota_modal"],function(e,t,n,s,r,o,a,i){var l,d,c,p,u,h,m,_,f,g,y,b,v;return m=o.FileTransferModal,b=o.RestoreFilesModal,y=o.PermanentlyDeleteModal,d=o.DeleteFileModal,c=o.ExpDeleteFileModal,p=o.ExpOQDeleteFileModal,l=o.ContentManagerBridgeModal,f=o.NoAccessFolderModal,_=a.Modal,u=i.ExpOverquotaModal,v=e.createElement,g={COPY:"copy",MOVE:"move"},h=(function(){function e(){}return e.showCopy=function(e,t,n){var s,r,o,a,i,l,d;return o=null!=(i=n.onSuccess)?i:null,a=null!=(l=n.onUndo)?l:null,r=null!=(d=n.onRequestNotSent)?d:null,s=v(m,{files:t,operation:g.COPY,user:e,onSuccess:o,onUndo:a,onRequestNotSent:r}),_.showInstance(s)},e.showMove=function(e,t,n,s){var r,o,a,i,l,d,c;return a=null!=(l=s.onSuccess)?l:null,i=null!=(d=s.onUndo)?d:null,o=null!=(c=s.onRequestNotSent)?c:null,r=v(m,{files:t,path:n,operation:g.MOVE,user:e,onSuccess:a,onUndo:i,onRequestNotSent:o}),_.showInstance(r)},e.showOverquota=function(e){var t;return t=v(u,{expOverquotaFileActionVariant:e}),_.showInstance(t)},e.showRestore=function(e,t,n){var s;return s=v(b,{files:t,userId:e.id,onSuccess:n}),_.showInstance(s)},e.showPermanentlyDelete=function(e,t,n){var s;return s=v(y,{files:t,userId:e.id,onSuccess:n}),_.showInstance(s)},e.showDelete=function(e,t,s,r,o,a){var i,l,u
;return null==o&&(o=null),null==a&&(a=!1),l=n.filename(s.currentFQPath),u=s.isInsideSharedFolder,i="V1"===o||"V2"===o?v(c,{files:t,user:e,parentSharedFolderName:u?l:null,onUndo:r,expOQProVariant:o}):a?v(p,{files:t,user:e,parentSharedFolderName:u?l:null,onUndo:r,expSubgrowthBizWebClientOQDelete:a}):v(d,{files:t,user:e,parentSharedFolderName:u?l:null,onUndo:r}),_.showInstance(i)},e.showContentManagerBridge=function(e,t,n){var s;return s=v(l,{files:e,type:t,isLimitedTeam:n}),_.showInstance(s)},e.showNoAccess=function(e,t,s){var r;return r=v(f,{folderName:n.filename(t.fq_path),userIsSameTeam:e.team_dbtid&&s.teamFolderOwnerTeamApiId&&e.team_dbtid===s.teamFolderOwnerTeamApiId}),_.showInstance(r)},e})(),{FileModalController:h}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function s(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},n={}.hasOwnProperty;define("modules/clean/react/file_modals",["external/react","external/react-dom","external/underscore","modules/clean/em_string","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/render_partials","modules/clean/react/browse/store","modules/clean/react/content_manager/api","modules/clean/react/css","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/tree_view","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/sharing/constants","modules/clean/sharing/browse_exports","modules/clean/user","modules/clean/viewer","modules/core/browser","modules/core/html","modules/core/i18n","modules/core/uri","modules/constants/python"],function(n,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,E,w,C,N){var T,P,M,A,k,F,x,L,R,O,D,U,B,q,H,V,G,W,K,Y,z,j,Q,X,J,Z;return R=i.FileTypes,F=l.File,x=d.FileIcon,T=c.BrowseStore,J=h.reactFormat,U=m.Modal,O=_.FolderTreeView,G=y.SNIPPET_SIZES,Y=b.asyncGenContentManagerBridgeUri,D=b.GoldenGate,K=w._,Z=w.ungettext,W=N.TRADEMARK_PLUS,j=n.DOM,z=n.createElement,q={COPY:"copy",MOVE:"move"},Q=function(){var e;return e=T.context(),e.isNonUserRelativeContext?p:a},X=function(e,t){var n;return n=T.context(),n.isNonUserRelativeContext&&!D.hasContentManagerCdmInTSD(t.id)?e[0].fq_path.split("/")[1]:null},H=n.createClass({displayName:"PermanentlyDeleteModal",propTypes:{files:n.PropTypes.arrayOf(n.PropTypes.instanceOf(F)).isRequired,userId:n.PropTypes.number.isRequired},getDefaultProps:function(){return{onSuccess:r.noop}},handlePurged:function(){return f.notifyPurgeSuccess(this.props.files.length),this.props.onSuccess.apply(null,arguments)},handleAccept:function(){var e;return T.context().isNonUserRelativeContext?(e=this.props.files[0],p.permanentDeleteFile(e.ns_id,e.ns_path,this.handlePurged)):a.purgeFiles({files:this.props.files,userId:this.props.userId,onSuccess:this.handlePurged})},isSingleSharedFolder:function(e){return 1===e.length&&e[0].type===R.SHARED_FOLDER},getTitle:function(e){var t;return t=e.length,this.isSingleSharedFolder(e)?K("Remove access to folder?"):Z("Permanently delete %(num)s file?","Delete %(num)s items permanently?",t).format({num:t})},renderContent:function(e){var t,n;return t=e.length,1===t?(n=g.filename(e[0].fq_path),this.isSingleSharedFolder(e)?J(K("Are you sure you want to remove your access to <strong>%(filename)s</strong>? It will no longer be viewable in your list of shared folders, and you won’t be able to re-add it to your Dropbox unless you’re re-invited."),{strong:j.strong(),filename:n}):J(K("Are you sure you want to delete <strong>%(filename)s</strong> from your Dropbox permanently?"),{strong:j.strong(),filename:n})):j.span(null,Z("Are you sure you want to permanently delete %(num)s item from your Dropbox?","Are you sure you want to permanently delete %(num)s items from your Dropbox?",t).format({num:t}))},render:function(){var e;return e={ref:"modal",title:this.getTitle(this.props.files),acceptButtonText:K(this.isSingleSharedFolder(this.props.files)?"Remove my access":"Delete permanently"),dismissButtonText:K("Cancel"),onAccept:this.handleAccept},z(U,e,this.renderContent(this.props.files))}}),V=n.createClass({displayName:"RestoreFilesModal",propTypes:{files:n.PropTypes.arrayOf(n.PropTypes.instanceOf(F)).isRequired,userId:n.PropTypes.number.isRequired,onSuccess:n.PropTypes.func},getDefaultProps:function(){return{onSuccess:r.noop}},handleRestoreSuccess:function(){return f.notifyRestoreSuccess(this.props.files),this.props.onSuccess.apply(null,arguments)},handleRestoreClick:function(e){var t,n;return e.preventDefault(),t=T.context(),t.isNonUserRelativeContext?(n=this.props.files[0],p.restoreFile(n.ns_id,n.ns_path,n.latest_rev,this.handleRestoreSuccess)):a.restoreFiles({files:this.props.files,userId:this.props.userId,onSuccess:this.handleRestoreSuccess}),this.refs.modal.close()},handleCancelClick:function(e){return e.preventDefault(),this.refs.modal.close()},getTitle:function(e){return Z("Restore %(num)s file?","Restore %(num)s items…",e).format({num:e})},renderSingleFileContent:function(e,t){var n;return n=g.filename(e.fq_path),[J(K("The most recent version of <strong>%(filename)s</strong> will be restored."),{strong:j.strong(),filename:n}),j.div({className:"file-modal__single-file-row"},z(x,{file:e,className:"file-modal__single-file-row-icon"}),T.context().isNonUserRelativeContext?n:j.a({href:t,className:"file-modal__single-file-row-link"},n))]},renderMultiFileContent:function(e){return j.span({},Z("Are you sure you want to restore %(num)s item?","Are you sure you want to restore %(num)s items?",e.length).format({num:e.length}))},renderButtons:function(e){return j.div({className:"file-modal__buttons"},e?j.div({className:"file-modal__buttons__alt",ref:"revisionButton"},j.a({href:e},K("View other versions"))):void 0,j.div({className:"file-modal__buttons__main"},j.button({className:"button-primary db-modal-button",onClick:this.handleRestoreClick,ref:"primaryButton"},K("Restore")),j.button({className:"button-tertiary db-modal-button",onClick:this.handleCancelClick,ref:"tertiaryButton"},K("Cancel"))))},render:function(){var e,t,n,s;return t=this.props.files.length,s=null,1!==t||T.context().isNonUserRelativeContext||(s=a.getFileHistoryUrl({fqPath:this.props.files[0].fq_path,userId:this.props.userId})),n={ref:"modal",title:this.getTitle(t),buttonComponent:this.renderButtons(s)},e=1===t?this.renderSingleFileContent(this.props.files[0],s):this.renderMultiFileContent(this.props.files),z(U,n,e)}}),V=u(V,["/static/css/react/file_modal-vfl5O9OmZ.css"]),L=n.createClass({displayName:"FileTransferModal",statics:{Operations:q},propTypes:{files:n.PropTypes.arrayOf(n.PropTypes.shape({fq_path:n.PropTypes.string,is_dir:n.PropTypes.bool})).isRequired,operation:n.PropTypes.oneOf([q.COPY,q.MOVE]).isRequired,user:n.PropTypes.instanceOf(v).isRequired,onSuccess:n.PropTypes.func,onUndo:n.PropTypes.func,onRequestNotSent:n.PropTypes.func,path:n.PropTypes.string},getDefaultProps:function(){return{onSuccess:r.noop}},getInitialState:function(){return{selectedPath:null}},handleOperationSuccess:function(e){var t,n,s,r;return t=e.changesets,s=e.rollbackHints,n=this.props.files.length,r=this.props.user,this.props.operation===q.MOVE?f.notifyMoveSuccess(n,r,t,this.state.selectedPath,s,this.props.onUndo):this.props.operation===q.COPY&&f.notifyCopySuccess(n,r,t,this.state.selectedPath,s,this.props.onUndo),this.props.onSuccess.apply(null,arguments)},handleAccept:function(){var e,t,n,s;if(e=Q(),this.props.operation===q.MOVE){if(s=e.moveFiles({path:this.props.path,files:this.props.files,newPath:this.state.selectedPath,userId:this.props.user.id,onSuccess:this.handleOperationSuccess}),!s)return"function"==typeof(t=this.props).onRequestNotSent?t.onRequestNotSent():void 0}else if(this.props.operation===q.COPY&&(s=e.copyFiles({files:this.props.files,newPath:this.state.selectedPath,userId:this.props.user.id,onSuccess:this.handleOperationSuccess}),!s))return"function"==typeof(n=this.props).onRequestNotSent?n.onRequestNotSent():void 0},handleFolderSelected:function(e){return this.setState({selectedPath:e})},_getTitle:function(){var e,t;return e=this.props.files.length,this.props.operation===q.MOVE?t=this.props.files[0].is_dir?Z("Move %(num)s folder to…","Move %(num)s items to…",e,{comment:'"items" is a (potential) mix of files and folders'}):Z("Move %(num)s file to…","Move %(num)s items to…",e,{comment:'"items" is a (potential) mix of files and folders'}):this.props.operation===q.COPY&&(t=this.props.files[0].is_dir?Z("Copy %(num)s folder to…","Copy %(num)s items to…",e,{comment:'"items" is a (potential) mix of files and folders'}):Z("Copy %(num)s file to…","Copy %(num)s items to…",e,{comment:'"items" is a (potential) mix of files and folders'})),t.format({num:e})},_getActionButtonText:function(){return this.props.operation===q.COPY?K("Copy"):this.props.operation===q.MOVE?K("Move"):void 0},handleModalShown:function(){var e;if(e=s.findDOMNode(this.refs.treeView))return e.focus()},render:function(){return z(U,{ref:"modal",title:this._getTitle(),acceptButtonText:this._getActionButtonText(),onAccept:this.handleAccept,acceptButtonDisabled:!this.state.selectedPath,autoFocusPrimaryInput:!1,onShow:this.handleModalShown,dismissButtonText:K("Cancel")},z(O,{ref:"treeView",rootPath:"/",user:this.props.user,onFolderSelected:this.handleFolderSelected,isRootSelectable:!0,treeRootName:X(this.props.files,this.props.user)}))}}),M=n.createClass({displayName:"DeleteFileModal",propTypes:{files:n.PropTypes.arrayOf(n.PropTypes.shape({fq_path:n.PropTypes.string,is_dir:n.PropTypes.bool})).isRequired,user:n.PropTypes.instanceOf(v).isRequired,parentSharedFolderName:n.PropTypes.string,onUndo:n.PropTypes.func,expOQProVariant:n.PropTypes.string,expSubgrowthBizWebClientOQDelete:n.PropTypes.bool},getDefaultProps:function(){return{parentSharedFolderName:null}},handleNotify:function(e){var t,n;return t=e.changesets,n=e.rollbackHints,f.notifyDeleteSuccess(this.props.files.length,this.props.user,t,n,this.props.onUndo)},handleAccept:function(){var e;return e=T.context(),e.isNonUserRelativeContext?p.deleteFiles({files:this.props.files,context:e}):a.deleteFiles({files:this.props.files,userId:this.props.user.id,onSuccess:this.handleNotify})},_isRemovingSharedFolder:function(){return 1===this.props.files.length&&this.props.files[0].target_ns},_getTitle:function(){var e;return e=this.props.files,e.length<1?"":this._isRemovingSharedFolder()&&!D.canDeepNest(this.props.user.id)?K("Remove shared folder?"):1===e.length?K(e[0].is_dir?"Delete folder?":"Delete file?"):Z("Delete %(item_count)s item?","Delete %(item_count)s items?",e.length).format({item_count:e.length})},_getContents:function(){var e,t,n,s,r;return e=this.props.files,null==(null!=e?e.length:void 0)||e.length<1?"":(n=g.filename(e[0].fq_path),t=e[0].target_ns,null!=this.props.parentSharedFolderName?(s=this.props.parentSharedFolderName,1===e.length&&t&&!D.canDeepNest(this.props.user.id)?(r=C({path:"/work"+e[0].fq_path,query:{shareoptions:1,sharesubfolder:0}}).toString(),J(K("Are you sure you want to delete <b>%(filename)s</b> from the shared folder ‘%(shared_folder_name)s’? People outside %(team_name)s with whom you’ve shared this folder will stil have access until you remove them from the <memberListLink>member list</memberListLink>."),{filename:n,shared_folder_name:s,team_name:S.get_viewer().team_name,b:j.b(),memberListLink:j.a({href:r})})):1===e.length?J(K("Are you sure you want to delete <b>%(filename)s</b> from the shared folder ‘%(shared_folder_name)s’?"),{filename:n,shared_folder_name:s,b:j.b()}):Z("Are you sure you want to delete %(item_count)s item from the shared folder ‘%(shared_folder_name)s’?","Are you sure you want to delete %(item_count)s items from the shared folder ‘%(shared_folder_name)s’?",e.length).format({item_count:e.length,shared_folder_name:s})):1===e.length&&t&&!T.context().isNonUserRelativeContext?J(K("Are you sure you want to remove the shared folder <b>%(filename)s</b> from your Dropbox? This shared folder will stay shared with other members and you can re-add it later."),{filename:n,b:j.b()}):1===e.length?J(K("Are you sure you want to delete <b>%(filename)s</b> from your Dropbox?"),{filename:n,b:j.b()}):Z("Are you sure you want to delete %(item_count)s item from your Dropbox?","Are you sure you want to delete %(item_count)s items from your Dropbox?",e.length).format({item_count:e.length}))},render:function(){return z(U,{ref:"modal",title:this._getTitle(),onAccept:this.handleAccept,acceptButtonText:K(this._isRemovingSharedFolder()&&!T.context().isNonUserRelativeContext?"Remove":"Delete"),dismissButtonText:K("Cancel")},this._getContents())}}),k=(function(n){function s(t,n){this._handleAccept=e(this._handleAccept,this),s.__super__.constructor.call(this,t,n)}return t(s,n),s.prototype.render=function(){return z(U,{ref:"modal",title:this._getTitle(),onAccept:this.handleAccept,buttonComponent:this._renderButtons(),acceptButtonText:K(this._isRemovingSharedFolder()?"Remove":"Delete"),dismissButtonText:K("Cancel")},this._getContents(),this._renderAdditionalContent())},s.prototype._renderAdditionalContent=function(){var e;return e=this.props.files,null==(null!=e?e.length:void 0)||e.length<1?"":e[0].target_ns&&1===e.length&&!T.context().isNonUserRelativeContext?j.div({className:"u-mar-top-s"},K("Or, get more space for your files when you upgrade your account.")):!e[0].target_ns||e.length>1?j.span({className:"oq-delete-file-modal-upsell__additional-text"},K("Instead, get more space for your files when you upgrade your account.")):void 0},s.prototype._handleAccept=function(){return this.handleAccept(),U.close()},s.prototype._upgradeRedirect=function(){var e;return e=C({path:"/plans",query:{trigger:"nr",tk:"oq_delete_modal"}}),I.redirect(e)},s.prototype._renderButtons=function(){return j.div({className:"oq-delete-file-modal-upsell__buttons"},j.button({className:"button-primary db-modal-button",onClick:this._upgradeRedirect,ref:"primaryButton"},K("Upgrade")),j.button({className:"button-secondary db-modal-button u-mar-left-s",onClick:this._handleAccept,ref:"secondaryButton"},K(this._isRemovingSharedFolder()?"Remove":"Delete")))},s})(M),A=(function(n){function s(t,n){this._handleAccept=e(this._handleAccept,this),s.__super__.constructor.call(this,t,n)}return t(s,n),s.prototype.render=function(){var e,t;return e="V1"===this.props.expOQProVariant?this._renderFooter():null,t="V2"===this.props.expOQProVariant?this._renderButtons():null,z(U,{ref:"modal",title:this._getTitle(),onAccept:this.handleAccept,altAction:e,buttonComponent:t,acceptButtonText:K(this._isRemovingSharedFolder()?"Remove":"Delete"),dismissButtonText:K("Cancel")},this._getContents(),"V2"===this.props.expOQProVariant?this._renderAdditionalContent():void 0)},s.prototype._renderFooter=function(){var e,t;return e=this.props.files,null==(null!=e?e.length:void 0)||e.length<1?"":(g.filename(e[0].fq_path),t=e[0].target_ns,j.div({className:"delete-file-modal-upsell"},j.div({className:"delete-file-modal-upsell__footer"},1===e.length&&t&&!T.context().isNonUserRelativeContext?J(K("Are you sure you want to delete this shared folder? Instead, keep all your files with Dropbox %(trademark_plus)s. <upgradeLink>Upgrade now.</upgradeLink>"),{upgradeLink:j.a({className:"delete-file-modal-upsell__footer--nowrap",href:C({path:"/pro/buy",query:{oqa:"oqdel"}})}),trademark_plus:W}):1===e.length?J(K("Are you sure you want to delete this file? Instead, keep all your files with Dropbox %(trademark_plus)s. <upgradeLink>Upgrade now.</upgradeLink>"),{upgradeLink:j.a({className:"delete-file-modal-upsell__footer--nowrap",href:C({path:"/pro/buy",query:{oqa:"oqdel"}})}),trademark_plus:W}):J(K("Are you sure you want to delete these files? Instead, keep all your files with Dropbox %(trademark_plus)s. <upgradeLink>Upgrade now.</upgradeLink>"),{upgradeLink:j.a({className:"delete-file-modal-upsell__footer--nowrap",href:C({path:"/pro/buy",query:{oqa:"oqdel"}})}),trademark_plus:W}))))},s.prototype._renderAdditionalContent=function(){var e;return e=this.props.files,null==(null!=e?e.length:void 0)||e.length<1?"":!e[0].target_ns||e.length>1?j.span({className:"delete-file-modal-upsell__additional-text"},J(K("Instead, keep all your files with Dropbox %(trademark_plus)s."),{trademark_plus:W})):void 0},s.prototype._handleAccept=function(){return this.handleAccept(),U.close()},s.prototype._upgradeRedirect=function(){var e;return e=C({path:"/pro/buy",query:{oqa:"oqdel"}}),I.redirect(e)},s.prototype._renderButtons=function(){return j.div({className:"delete-file-modal-upsell__buttons"},j.button({className:"button-secondary db-modal-button",onClick:this._handleAccept,ref:"secondaryButton"},K(this._isRemovingSharedFolder()?"Remove":"Delete")),j.button({className:"button-primary db-modal-button u-mar-left-s",onClick:this._upgradeRedirect,ref:"primaryButton"},K("Upgrade")))},s})(M),A=u(A,["/static/css/react/exp_file_modal-vfl8ta8sG.css"]),P=n.createClass({displayName:"ContentManagerBridgeModal",propTypes:{files:n.PropTypes.arrayOf(n.PropTypes.shape({fq_path:n.PropTypes.string,is_dir:n.PropTypes.bool})).isRequired,type:n.PropTypes.string,isLimitedTeam:n.PropTypes.bool},handleAccept:function(){return Y(this.props.isLimitedTeam,this.props.files[0].fq_path).then(function(e){return I.open_tab(e.toString())})},render:function(){return z(U,{ref:"modal",style:"clean",onAccept:this.handleAccept,acceptButtonText:K("Go to Admin Console"),altAction:j.a({onClick:function(){return U.close()}},K("Cancel")),width:350,showX:!1,className:"content-manager-bridge-modal"},"archive"===this.props.type?K("You can archive team folders in the Admin Console."):"rename"===this.props.type?K("You can rename team folders in the Admin Console."):void 0)}}),B=n.createClass({displayName:"NoAccessFolderModal",propTypes:{folderName:n.PropTypes.string.isRequired,userIsSameTeam:n.PropTypes.bool.isRequired},render:function(){var e;return e="",e=K(this.props.userIsSameTeam?"You don’t have permission to open the folder “%(folder_name)s”. Contact your <admin_link>team admins</admin_link> to gain access.":"You don’t have permission to open the folder “%(folder_name)s”."),z(U,{ref:"modal",style:"default",acceptButtonText:K("Done"),title:K("No access to the folder “%(folder_name)s”").format({folder_name:o.em_snippet(this.props.folderName,G.FILENAME)})},j.div({},J(e,{folder_name:o.em_snippet(this.props.folderName,G.FILENAME),admin_link:j.a({href:"/team?_tk=left_nav_team",target:"_blank",key:"admin_link"})})))}}),{FileTransferModal:L,RestoreFilesModal:V,PermanentlyDeleteModal:H,DeleteFileModal:M,ContentManagerBridgeModal:P,NoAccessFolderModal:B,ExpDeleteFileModal:A,ExpOQDeleteFileModal:k}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/react/radio",["external/classnames","external/react","external/react-dom"],function(t,n,s){var r,o,a,i,l,d;return n.DOM,d=n.PropTypes,a={Normal:"normal",Large:"large"},l=Object.keys(a).map(function(e){return a[e]}),i=d.oneOfType([d.string,d.number,d.bool]),o=n.createClass({displayName:"RadioItem",propTypes:{className:d.string,value:i,_radioGroupData:d.shape({variant:d.oneOf(l),name:d.string.isRequired,radioGroupValue:i,onSelect:d.func})},_handleClick:function(){var e;this._isSelected()||(s.findDOMNode(this.refs.input).focus(),"function"==typeof(e=this.props._radioGroupData).onSelect&&e.onSelect(this.props.value))},_handleChange:function(){var e;"function"==typeof(e=this.props._radioGroupData).onSelect&&e.onSelect(this.props.value)},_getId:function(){return this.props._radioGroupData.name+"_"+this.props.value},_isSelected:function(){return this.props._radioGroupData.radioGroupValue===this.props.value},render:function(){var s,r,o,i;return r=this.props._radioGroupData,i=["c-radio-wrapper",this.props.className],s={"c-radio":!0,"c-radio--selected":this._isSelected()},o=r.variant,e.call(l,o)>=0&&r.variant!==a.Normal&&(s["c-radio--"+r.variant]=!0),n.createElement("div",{className:t(i),onClick:this._handleClick},n.createElement("input",{id:this._getId(),ref:"input",type:"radio",name:r.name,value:this.props.value,checked:this._isSelected(),onChange:this._handleChange}),n.createElement("div",{className:t(s)},n.createElement("div",{className:"c-radio__inner"})),n.createElement("label",{className:"c-radio-content",htmlFor:this._getId()},this.props.children))}}),r=n.createClass({displayName:"RadioGroup",propTypes:{className:d.string,variant:d.oneOf(l),name:d.string,legend:d.string.isRequired,align:d.oneOf(["top","bottom","middle","baseline"]),displayLegend:d.bool,valueLink:d.object},getDefaultProps:function(){return{className:null,type:a.Normal,align:"middle",displayLegend:!1}},_onRadioItemSelect:function(e){var t;null!=(t=this.props.valueLink)&&t.requestChange(e)},render:function(){var e,s,r,a;return s=this.props.name||"radio-"+Math.floor(1e9*Math.random()),e=n.Children.map(this.props.children,(function(e){return function(t){return t.type===o?n.cloneElement(t,{_radioGroupData:{variant:e.props.variant,name:s,radioGroupValue:e.props.valueLink.value,onSelect:e._onRadioItemSelect}}):t}})(this)),r={"c-radio-group__legend":!0,"ax-visually-hidden":!this.props.displayLegend},a=["c-radio-group","align-"+this.props.align,this.props.className],n.createElement("fieldset",{className:t(a)},n.createElement("legend",{className:t(r)},this.props.legend),e)}}),{RadioGroup:r,RadioItem:o,RadioItemVariant:a}})}.call(this),function(){define("modules/clean/react/sharing/shared_with_view",["external/classnames","external/react","modules/clean/avatar/inherited_count_avatar","modules/clean/avatar/size","modules/clean/components/loading_indicator","modules/clean/components/title_bubble","modules/clean/sharing/constants","modules/clean/em_string","modules/clean/react/browse/models","modules/clean/sharing/api/types/metadata","modules/clean/sharing/member_avatars","modules/clean/sharing/ui_util","modules/clean/static_urls","modules/clean/user_education/user_education_client","modules/clean/viewer","modules/constants/viewer","modules/core/i18n"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f){var g,y,b,v,S,I,E,w,C,N,T,P,M,A,k,F,x,L,R;return y=s.AVATAR_DIMENSION_BY_SIZE,N=a.SNIPPET_SIZES,M=a.TRUELINK,v=l.File,I=d.LinkAudience,T=d.SharedContentLinkMetadata,S=p.GoldenGate,L=u.static_url,A=h.UserEducationEffect,k=f._,R=f.ungettext,x=t.DOM,F=t.createElement,E=5,g=y.SMALL,b=12,w="--",C="--",P=t.createClass({displayName:"SharedWithView",mixins:[c],propTypes:{user:t.PropTypes.object.isRequired,file:t.PropTypes.instanceOf(v),onOverflowCountClick:t.PropTypes.func,onAvatarClick:t.PropTypes.func,groups:t.PropTypes.array,invitations:t.PropTypes.array,joinedMembers:t.PropTypes.array,numUndisplayableUsersAndInvites:t.PropTypes.number,memberCount:t.PropTypes.number,numInheritedMembers:t.PropTypes.number,parentFolderName:t.PropTypes.string,animation:t.PropTypes.bool,titleButtonDirection:t.PropTypes.string,avatarDimension:t.PropTypes.number,maxVisibleAvatars:t.PropTypes.number,sharedLinkInfo:t.PropTypes.object,onSharedLinkClick:t.PropTypes.func,isMaestroDesign:t.PropTypes.bool,inSelectMode:t.PropTypes.bool,isInAudienceBox:t.PropTypes.bool,audienceDescription:t.PropTypes.string,hasSharedDataLoaded:t.PropTypes.bool,canViewMembers:t.PropTypes.bool,inContentManagerCdmRoot:t.PropTypes.bool,linkMetadata:t.PropTypes.instanceOf(T),publicFolderSharing:t.PropTypes.bool},getDefaultProps:function(){return{titleButtonDirection:"south",avatarDimension:g,maxVisibleAvatars:E,file:null,canViewMembers:!0,inContentManagerCdmRoot:!1,inSelectMode:!1}},render:function(){var e,t;return this.props.inContentManagerCdmRoot?0===this.props.groups.length?x.div({}):(e=this.props.groups[0].num_users,x.div({className:"audience-description",onClick:function(e){return e.stopPropagation()}},R("%(num)s member","%(num)s members",e).format({num:e}))):this.props.isInAudienceBox&&S.hasAudienceBox(this.props.user.id)?this.props.canViewMembers?(null!=(t=this.props.file)?t.isDeleted:void 0)?null:x.div({className:this.getClassName()},this.props.hasSharedDataLoaded?F(A,{containerName:this.constructor.displayName,name:"AudienceBoxAvatars"},this.renderAudienceBoxAvatars()):F(r,{style:r.LoadingIndicatorStyle.DOTS})):null:this.props.isMaestroDesign&&S.hasAudienceBox(this.props.user.id)?x.div({className:this.getClassName()},this._hasSharedLink()?this.renderSharedLinkInColumn():void 0,this.renderAudienceDescription()):x.div({className:this.getClassName()},this.renderAvatars())},getClassName:function(){return e({"shared-with-members":!0,"shared-with-members--golden-gate":!this.props.isMaestroDesign,clearfix:!0,"audience-box u-pad-top-xs u-pad-bottom-s u-mar-buttom-xs":this.props.isInAudienceBox})},renderSharedLinkInColumn:function(){var e,t;return t=this.props.onSharedLinkClick,e=this.props.inSelectMode,F(o,{key:"shared_link",text:this.getDescriptionForSharedLinkInfo(this.props.sharedLinkInfo,this.props.linkMetadata),direction:this.props.titleButtonDirection,className:"audience-description__link-avatar"},x.img({src:L("/static/images/avatar/shared-link-icon-vflHCU_m6.svg"),alt:this.props.alt||k("Shared link"),width:b,height:b,onClick:function(n){if(!e)return t(),n.stopPropagation()}}))},renderAudienceDescription:function(){var e,t,n,s,r,a,l,d,c,p,u,h,m,_,f,g,y;return this.props.hasSharedDataLoaded?((null!=(_=this.props.file)?_.isDeleted:void 0)?n=k("Deleted"):this.props.canViewMembers?this.props.audienceDescription&&(n=this.props.audienceDescription):n=C,s=(this.props.groups||[]).concat(this.props.joinedMembers||[]).concat(this.props.invitations||[]),p=s.length+(this.props.numUndisplayableUsersAndInvites||0),f=this.findOwnerAndMeInJoinedMembers(this.props.joinedMembers||[]),f[0],c=f[1],p>0&&(1!==p||null==c)&&(n||(n=R("%(num)s member","%(num)s members",this.props.memberCount).format({num:this.props.memberCount})),y=s.slice(0,this.props.maxVisibleAvatars),h=(function(){var e,t,n;for(n=[],e=0,t=y.length;e<t;e++)d=y[e],n.push(i.em_snippet(d.display_name||d.name||d.email_or_fbname,N.DISPLAY_NAME));return n})(),p>this.props.maxVisibleAvatars&&(h.pop(),e=p-(this.props.maxVisibleAvatars-1),u=R("and %(num)s more...","and %(num)s more...",e,{comment:"Number of additional members in the file. Expected to be >= 2."}).format({num:e}),h.push(u)),r=h.join("\n")),this.props.publicFolderSharing&&this.props.file&&!this.props.file.is_dir?n||(n=k("Anyone")):n||(n=k("Only you")),m=this.props.onAvatarClick,a=this.props.inSelectMode,l=null!=(g=this.props.file)?g.isDeleted:void 0,t=x.div({className:"audience-description",onClick:function(e){if(!a&&!l)return m(),e.stopPropagation()}},n),r?F(o,{key:"membership_column_bubble",respectLineBreaks:!0,text:r,direction:this.props.titleButtonDirection},t):t):null},renderAudienceBoxAvatars:function(){var e,t,n,s,r,o,a;return e=[],s=this.props.joinedMembers?this.props.joinedMembers:[],t=this.props.groups?this.props.groups.slice():[],n=this.props.invitations?this.props.invitations.slice():[],this._addSharedLinkIfExists(e),a=[],o=this.findOwnerAndMeInJoinedMembers(s),o[0],r=o[1],null!=r&&(a.push(r.user_id),e.push(this.renderJoinedMember(r))),this.addGroupsMembersInvitations(e,t,s,n,a),1===e.length&&null!=r?x.div({className:"audience-box--text-only"},k("Only you have access")):this.renderAvatarList(e)},renderAvatars:function(){var e,t,n,s,r,o,a,i,l,d;return(null!=(i=this.props.file)?i.isDeleted:void 0)?x.span({"aria-hidden":!0},k("deleted")):(r=this.props.joinedMembers?this.props.joinedMembers:[],n=this.props.groups?this.props.groups.slice():[],s=this.props.invitations?this.props.invitations.slice():[],e=[],this._addSharedLinkIfExists(e),d=[],l=this.findOwnerAndMeInJoinedMembers(r),a=l[0],o=l[1],S.hasNewMembershipUI(this.props.user.id)||(null!=a&&a===o&&(a=null),null!=a&&(d.push(a.user_id),e.push(this.renderJoinedMember(a)))),null!=o&&d.push(o.user_id),this.addGroupsMembersInvitations(e,n,r,s,d),t=0===e.length&&(0===this.props.numInheritedMembers||!S.hasNewMembershipUI(this.props.user.id)),t?this.props.hasSharedDataLoaded?x.span({"aria-hidden":!0},w):void 0:this.renderAvatarList(e))},_addSharedLinkIfExists:function(e){if(this._hasSharedLink())return M.TRUELINK_UI[this.props.user.id]?e.push(this.renderSharedLink(null,this.props.linkMetadata)):e.push(this.renderSharedLink(this.props.sharedLinkInfo))},_hasSharedLink:function(){return M.TRUELINK_UI[this.props.user.id]?this.props.linkMetadata&&this.props.linkMetadata.current_audience!==I.members:Boolean(this.props.sharedLinkInfo)}}),{SharedWithView:P}})}.call(this),define("modules/clean/react/starred/browse_exports",["require","exports","modules/clean/react/starred/store","modules/clean/react/starred/browse_update","modules/clean/react/starred/star","modules/clean/react/starred/actions"],function(e,t,n,s,r,o){"use strict";t.StarredStore=n.StarredStore,t.checkForMissingBrowseStarredData=s.checkForMissingBrowseStarredData,t.Star=r.Star,t.StarredActions=o.StarredActions}),define("modules/clean/react/starred/browse_update",["require","exports","modules/clean/react/home/home_access/home_access_util","modules/clean/react/browse/store","modules/clean/react/starred/actions","modules/constants/starred","modules/clean/react/starred/store"],function(e,t,n,s,r,o,a){"use strict";function i(){if(n.isHomeEnabled()&&!s.BrowseStore.context().isNonUserRelativeContext){var e=s.BrowseStore.files().toArray().map(function(e){return{type:o.STARRED_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID,id:e.file_id}}).filter(function(e){return!(!e.id||a.StarredStore.hasIdTypePair(e))});e.length&&r.StarredActions.fetchStatuses(s.BrowseStore.user().role,e)}}t.checkForMissingBrowseStarredData=i}),function(){define("modules/clean/react/teams/modals/limited_team_folder_settings_modal",["external/react","external/underscore","modules/core/i18n","modules/clean/analytics","modules/clean/react/modal","modules/clean/react/teams/modals/limited_team_upsell_modal_banner","modules/clean/sharing/folder_settings_modal","modules/constants/python"],function(e,t,n,s,r,o,a,i){var l,d,c,p,u;return p=n._,c=s.TeamsWebActionsLogger,l=r.Modal,d=a.SharedFolderSettingsModal,u=e.createElement,{showWithProps:function(e){var n,s;return n={altAction:u(o,{upsellText:p("Want to access these settings as well as other admin controls? Upgrade to %(trademark_business)s.").format({trademark_business:i.TRADEMARK_BUSINESS}),upgradeButtonText:p("Upgrade now"),redirectQuery:{tk:"team_settings",_camp:"modal"},logEventName:"team_folder_settings_upsell"})},s=l.showInstance(u(d,t(e).extend(n))),c.log("team_folder_settings",null,null,null,!1,c.LOG_CATEGORY.TEAM_INFO),s}}})}.call(this),function(){define("modules/clean/react/teams/modals/limited_team_share_folder_modal",["external/react","modules/core/i18n","modules/clean/analytics","modules/clean/filepath","modules/clean/react/modal","modules/core/browser","modules/core/uri"],function(e,t,n,s,r,o,a){var i,l,d,c,p,u,h;return c=t._,d=n.TeamsWebActionsLogger,l=r.Modal,h=e.DOM,u=e.createElement,p=function(e){return d.log(e,null,null,null,!1,d.LOG_CATEGORY.TEAM_INFO)},i=e.createClass({mixins:[e.addons.PureRenderMixin],displayName:"LimitedTeamShareFolderModal",propTypes:{fqPath:e.PropTypes.string.isRequired},_navigateToTeam:function(){return p("team_folder_share_invite"),o.redirect(a({path:"/team",query:{invite_members:"",tk:"team_folder_share_invite",_camp:"modal"}}))},render:function(){var e;return e=s.filename(this.props.fqPath),u(l,{title:c("Share %(folder_name)s").format({folder_name:e}),acceptButtonText:c("Invite"),onAccept:this._navigateToTeam,showButtonDivider:!0},h.div({},c("To share the %(folder_name)s with someone, invite them to join your team!").format({folder_name:e})))}}),{showModalInstance:function(e){var t;return t=l.showInstance(u(i,e)),p("team_folder_share"),t}}})}.call(this),function(){
define("modules/clean/react/teams/modals/limited_team_upsell_modal_banner",["external/react","modules/core/browser","modules/core/uri","modules/clean/react/button","modules/clean/analytics"],function(e,t,n,s,r){var o,a,i,l,d;return a=s.button,o=r.TeamsWebActionsLogger,l=e.DOM,i=e.createElement,d=e.PropTypes,e.createClass({mixins:[e.addons.PureRenderMixin],propTypes:{upgradeButtonText:d.string.isRequired,upsellText:d.string.isRequired,logEventName:d.string,redirectUrl:d.string,redirectQuery:d.shape({tk:d.string,_camp:d.string})},displayName:"LimitedTeamUpsellModalBanner",_handleCTAClick:function(){return this.props.logEventName&&o.log(this.props.logEventName,{},null,null,!1,o.LOG_CATEGORY.UPGRADE),t.redirect(n({path:this.props.redirectUrl?this.props.redirectUrl:"/team/upgrade",query:this.props.redirectQuery}))},render:function(){return l.div({className:"modal-upsell-bar"},l.div({className:"modal-upsell-bar__message"},this.props.upsellText),l.div({className:"modal-upsell-bar__action"},i(a,{className:"modal-upsell-bar__cta-button",onClick:this._handleCTAClick},this.props.upgradeButtonText)))}})})}.call(this),function(){define("modules/clean/react/tree_view",["jquery","external/immutable","external/underscore","external/classnames","external/react","external/react-dom","modules/clean/ajax","modules/clean/em_string","modules/clean/filepath","modules/clean/react/css","modules/clean/react/browse/store","modules/clean/react/image","modules/clean/react/sprite","modules/clean/viewer","modules/core/i18n","modules/core/notify","modules/clean/keycode"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f){var g,y,b,v,S,I,E,w,C,N,T,P,M,A,k,F;return F=l.filename,g=c.BrowseStore,M=m._,v=f.KeyCode,k=r.DOM,A=r.createElement,S=20,b=15,I={None:"None",TreeItem:"TreeItem",HeaderItem:"HeaderItem",StaticHeader:"StaticHeader"},N=t.Record({key:void 0,label:"",icon:null,disabled:!1,canExpand:!1,forceExpanded:!1}),E=t.Record({childItemsByParentKey:t.Map(),parentItemByChildKey:t.Map(),items:t.Map(),rootItem:new N}),E.createWithRootItem=function(e){return new E({rootItem:e,items:t.Map([[e.key,e]])})},E.prototype.getParentItem=function(e){var t;if(e)return t=this.parentItemByChildKey.get(e.key),t?this.items.get(t):null},E.prototype.getChildItems=function(e){return this.childItemsByParentKey.get(e.key)||null},E.prototype.isParent=function(e){return this.childItemsByParentKey.has(e.key)},E.prototype.setChildItems=function(e,n){return this.withMutations(function(s){var r;return n=t.List(n),r=t.Map(n.map(function(e){return[e.key,e]})),s.set("items",s.items.merge(r)),s.set("childItemsByParentKey",s.childItemsByParentKey.set(e.key,n)),n.forEach(function(t){return s.set("parentItemByChildKey",s.parentItemByChildKey.set(t.key,e.key))})})},w=r.createClass({displayName:"TreeGroupView",propTypes:{ariaLabel:r.PropTypes.string},render:function(){return k.ul({className:"tree-view__group",role:"group"},this.props.children)}}),T=r.createClass({displayName:"TreeItemView",propTypes:{item:r.PropTypes.instanceOf(N).isRequired,id:r.PropTypes.string.isRequired,isSelected:r.PropTypes.bool,isExpanded:r.PropTypes.bool,canExpand:r.PropTypes.bool,level:r.PropTypes.number,onClick:r.PropTypes.func,onExpandButtonClick:r.PropTypes.func,showAsHeader:r.PropTypes.bool},getDefaultProps:function(){return{isSelected:!1,isExpanded:!1,canExpand:!1,level:0,onClick:n.noop,onExpandButtonClick:n.noop,showAsHeader:!1}},handleClick:function(e){var t;if(e.preventDefault(),e.stopPropagation(),!(this.props.item.disabled||null!=(t=o.findDOMNode(this.refs.expandButton))&&t.contains(e.target)))return this.props.onClick(this.props.item)},handleExpandClick:function(e){return e.preventDefault(),this.props.onExpandButtonClick(this.props.item,!this.props.isExpanded)},_renderExpandButton:function(){return k.div({className:"tree-view__expand-button",onClick:this.handleExpandClick,ref:"expandButton",role:"button"},A(u,{group:"web",name:this.props.isExpanded?"bullet_minus":"bullet_plus",alt:M(this.props.isExpanded?"Collapse":"Expand")}))},_renderIcon:function(){return k.div({className:"tree-view__icon-wrapper"},A(u,{className:"tree-view__item-icon",group:"web",name:this.props.item.icon,alt:""}))},render:function(){var e,t,n;return t=!this.props.canExpand,e=s({"tree-view__item":!0,"tree-view__item--leaf":t}),n={key:this.props.item.key,id:this.props.id,className:e,onClick:this.handleClick,role:"treeitem","aria-disabled":this.props.item.disabled,"aria-label":this.props.item.label,"aria-level":this.props.level+1},this.props.canExpand&&!this.props.showAsHeader&&(n["aria-expanded"]=this.props.isExpanded),this.props.isSelected&&(n["aria-selected"]=!0),k.li(n,k.span({className:s({"tree-view__item-row":!0,"tree-view__item-row--disabled":this.props.item.disabled}),style:{paddingLeft:this.props.showAsHeader?0:this.props.level*b}},this.props.showAsHeader||t?void 0:this._renderExpandButton(),this.props.item.icon?this._renderIcon():void 0,this.props.item.label?k.span({className:"tree-view__item-label"},i.em_snippet(this.props.item.label,S)):void 0),this.props.children)}}),C=r.createClass({displayName:"TreeHeaderView",propTypes:{item:r.PropTypes.instanceOf(N).isRequired,id:r.PropTypes.string.isRequired},_renderIcon:function(){return this.props.item.icon?A(u,{className:"tree-view__header-icon",group:"web",name:this.props.item.icon,alt:""}):null},render:function(){return k.div({className:"tree-view__item-row"},this._renderIcon(),k.h3({className:"tree-view__header",id:this.props.id},this.props.item.label))}}),P=r.createClass({displayName:"TreeView",propTypes:{tree:r.PropTypes.instanceOf(E).isRequired,rootStyle:r.PropTypes.oneOf(n.keys(I)),onItemSelected:r.PropTypes.func,onItemExpanded:r.PropTypes.func},getDefaultProps:function(){return{rootStyle:I.None,treeItemView:T,onItemSelected:function(){},onItemExpanded:function(){}}},getInitialState:function(){return{selectedItemKey:null,expandedItemKeys:t.Set([this.props.tree.rootItem.key]),showFocused:!1}},componentDidMount:function(){return e(o.findDOMNode(this)).on("keydown",this.handleKeyDown)},componentWillUnmount:function(){return e(o.findDOMNode(this)).off("keydown")},componentDidUpdate:function(t,n){var s,r;if(this.state.selectedItemKey&&this.state.selectedItemKey!==n.selectedItemKey&&(s=e(o.findDOMNode(this)),r=s.find('[aria-selected="true"]').eq(0),r.length))return this._scrollElementIntoViewIfNeeded(r,s)},_scrollElementIntoViewIfNeeded:function(e,t){var n,s,r,o,a,i,l;return r=t.scrollTop(),a=r+e.position().top,l=a-r,l<0?void t.scrollTop(a):(n=t.innerHeight(),s=r+n,o=e.innerHeight(),i=a+o,i>s?t.scrollTop(a-n+o):void 0)},_hasSelectableRootItem:function(){var e;return e=this.props.rootStyle,e===I.TreeItem||e===I.HeaderItem},_getHTMLIdPrefix:function(){return this._HTMLIdPrefix||(this._HTMLIdPrefix="tree-view-"+Math.floor(16777215*Math.random()).toString(16))},selectItem:function(e){return this.setState({selectedItemKey:null!=e?e.key:void 0}),this.props.onItemSelected(e)},_getLastLeafOf:function(e){var t;return t=this.props.tree.getChildItems(e),this.state.expandedItemKeys.contains(e.key)&&(null!=t?t.size:void 0)>0?this._getLastLeafOf(t.last()):e},_getPrevItem:function(e){var t,n,s,r;return(s=this.props.tree.getParentItem(e))?(r=this.props.tree.getChildItems(s),n=r.indexOf(e),n>0?this._getLastLeafOf(r.get(n-1)):0===n?(t=s===this.props.tree.rootItem,t&&!this._hasSelectableRootItem()?null:s):null):null},_getNextItem:function(e,t){var n,s,r,o,a,i;return null==t&&(t=!0),e?(r=this.state.expandedItemKeys.contains(e.key),n=r&&this.props.tree.isParent(e),t&&n?this.props.tree.getChildItems(e).first():(a=this.props.tree.getParentItem(e))?(i=this.props.tree.getChildItems(a),o=i.size-1,s=i.indexOf(e),s===o?this._getNextItem(a,!1):0<=s&&s<o?i.get(s+1):null):null):null},advanceSelection:function(e){var t,n,s;return null==e&&(e=!1),this.state.selectedItemKey?(s=this.props.tree.items.get(this.state.selectedItemKey),n=e?this._getPrevItem(s):this._getNextItem(s),n?(this.selectItem(n),!0):void 0):(t=this._hasSelectableRootItem()?this.props.tree.rootItem:this.props.tree.getChildItems(this.props.tree.rootItem).first(),this.selectItem(t),!0)},_getValidHTMLIdForItem:function(e){return(""+this._getHTMLIdPrefix()+e.key).replace(/\s+/g,"_")},_setItemExpanded:function(e,t){return t?this.state.expandedItemKeys.add(e):this.state.expandedItemKeys.delete(e)},_canItemExpand:function(e){return e&&(e.canExpand||this.props.tree.isParent(e))},handleExpandButtonClick:function(e,t){return this.setState({expandedItemKeys:this._setItemExpanded(e.key,t)}),this.props.onItemExpanded(e,t)},handleKeyDown:function(e){var t;switch(e.which){case v.UP:if(this.advanceSelection(!0))return e.preventDefault();break;case v.DOWN:if(this.advanceSelection(!1))return e.preventDefault();break;case v.RIGHT:if(t=this.props.tree.items.get(this.state.selectedItemKey),this._canItemExpand(t))return this.handleExpandButtonClick(t,!0),e.preventDefault();break;case v.LEFT:if(t=this.props.tree.items.get(this.state.selectedItemKey),this._canItemExpand(t))return this.handleExpandButtonClick(t,!1),e.preventDefault()}},_renderSingleItem:function(e,t,s,r){var o,a;return null==s&&(s=null),null==r&&(r={}),o={id:this._getValidHTMLIdForItem(e),key:e.key,item:e,isSelected:this.state.selectedItemKey===e.key,isExpanded:this.state.expandedItemKeys.contains(e.key)||e.forceExpanded,canExpand:this._canItemExpand(e)&&!e.forceExpanded,level:t,onClick:this.selectItem,onExpandButtonClick:this.handleExpandButtonClick},a=n.extend({},o,r),A(this.props.treeItemView,a,s)},_renderItemAndDescendants:function(e,t){var n,s;return s=this.state.expandedItemKeys.contains(e.key)||e.forceExpanded,this.props.tree.isParent(e)&&s&&(n=this._renderChildrenOfItemAsGroup(e,t+1)),this._renderSingleItem(e,t,n)},_renderChildrenOfItemAsGroup:function(e,t){var n;return e&&this.props.tree.isParent(e)?(n=this.props.tree.getChildItems(e).map((function(e){return function(n){return e._renderItemAndDescendants(n,t)}})(this)),A(w,null,n.toJS())):null},render:function(){var e,t,n,r,o;if(t={role:"tree",tabIndex:0,onFocus:(function(e){return function(){return e.setState({showFocused:!0})}})(this),onBlur:(function(e){return function(){return e.setState({showFocused:!1})}})(this),className:s("tree-view","ax-focusable",{"is-focused":this.state.showFocused})},n=this.props.tree.rootItem,this.state.selectedItemKey&&(r=this.props.tree.items.get(this.state.selectedItemKey),t["aria-activedescendant"]=this._getValidHTMLIdForItem(r)),this.props.rootStyle===I.TreeItem)o=A(w,null,this._renderItemAndDescendants(n,0));else if(this.props.rootStyle===I.HeaderItem)e=this._getValidHTMLIdForItem(n),o=A(w,null,this._renderSingleItem(n,0,null,{showAsHeader:!0,id:e}),this._renderChildrenOfItemAsGroup(n,0));else if(this.props.rootStyle===I.StaticHeader)e=this._getValidHTMLIdForItem(n),o=A(w,null,A(C,{item:n,id:e}),this._renderChildrenOfItemAsGroup(n,0));else{if(this.props.rootStyle!==I.None)throw new Error("Unknown root style: "+this.props.rootStyle);o=this._renderChildrenOfItemAsGroup(this.props.tree.rootItem,0)}return e&&(t["aria-labelledby"]=e),k.div(t,o,this.props.children)}}),P=d(P,["/static/css/react/tree_view-vflOwUm_p.css","/static/css/accessibility-vflRPMGHg.css"]),y=r.createClass({displayName:"FolderTreeView",propTypes:{user:r.PropTypes.object.isRequired,rootPath:r.PropTypes.string,onFolderSelected:r.PropTypes.func,isRootSelectable:r.PropTypes.bool,treeRootName:r.PropTypes.string},getDefaultProps:function(){return{rootPath:"/",onFolderSelected:function(){},isRootSelectable:!1,treeRootName:null}},getInitialState:function(){return{showLoadingScreen:!1,tree:null}},componentWillMount:function(){var e;if(!this.state.tree)return e=this._constructRootItem(),this.setState({tree:E.createWithRootItem(e)})},componentDidMount:function(){return this._isMounted=!0,this.asyncFetchSubFoldersForItem(this.state.tree.rootItem)},componentWillUnmount:function(){if(this._isMounted=!1,this._pendingAjaxRequest)return this._pendingAjaxRequest.abort(),this._pendingAjaxRequest=null},_constructRootItem:function(){var e,t;return t=this.props.treeRootName||h.get_role_title(this.props.user)||M("Dropbox"),e=h.get_viewer().is_paired?this.props.user.is_team?"s_briefcase":"s_house":"dropbox",new N({key:this.props.rootPath,icon:e,label:t})},_parseFolderList:function(e){var n,s,r,o,a,i;for(a=JSON.parse(e),i=[],s=0,o=a.length;s<o;s++)n=a[s],r=n.path,i.push(new N({key:r,label:F(n.path),canExpand:n.has_subdirs,icon:n.icon,disabled:n.read_only}));return t.List(i)},asyncFetchSubFoldersForItem:function(e){var t,n,s,r,o;return r=e.key,s=e===this.state.tree.rootItem,s&&this.setState({showLoadingScreen:!0}),t=g.context(),t.isNonUserRelativeContext?(o="/browse_util/tree_view_team_folder_contents",n={ns_id:t.rootNSID,ns_path:r,hide_tmfs:!0}):(o="/browse_util/tree_view_folders",n={folder:r}),this._pendingAjaxRequest&&this._pendingAjaxRequest.abort(),this._pendingAjaxRequest=a.WebRequestOref({url:o,type:"POST",subject_user:this.props.user.id,data:n,success:(function(t){return function(n){var s,r;return s=t._parseFolderList(n),r=t.state.tree.setChildItems(e,s),t.setState({tree:r})}})(this),error:function(){return _.error(M("An error occurred while trying to load your folder."))},complete:(function(e){return function(){if(e._pendingAjaxRequest=null,e._isMounted&&s)return e.setState({showLoadingScreen:!1})}})(this)})},handleItemSelected:function(e){return this.props.onFolderSelected(e.key)},handleExpandButtonClick:function(e,t){if(t&&!this.state.tree.isParent(e))return this.asyncFetchSubFoldersForItem(e)},_renderLoadingMessage:function(){return k.span({className:"tree-view__loading-label"},M("Loading your folders…"))},render:function(){var e;return e=this.props.isRootSelectable?I.HeaderItem:I.StaticHeader,A(P,{tree:this.state.tree,rootStyle:e,onItemSelected:this.handleItemSelected,onItemExpanded:this.handleExpandButtonClick},this.state.showLoadingScreen?this._renderLoadingMessage():void 0)}}),{INDENT_SIZE_PX:b,MAX_LABEL_LENGTH:S,RootStyle:I,FolderTreeView:y,TreeView:P,TreeItemView:T,TreeItem:N,Tree:E}})}.call(this),define("modules/clean/sharing/actions/share_modal",["require","exports","tslib","jquery","external/react","external/react-dom","modules/clean/ajax","modules/clean/analytics","modules/clean/api_v2/error","modules/clean/browse_interface","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/growth/experiments/logger","modules/clean/growth/experiments/sharing_paywall_actions_store","modules/clean/previews/util","modules/clean/react/browse/constants","modules/clean/react/browse/nav_actions","modules/clean/react/browse/store","modules/clean/react/content_manager/api","modules/clean/react/file_viewer/store","modules/clean/react/modal","modules/clean/react/pass/actions","modules/clean/react/pass/constants","modules/clean/react/pass/store","modules/clean/react/pass/utils","modules/clean/sharing/action_types","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/api","modules/clean/sharing/api/types/metadata","modules/clean/sharing/api/util/types","modules/clean/sharing/confirmation_modals/member_access_change_confirmation_modal","modules/clean/sharing/confirmation_modals/relinquish_membership_confirmation_modal","modules/clean/sharing/confirmation_modals/simple_confirm_modal","modules/clean/sharing/constants","modules/clean/sharing/link_settings_modal","modules/clean/sharing/parent_folder_access_modal","modules/clean/sharing/share_page/action_types","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/stores/sharing_info_util","modules/clean/sharing/ui_util","modules/clean/teams/membership_discovery_util","modules/clean/teams/modals/create_team_prompt_modal","modules/clean/legacy_pyxl_controllers/ajax_form","modules/clean/zendesk_feedback","modules/constants/teams","modules/core/browser","modules/core/i18n","modules/core/notify"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,E,w,C,N,T,P,M,A,k,F,x,L,R,O,D,U,B,q,H,V,G,W,K,Y,z){"use strict";var j=r.createElement,Q=Y.i18n_default_project("sharing")._;return(function(){function t(t,s,o){var a=this;this.linkSeenStateInfo=null,this.groupSeenStateInfo=null,this.presentAccountIds=null,this.hasLoggedSet={},this.changeAccess=function(e,t,n){void 0===n&&(n=!1);var s=Promise.resolve({}),r=e.memberId(),o=a.getContentInfo(),i=o.id,l=g.BrowseStore.context().isNonUserRelativeContext;if(t===x.MEMBER_ACTION.REMOVE)r!==a.user.account_id||l?(s=(o.isFileFolder()?a.client.getParentFolderAccess({contentId:a.sharingInfo.parentSharedFolderId(),memberId:r}):a.removeMember(i,e,n,o.isFolder())).then(function(t){a.showParentFolderAccessModalIfQualified("remove",e,t)}),a.openShareModal()):a.client.relinquishMembership({contentId:i,leaveACopy:n}).then(function(){o.isFolder()?z.success(Q("Folder access removed.")):z.success(Q("File access removed.")),v.Modal.close(),a.redirectToBrowseUrl("/")});else if(t===x.ACCESS_LEVEL.OWNER)s=a.client.transferContent({contentId:i,memberId:r}).then(function(){a.dispatch(C.ShareModalActionTypes.TRANSFER_OWNER_SUCCESS),z.success(Q("Made %(name)s the owner").format({name:e.displayName()})),a.fetchInitialData(),a.openShareModal()});else{var d=void 0;if(o.isFileFolder()&&t===x.ACCESS_LEVEL.READER)d=a.client.getParentFolderAccess({contentId:a.sharingInfo.parentSharedFolderId(),memberId:r,accessLevel:t});else{var c=a.getContentInfo().isFileFolder();c&&a.dispatch(C.ShareModalActionTypes.MEMBER_ACTION_PENDING,{member:e}),d=a.shareIfFileFolder().then(function(){return c&&a.dispatch(C.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:e}),a.changeMemberAccess(a.getContentInfo().id,e,t)}).catch(function(){c&&a.dispatch(C.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:e})})}s=d.then(function(t){a.showParentFolderAccessModalIfQualified("update",e,t)})}return s.then(a.refreshSharedWithColumnContentData)},this.changeLinkAudience=function(e){var t=new P.CombinedPolicy({audience:e});if(a.getContentInfo().isFileFolder())return a.shareIfFileFolder(t);var n=a.sharingInfo.linkMetadata(),s=n&&n.current_audience||P.LinkAudience.members;a.dispatch(C.ShareModalActionTypes.CHANGE_LINK_AUDIENCE_REQUEST,{newAudience:e});var r,o;return a.getContentInfo().isFile()?(r=x.ALPHA_FILE_METADATA_PERMISSIONS,o=a.client.updatePolicy.bind(a.client)):(r=x.FOLDER_METADATA_PERMISSIONS,o=a.client.updatePolicyAlpha.bind(a.client)),o({actions:Object.keys(r),contentId:a.getContentInfo().id,newPolicy:t}).then(function(e){a.dispatch(C.ShareModalActionTypes.CHANGE_LINK_AUDIENCE_SUCCESS,{metadata:e})}).catch(l.catchApiError(function(){return a.dispatch(C.ShareModalActionTypes.CHANGE_LINK_AUDIENCE_FAILURE,{prevAudience:s}),Promise.reject({})}))},this.changeRecipientAccess=function(e){a.dispatch(C.ShareModalActionTypes.CHANGE_RECIPIENT_ACCESS,{newAccess:e})},this.changeRecipientMessage=function(e){a.dispatch(C.ShareModalActionTypes.CHANGE_RECIPIENT_MESSAGE,{message:e})},this.createSharedLink=function(){return a.log("CLICK_TIB_CREATE_LINK"),a.dispatch(C.ShareModalActionTypes.CREATE_LINK_REQUEST),a.client.createSharedLink({fileIdOrPath:a.getContentInfo().displayPath()}).then(function(e){a.dispatch(C.ShareModalActionTypes.CREATE_LINK_SUCCESS,{linkMetadata:e}),a.refreshSharedWithColumnLinkData()}).catch(l.catchApiError(function(e){return e instanceof l.AppError&&e.error&&"access_denied"===e.error[".tag"]&&(a.getContentInfo().isFolder()?z.error("You don’t have permission to create a link to this folder"):z.error("You don’t have permission to create a link to this file")),a.dispatch(C.ShareModalActionTypes.CREATE_LINK_FAILURE),Promise.reject(e)}))},this.fetchMetadataForFile=function(e){return N.SharingActions.loadFileMetadata({user:a.user,contentId:e.id,sourceUrl:e.url(),client:a.client}).catch(l.catchApiError(a.handleLoadingError))},this.fetchMetadataForFileFolder=function(e){var t,s,r=x.MEMBER_ACTION.ALL,o=a.user.is_cdm_member?x.VALIDATE_PATH_PERMISSIONS_CONFIDENTIAL_AWARE:x.VALIDATE_PATH_PERMISSIONS,i={actions:Object.keys(o),listMembersArg:{actions:r},shouldParseMetadataFromError:B.GoldenGate.canDeepNest(a.user.id)};return g.BrowseStore.context().isNonUserRelativeContext?(t=function(e){var t=y.validateFolderPath(e);return a.client.validatePathContinue(t,!1)},s={nsId:e.nsId(),nsPath:e.nsPath()}):(t=a.client.validateFqPath,s={fqPath:e.displayPath(),shareAsConfidential:a.sharingInfo.shareAsConfidential()}),t(n.__assign({},s,i)).then(function(e){var t=e.metadata,n=e.inheritedMembers;a.handleGetMetadataSuccess(t);var s=a.getContentInfo();a.listMembers(s.id,s.url(),s.isFileFolder()&&n||void 0)}).catch(l.catchApiError(a.handleLoadingError))},this.fetchMetadataForSharedFolder=function(e){var t,n;return a.user.is_cdm_member?(t=x.FOLDER_METADATA_PERMISSIONS_INTERNAL,n=a.client.getMetadataInternal):x.TRUELINK.TRUELINK_UI[a.user.id]?(t=x.ALPHA_FOLDER_METADATA_PERMISSIONS,n=a.client.getMetadataAlpha):(t=x.FOLDER_METADATA_PERMISSIONS,n=a.client.getMetadata),n({contentId:e.id,actions:Object.keys(t)}).then(a.handleGetMetadataSuccess).catch(l.catchApiError(a.handleLoadingError))},this.handleMemberAccessChange=function(e,t){var n=e.displayName();if(t===x.MEMBER_ACTION.REMOVE||t===x.ACCESS_LEVEL.OWNER){var s=t===x.MEMBER_ACTION.REMOVE&&e.memberId()===a.user.account_id,r=a.getContentInfo().isFolder(),o=a.getContentInfo().isNestedSharedFolder(),i=e.permissions.leave_a_copy&&e.permissions.leave_a_copy.allow,l=function(n){a.changeAccess(e,t,n===!0)},d=a.openShareModal;s?k.showRelinquishMembershipConfirmationModal(r,o,l,d,i):A.showMemberAccessChangeConfirmationModal(n,t,r,o,i,l,d)}else a.changeAccess(e,t)},this.handleGetMetadataSuccess=function(e){a.dispatch(C.ShareModalActionTypes.FETCH_METADATA_SUCCESS,{metadata:e}),p.dispatch({type:O.SharePageActionTypes.FETCH_METADATA_SUCCESS,metadata:e,user:a.user})},this.handleLinkSettingsClick=function(){var e=function(){a.refreshSharedWithColumnLinkData(),a.setLinkMetadata(void 0),a.openShareModal()},t=a.sharingInfo.getInitialProps().onDeleteLink||e,n=function(e){a.setLinkMetadata(e),a.refreshSharedWithColumnLinkData()},s=L.showUpgradeToBizBanner(a.user);i.TeamsWebActionsLogger.log("open_link_settings_modal"),v.Modal.showInstance(r.createElement(L.SharedLinkSettingsModal,{client:a.client,isFile:a.getContentInfo().isFile(),linkMetadata:a.sharingInfo.linkMetadata(),onClose:a.openShareModal,onDeleteLink:t,onPolicySet:n,showUpgradeToBiz:s,isTeam:a.user.is_team}))},this.handleLoadingError=function(e){e instanceof l.AppError?a.dispatch(C.ShareModalActionTypes.FETCH_METADATA_FAILURE,{reason:e.error&&e.error.bad_path&&e.error.bad_path[".tag"]}):(z.error(e.message||Q("There was a problem completing this request.")),v.Modal.close())},this.handleSelectLinkAudience=function(e){if(a.sharingInfo.contentInfo().isFile())return a.changeLinkAudience(e);var t=a.sharingInfo.linkMetadata(),n=t&&t.current_audience||P.LinkAudience.members,s=t.audience_options.toArray().indexOf(n),o=t.audience_options.toArray().indexOf(e);if(o<s){var i="";if(e===P.LinkAudience.public)i=Q("All items in this folder will become viewable by anyone with the link.");else{if(e!==P.LinkAudience.team)throw"audience type not supported: %(newAudience)s".format({newAudience:e});i=Q("All items in this folder will become viewable by anyone on your team.")}v.Modal.showInstance(r.createElement(F.SimpleConfirmModal,{title:Q("Change link audience?"),confirmText:Q("Change audience"),onConfirm:function(){a.changeLinkAudience(e),a.openShareModal()},onCancel:a.openShareModal},i))}else if(o>s)return a.changeLinkAudience(e)},this.openShareModal=function(){v.Modal.showInstance(j(a.shareModalClass,{actionHandler:a}))},this.recipientsChange=function(e,t){return void 0===t&&(t=""),Promise.resolve({}).then(function(){a.dispatch(C.ShareModalActionTypes.CHANGE_RECIPIENTS,{recipientTokens:e,recipientRawInput:t})})},this.redirectToPath=function(t,n){if(!g.BrowseStore.user()){var s=d.browse_uri_for_fq_path(a.user,t);return n&&s.updateQuery({shareoptions:"1"}),void K.redirect(s)}var r=function(){n&&e(["modules/clean/sharing/share_modal_util"],function(e){(0,e.showShareModal)(a.user,g.BrowseStore.context(),{origin:"PARENT_FOLDER_MODAL"})})};t!==g.BrowseStore.context().currentFQPath?(f.setUrl({path:t}),f.setPath({path:t,onPathLoaded:r})):r()},this.refreshSharedWithColumnContentData=function(){a.getContentInfo().isFolder()?p.dispatch({type:_.SharedWithActionTypes.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE,data:{}}):p.dispatch({type:_.SharedWithActionTypes.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE,data:{fileIds:[a.getContentInfo().id]}})},this.handleShareClick=function(e,t){return a.sharingInfo.contentInfo().pathExists()?a.sendShare(e):Promise.resolve().then(function(){a.setContentNameAndSendShare(e,t)})},this.shareIfFileFolder=function(e){if(!a.getContentInfo().isFileFolder())return Promise.resolve({});if(a.sharingInfo.shareFolderPromise())return a.sharingInfo.shareFolderPromise();var t;if(t=a.sharingInfo.isNonUserRelativeContext()?"ns:"+a.getContentInfo().nsId()+a.getContentInfo().nsPath():a.getContentInfo().displayPath(),x.TRUELINK.TRUELINK_UI[a.user.id]){var n=a.sharingInfo.linkMetadata();n&&n.current_audience!==P.LinkAudience.members&&(e||(e=new P.CombinedPolicy),e.audience||(e=e.set("audience",n.current_audience)))}var s,r={fqPath:t,folderPolicy:e,confidential:!1};return a.sharingInfo.shareAsConfidential()?(r.confidential=!0,s=a.client.shareInternal(r)):s=x.TRUELINK.TRUELINK_UI[a.user.id]?a.client.shareAlpha(r):a.client.share(r),a.dispatch(C.ShareModalActionTypes.SHARE_FOLDER_REQUEST,{promise:s}),s.then(function(e){return a.dispatch(C.ShareModalActionTypes.SHARE_FOLDER_SUCCESS,{metadata:e}),p.dispatch({type:O.SharePageActionTypes.FETCH_METADATA_SUCCESS,metadata:e,user:a.user}),e}).catch(function(){return a.dispatch(C.ShareModalActionTypes.SHARE_FOLDER_FAILURE),Promise.reject({})})},this.showParentFolderAccessModalIfQualified=function(e,t,n){null!=n&&v.Modal.showInstance(r.createElement(R.ParentFolderAccessModal,{contentInfo:a.getContentInfo(),memberAccessLevelResult:n,memberDisplayName:t.displayName(),originalAction:e,isInContentManager:a.sharingInfo.isNonUserRelativeContext(),onClose:a.openShareModal,onParentFolderClicked:a.redirectToPath}))},this.parseParentFolderAccessError=function(e){var t=e.error;if("member_error"===e.error[".tag"]&&(t=e.error.member_error),"no_explicit_access"===t[".tag"])return M.memberAccessLevelApiToRecord(a.user.id,t);z.error(e.message||Q("There was a problem completing this request."))},this.turnLinkOnIfQualified=function(){var e=a.sharingInfo.linkMetadata();return!x.TRUELINK.TRUELINK_UI[a.user.id]||!x.TRUELINK.BROAD_AUDIENCE[a.user.id]||a.sharingInfo.parentSharedFolderId()||e&&e.current_audience!==P.LinkAudience.members?Promise.resolve({}):a.waitForAllMembersLoaded().then(function(){if(!a.sharingInfo.hasNonOwnerMembers())return a.changeLinkAudience(P.LinkAudience.default_on)})},this.updateLinkSettings=function(){},this.waitForAllMembersLoaded=function(){if(a.sharingInfo.areMembersFullyLoaded())return Promise.resolve({});var e=a.sharingInfo.fetchingMembersRequest();return e&&e.promise||Promise.resolve({})},this.client=t,this.user=s,this.shareModalClass=o}return t.prototype.initializeShareModal=function(e,t){void 0===t&&(t={});var n=e.contentInfo;return p.dispatch({type:C.ShareModalActionTypes.SHARE_MODAL_OPEN,data:{shareModalInfo:e,initialProps:t},contentIds:U.getContentIdsForContentInfo(n),user:this.user}),this.sharingInfo=D.sharingInfoStore.getSharingInfo(this.user.id,n.id),this.fetchInitialData()},t.prototype.fetchInitialData=function(){var e=this.sharingInfo.contentInfo(),t=this.sharingInfo.isNonUserRelativeContext();this.beginTime=Date.now(),this.fetchPassInfo(),this.fetchUpsellExperimentVariant();var n=[];return e.isFileFolder()?n.push(this.fetchMetadataForFileFolder(e)):(n.push(this.listMembers(e.id,e.url())),e.isFile()?n.push(this.fetchMetadataForFile(e)):e.isSharedFolder()&&n.push(this.fetchMetadataForSharedFolder(e))),n.push(this.fetchMemberCounts()),x.TRUELINK.TRUELINK_UI[this.user.id]?(this.sharingInfo.isTeamPolicyLoaded()||n.push(this.fetchTeamPolicy()),this.sharingInfo.areSharingPrefsLoaded()||n.push(this.fetchSharingPrefs())):(n.push(this.fetchTeamPolicy()),n.push(this.fetchSharingPrefs()),this.sharingInfo.canShareLink()&&!t&&e.isMounted()&&n.push(this.fetchLinkMetadata())),x.SHARING_EXPERIMENTS.PAYWALL_SHARED_FOLDERS_ON_VARIANTS.indexOf(x.SHARING_EXPERIMENTS.PAYWALL_SHARED_FOLDER[this.user.id])>=0&&n.push(this.fetchSharingPaywallInfo()),Promise.all(n)},t.prototype.fetchPassInfo=function(){var e=this;this.sharingInfo.shouldBlockMemberListOnPassLoad()&&setTimeout(function(){return e.dispatch(C.ShareModalActionTypes.UNBLOCK_MEMBER_LIST_ON_PASS_LOAD)},4e3);var t=this.getPassFileInfo(),n=t.nsId,s=t.sjid;if(t.fromBrowse&&(m.is_pass_ga_receive_enabled(this.user)||m.is_pass_enabled(this.user))){var r=E.passFetchingStatus(n,s);I.fetchingStatusIsSuccessful(r)?(o=E.getLinkAndGroupInfo(n,s),this.linkSeenStateInfo=o[0],this.groupSeenStateInfo=o[1],this.presentAccountIds=E.presence(n,s)):r||w.PassHelpers.setup(this.user,this.getFileData(),null,!1);var o}},t.prototype.getSharingInfo=function(){return this.sharingInfo},t.prototype.clearCachedPassInfo=function(){e=[null,null,null],this.linkSeenStateInfo=e[0],this.groupSeenStateInfo=e[1],this.presentAccountIds=e[2];var e},t.prototype.getPassInfo=function(){var e=this.getContentInfo();if(!m.is_pass_ga_receive_enabled(this.user)&&!m.is_pass_enabled(this.user)||e.isFolder())return[[],{},[],I.PASS_FETCHING_STATUS.ERROR];if(this.linkSeenStateInfo&&this.groupSeenStateInfo&&this.presentAccountIds)return[this.linkSeenStateInfo,this.groupSeenStateInfo,this.presentAccountIds,I.PASS_FETCHING_STATUS.PASS_SUCCESS];var t=this.getPassFileInfo(),n=t.nsId,s=t.sjid;if(!n||!s)return l=[[],{},[]],this.linkSeenStateInfo=l[0],this.groupSeenStateInfo=l[1],this.presentAccountIds=l[2],[[],{},[],I.PASS_FETCHING_STATUS.ERROR];if(m.is_pass_ga_receive_enabled(this.user)){var r=E.getPassPermissions(e.id);if(E.isPassPermissionsPending(e.id)||null==r)return[[],{},[],I.PASS_FETCHING_STATUS.FETCHING];if(null!=r&&!r.canReadPresence)return[[],{},[],I.PASS_FETCHING_STATUS.ERROR]}var o=E.passFetchingStatus(n,s);if(I.fetchingStatusIsSuccessful(o)){var a=E.getLinkAndGroupInfo(n,s),i=E.presence(n,s);return this.linkSeenStateInfo=a[0],this.groupSeenStateInfo=a[1],this.presentAccountIds=i.slice(),this.isContentInfoForFilePreview(e)&&this.presentAccountIds.indexOf(this.user.account_id)<0&&this.presentAccountIds.push(this.user.account_id),[this.linkSeenStateInfo,this.groupSeenStateInfo,this.presentAccountIds,o]}return[[],{},[],o];var l},t.prototype.getPassFileInfo=function(){var e,t,n,s=this.getContentInfo(),r=!s.isFolder()&&["BROWSE_FILE_ROW","BROWSE_FILE_FACEPILE"].indexOf(s.extras.origin)>=0,o=["BROWSE_FILE_ROW","BROWSE_FILE_FACEPILE","PREVIEW_PAGE_FACEPILE","PREVIEW_PAGE"].indexOf(s.extras.origin)>=0;return o&&!s.isSharedFolder()?(e=s.nsId(),t=s.sjid(),n=s.beaconContext()):(a=[null,null,null],e=a[0],t=a[1],n=a[2]),{nsId:e,sjid:t,beaconContext:n,fromBrowse:r,contentInfoId:s.id};var a},t.prototype.getUrl=function(){return this.getPassFileInfo().fromBrowse?void 0:b.FileViewerStore.instance.getSharedLinkInfo()&&b.FileViewerStore.instance.getSharedLinkInfo().url},t.prototype.getFileData=function(e){var t=this.getPassFileInfo();return{file:{ns_id:t.nsId,sjid:t.sjid,beacon_context:t.beaconContext,file_id:t.contentInfoId},url:e}},t.prototype.getContentInfo=function(){return this.sharingInfo.contentInfo()},t.prototype.dispatch=function(e,t){void 0===t&&(t={}),p.dispatch({type:e,data:t,contentIds:[this.getContentInfo().id],user:this.user})},t.prototype.changeMemberAccess=function(e,t,n){var s=this,r=t.access_type;return this.dispatch(C.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_REQUEST,{member:t,newAccess:n}),this.client.updateMember({contentId:e,memberId:t.memberId(),accessLevel:n}).then(function(e){if(e.access_level&&e.warning)return s.dispatch(C.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_FAILURE,{member:t,prevAccess:e.access_level}),e}).catch(l.catchApiError(function(e){
return s.dispatch(C.ShareModalActionTypes.CHANGE_MEMBER_ACCESS_FAILURE,{member:t,prevAccess:r}),s.parseParentFolderAccessError(e)}))},t.prototype.fetchLinkMetadata=function(){var e=this;return x.TRUELINK.TRUELINK_UI[this.user.id]?Promise.resolve({}):(this.dispatch(C.ShareModalActionTypes.FETCH_LINK_METADATA_REQUEST),this.client.sharedLinkInfo({fileIdOrPath:this.getContentInfo().idForLink()}).then(function(t){e.dispatch(C.ShareModalActionTypes.FETCH_LINK_METADATA_SUCCESS,{linkMetadata:t})}).catch(function(){e.dispatch(C.ShareModalActionTypes.FETCH_LINK_METADATA_FAILURE),g.BrowseStore.context().isNonUserRelativeContext||(z.error(Q("There was a problem completing this request.")),v.Modal.close())}))},t.prototype.fetchMemberCounts=function(){var e=this,t=this.getContentInfo();return this.dispatch(C.ShareModalActionTypes.FETCH_MEMBER_COUNTS_REQUEST),t.isSharedFolder()||t.isFolder()&&t.isInSharedFolder()?this.client.getMemberCounts({contentId:t.isSharedFolder()?t.sharedFolderId():t.nsId()}).then(function(t){e.dispatch(C.ShareModalActionTypes.FETCH_MEMBER_COUNTS_SUCCESS,{memberCounts:t})}):Promise.resolve({})},t.prototype.fetchSharingPrefs=function(){var e=this;return this.dispatch(C.ShareModalActionTypes.FETCH_SHARING_PREFS_REQUEST),this.client.getSharingPrefs().then(function(t){e.dispatch(C.ShareModalActionTypes.FETCH_SHARING_PREFS_SUCCESS,{sharingPrefs:t})})},t.prototype.fetchUpsellExperimentVariant=function(){var e=this;a.SilentBackgroundRequest({url:"/get_sl_upsell_variant",data:{_subject_uid:this.user.id},success:function(t){var n=JSON.parse(t);n&&n.variant&&e.dispatch(C.ShareModalActionTypes.FETCH_UPSELL_EXPERIMENT_VARIANT,n)}})},t.prototype.fetchSharingPaywallInfo=function(){var e=this;return this.dispatch(C.ShareModalActionTypes.FETCH_SHARING_PAYWALL_INFO_REQUEST),this.client.getSharingPaywallInfo().then(function(t){e.dispatch(C.ShareModalActionTypes.FETCH_SHARING_PAYWALL_INFO_SUCCESS,{sharingPaywallInfo:t})})},t.prototype.logPaywallEvent=function(e,t){void 0===t&&(t={}),t.num_folders_owned=this.sharingInfo.paywallNumOwned(),u.log(h.PAYWALL_SERIES_LOGGING_NAME,e,t)},t.prototype.onShareModalUnmount=function(e){this.teardownPass(),this.sharingInfo.foldersToUnshare()&&this.sharingInfo.foldersToUnshare().size>0&&this.unshareFoldersBatch();var t=e&&e.serializeInputData()||{};this.dispatch(C.ShareModalActionTypes.SHARE_MODAL_CLOSE,t)},t.prototype.onUnshareFromPaywall=function(e){this.dispatch(C.ShareModalActionTypes.UNSHARE_FROM_PAYWALL,e)},t.prototype.unshareFoldersBatch=function(){var e=this.sharingInfo.foldersToUnshare().map(function(e){return String(e)}),t=this.sharingInfo.paywallKeepACopy();this.client.unshareFolderBatch({nsIds:e,leaveACopy:t}),this.dispatch(C.ShareModalActionTypes.CLEAR_UNSHARE_FROM_PAYWALL)},t.prototype.fetchTeamPolicy=function(){var e=this;return this.dispatch(C.ShareModalActionTypes.FETCH_TEAM_POLICY_REQUEST),this.client.getCurrentAccountCached().then(function(t){e.dispatch(C.ShareModalActionTypes.FETCH_TEAM_POLICY_SUCCESS,{teamPolicy:t.team&&t.team.sharing_policies})})},t.prototype.getSuggestableUsers=function(t){var n=this;q.filterSuggestableUsers(t,function(t){var s=t.contacts,o=t.is_admin;s.length>0?e(["modules/clean/teams/membership_suggestion_modal"],function(e){var t=e.MembershipSuggestionModal;v.Modal.showInstance(r.createElement(t,{isAdmin:o,isFile:n.sharingInfo.contentInfo().isFile(),contacts:s}))}):v.Modal.close()},function(){return v.Modal.close()})},t.prototype.handleContentNameChange=function(e){var t="SIMPLIFIED_WIZARD_UI::CONTENT_NAME_CHANGE";this.hasLoggedSet[t]||(this.sharingExperimentsLog(t),this.hasLoggedSet[t]=!0),this.dispatch(C.ShareModalActionTypes.HANDLE_CONTENT_NAME_CHANGE,{name:e})},t.prototype.handleContentNameFocusChange=function(e){this.dispatch(C.ShareModalActionTypes.HANDLE_CONTENT_NAME_FOCUS_CHANGE,{focus:e})},t.prototype.handleUpdateFilePolicy=function(e,t){this.handleUpdateSharingSettings(e);var n=this.getSharingInfo().filePolicy(),s=this.getPassFileInfo(),r=s.nsId,o=s.sjid,a=s.fromBrowse,i=s.contentInfoId;if(null!=r&&null!=o)if(n.pass_policy===P.PassPolicy.disabled&&t.pass_policy===P.PassPolicy.enabled)this.clearCachedPassInfo(),S.PassActions.resetPassInfo(r,o),S.PassActions.fetchPassError(r,o),this.dispatch(C.ShareModalActionTypes.CLEAR_FILE_MEMBERSHIP_LAST_SEEN_INFO);else{var l=n.audience===P.LinkAudience.members!=(t.audience===P.LinkAudience.members),d=n.pass_policy===P.PassPolicy.enabled&&t.pass_policy===P.PassPolicy.disabled;if(l||d){this.clearCachedPassInfo();var c=this.getUrl();d&&this.listMembers(i,c),w.PassHelpers.setup(this.user,this.getFileData(c),null,!a)}}},t.prototype.handleUpdateSharingSettings=function(e){this.dispatch(C.ShareModalActionTypes.UPDATE_SHARING_SETTINGS_SUCCESS,{metadata:e})},t.prototype.listMembers=function(e,t,n){return N.SharingActions.listMembers({user:this.user,contentId:this.getContentInfo().id,isFolder:this.sharingInfo.isFolder(),url:t,members:n,client:this.client})},t.prototype.isContentInfoForFilePreview=function(e){return("PREVIEW_PAGE"===e.extras.origin||"PREVIEW_PAGE_FACEPILE"===e.extras.origin)&&!e.isFolder()},t.prototype.log=function(e,t){void 0===t&&(t={}),B.logTiburonEvent(this.getContentInfo(),this.user.id,e,t)},t.prototype.logIfHaventBefore=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=!0),this.hasLoggedSet[e]||(this.hasLoggedSet[e]=!0,n&&(t.timing=Date.now()-this.beginTime),this.log(e,t))},t.prototype.onClickX=function(e){e&&e.finishLogging(!0),this.showTruelinkFeedbackIfQualified(),v.Modal.close()},t.prototype.redirectToBrowseUrl=function(e){f.setUrl({path:e})},t.prototype.redirectToUpgrade=function(){K.redirect("/upgrade?oqa=spw")},t.prototype.refreshSharedWithColumnLinkData=function(){p.dispatch({type:_.SharedWithActionTypes.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE,data:{fileFqPaths:[this.getContentInfo().displayPath()]}})},t.prototype.removeMember=function(e,t,n,s){var r=this;return this.dispatch(C.ShareModalActionTypes.MEMBER_ACTION_PENDING,{member:t}),this.client.removeMember({contentId:e,memberId:t.memberId(),leaveACopy:n}).then(function(e){return r.fetchMemberCounts().then(function(){if(e&&null!=e.access_level&&null!=e.warning)return r.dispatch(C.ShareModalActionTypes.REMOVE_MEMBER_KEEP_ACCESS,{member:t,access:e.access_level}),e;s?z.success(Q("Folder access removed.")):z.success(Q("File access removed.")),r.dispatch(C.ShareModalActionTypes.REMOVE_MEMBER_SUCCESS,{member:t})})}).catch(l.catchApiError(function(e){return r.dispatch(C.ShareModalActionTypes.MEMBER_ACTION_COMPLETE,{member:t}),r.parseParentFolderAccessError(e)}))},t.prototype.setAddMessageAsCommentChecked=function(e){this.dispatch(C.ShareModalActionTypes.SET_COMMENT_CHECKBOX_PREF_REQUEST,{checked:e}),this.client.setSharingPrefs({add_message_as_comment_checked:e})},t.prototype.setAddMessageAsCommentHelpClosed=function(){this.dispatch(C.ShareModalActionTypes.SET_COMMENT_CHECKBOX_HELP_PREF_REQUEST),this.client.setSharingPrefs({add_message_as_comment_help_shown:!1})},t.prototype.setContentNameAndSendShare=function(e,t){var n=this,r=o.findDOMNode(t),a=r&&r.value,i=c.parent_dir(this.sharingInfo.fqPath());new T.SharingApi(this.user).validate_new_sf_path(a,B.getNewFolderPathFromContentName(a,i),function(){n.dispatch(C.ShareModalActionTypes.VALIDATE_CONTENT_NAME_SUCCESS,{contentName:a}),n.sendShare(e)},function(e){n.sharingExperimentsLog("SIMPLIFIED_WIZARD_UI::INVALID_CONTENT_NAME");var t=V.extract_errors(e.responseText);n.dispatch(C.ShareModalActionTypes.VALIDATE_CONTENT_NAME_ERROR,{errorMsg:t.folder_name&&t.folder_name.message_text});var o=s(r);o&&o.select()})},t.prototype.setLinkMetadata=function(e){this.dispatch(C.ShareModalActionTypes.FETCH_LINK_METADATA_SUCCESS,{linkMetadata:e})},t.prototype.paywallGrandfatherModalDismiss=function(){this.dispatch(C.ShareModalActionTypes.PAYWALL_GRANDFATHER_MODAL_DISMISS)},t.prototype.paywallGrandfatherModalLearnMore=function(){this.logPaywallEvent("view_learn_more"),this.dispatch(C.ShareModalActionTypes.PAYWALL_GRANDFATHER_MODAL_LEARN_MORE)},t.prototype.sendShare=function(e){var t=this;this.log("CLICK_TIB_SEND_BUTTON");var n,s=Date.now(),o=this.isNewlySharedContent();return this.recipientsChange(e&&e.getContacts()).then(function(){return t.sharingInfo.contactsError().level===B.CONTACT_ERROR_LEVEL.ERROR?Promise.reject({}):(t.dispatch(C.ShareModalActionTypes.SEND_SHARE_REQUEST),n=M.contactsToMembers(t.sharingInfo.recipientTokens()),t.shareIfFileFolder())}).then(function(){return t.turnLinkOnIfQualified(),t.client.addMembers({accessLevel:t.sharingInfo.recipientAccess(),contentId:t.sharingInfo.contentInfo().id,addMessageAsComment:t.sharingInfo.isAddMessageAsCommentChecked(),customMessage:t.sharingInfo.recipientMessage(),members:n})}).catch(l.catchApiError(function(e){return t.dispatch(C.ShareModalActionTypes.SEND_SHARE_FAILURE),z.error(B.genAddMemberErrorMessage(e)),t.log("SHARE_MODAL_SEND_FAIL",{timing:Date.now()-s,num_recipients:n.length}),Promise.reject({})})).then(function(){if(t.dispatch(C.ShareModalActionTypes.SEND_SHARE_SUCCESS),z.success(B.genShareSuccessMessage(t.sharingInfo.recipientTokens(),t.sharingInfo.contentInfo().name(),t.sharingInfo.isTeamSharedFolder(),t.sharingInfo.isFolderInsideTeamFolderTree())),t.log("SHARE_MODAL_SEND_SUCCESS",{timing:Date.now()-s,num_recipients:n.length}),t.sharingInfo.getInitialProps().onSuccessSharing&&t.sharingInfo.getInitialProps().onSuccessSharing(),e&&e.finishLogging(!1),t.refreshSharedWithColumnContentData(),W.SHOW_CREATE_TEAM_MODAL_AFTER_SHARING&&o&&n.length>=2)v.Modal.showInstance(r.createElement(H.CreateTeamPromptModal,{invitedMembers:t.sharingInfo.recipientTokens().filter(function(e){return e.email!==t.user.email})}));else if("V1"===W.SUBGROWTH_BIZ_UPSELL_VARIANT&&t.sharingInfo.ownerTeam()){var a=t.sharingInfo.recipientTokens().map(function(e){return e.email});t.getSuggestableUsers(a)}else t.showTruelinkFeedbackIfQualified(),v.Modal.close()})},t.prototype.isNewlySharedContent=function(){var e=this.getContentInfo();return e.isFileFolder()||e.isFile()&&!this.sharingInfo.hasNonOwnerMembers()},t.prototype.sharingExperimentsLog=function(e,t){void 0===t&&(t={});var n=this.getContentInfo().extras.modalSessionId;t.modalSessionId=t.modalSessionId||n,i.SharingExperimentsLogger.log(this.user.id,e,t)},t.prototype.showTruelinkFeedbackIfQualified=function(){x.TRUELINK.TRUELINK_UI[this.user.id]&&(this.sharingInfo.hasChangedSharingSettings()?G.showFeedbackFlyoutIfAllowed("settings"):this.sharingInfo.hasChangedLinkAudience()&&G.showFeedbackFlyoutIfAllowed("sender"))},t.prototype.teardownPass=function(){this.clearCachedPassInfo(),this.getPassFileInfo().fromBrowse&&w.PassHelpers.teardown(this.user,this.getFileData(),!0,!1)},t.prototype.updateBanner=function(e){this.dispatch(C.ShareModalActionTypes.UPDATE_BANNER,{banner:e})},t})()}),function(){define("modules/clean/sharing/api",["modules/clean/ajax","modules/core/exception","jquery"],function(e,t,n){var s,r,o;return o=e.WebRequest,s=e.FormWebRequest,t.assert,r=(function(){function e(e){this.user=e}return e.REQUEST_SUCCEEDED_EVENT="db:sharing_api:request_succeeded",e.prototype.get_sync_vars_for_ns_id=function(e,t,n,s){var r;return r={ns_id:e,sub_path:t},this._make_request("/sharing/get_sync_vars_for_ns_id",r,n,s,!0)},e.prototype.validate_new_sf_path=function(e,t,n,s){var r;return r={share_type:"new",folder_name:e,path:t},this._make_request("/share_ajax/validate_folder",r,n,s,!0)},e.prototype.validate_shareable_existing_sf_path=function(e,t,n){var s;return s={share_type:"shareable_existing",path:e},this._make_request("/share_ajax/validate_folder",s,t,n,!0)},e.prototype._make_request=function(t,r,a,i,l,d){var c,p;return null==l&&(l=!1),null==d&&(d=!0),c={url:t,data:r,success:function(s,o,i){return"function"==typeof a&&a(i),n(document).trigger(e.REQUEST_SUCCEEDED_EVENT,{request_url:t,ns_id:r.ns_id||null})},error:function(e){return"function"==typeof i?i(e):void 0},complete:(function(e){return function(){var t;return null!=(t=e.loading_elem)?t.removeClass("ajax-loading"):void 0}})(this)},d&&(c.subject_user=this.user.id),null!=(p=this.loading_elem)&&p.addClass("ajax-loading"),(l?s:o)(c)},e})(),{SharingApi:r}})}.call(this),define("modules/clean/sharing/components/button_group",["require","exports","tslib","external/react","external/classnames","modules/clean/react/css"],function(e,t,n,s,r,o){"use strict";var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this;return s.createElement("div",{className:"c-btn-group sharing-button-group"},this.props.options.map(function(t){var n=t.value,o=t.label,a=n===e.props.value;return s.createElement("button",{key:n,className:r({"c-btn":!0,"c-btn--secondary":!a,"c-btn--primary":a}),onClick:function(){return e.props.onSelectValue(n)},disabled:a},o)}))},t})(s.Component);t.ButtonGroup=o(a,["/static/css/sharing/components-vflrV8W4h.css"])}),define("modules/clean/sharing/confirmation_modals/confirm_with_option_modal",["require","exports","tslib","external/react","modules/clean/react/modal"],function(e,t,n,s,r){"use strict";var o=(function(e){function t(t){var n=e.call(this,t)||this;if(null==n.props.children)throw new Error("Must have children prop");return n.state={checked:!1},n.handleOptionClick=n.handleOptionClick.bind(n),n.handleAccept=n.handleAccept.bind(n),n.handleDismissCompleted=n.handleDismissCompleted.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(r.Modal,{acceptButtonText:this.props.confirmText,autoClose:this.props.autoClose,className:"simple-modal confirm-with-option-modal",dismissButtonText:this.props.cancelText,onAccept:this.handleAccept,onDismissCompleted:this.handleDismissCompleted,title:this.props.title},s.createElement("div",{className:"simple-modal-content"},s.createElement("div",{className:"confirm-with-option-modal__body-text"},this.props.children),this.renderOption()))},t.prototype.renderOption=function(){return this.props.showOption?s.createElement("div",{className:"u-mar-vertical-s confirm-with-option-modal__option"},s.createElement("input",{"aria-checked":this.state.checked,checked:this.state.checked,className:"confirm-with-option-modal__option-input",id:"confirm-with-option-modal__input",name:"confirmation_option",onClick:this.handleOptionClick,role:"checkbox",type:"checkbox"}),s.createElement("label",{className:"confirm-with-option-modal__option-label",htmlFor:"confirm-with-option-modal__input"},this.props.optionLabel)):null},t.prototype.handleOptionClick=function(){this.setState({checked:!this.state.checked})},t.prototype.handleAccept=function(){this.props.onConfirm&&this.props.onConfirm(this.state.checked)},t.prototype.handleDismissCompleted=function(){this.props.onCancel&&this.props.onCancel(this.state.checked)},t})(s.Component);t.ConfirmWithOptionModal=o}),function(){define("modules/clean/sharing/confirmation_modals/member_access_change_confirmation_modal",["external/purify","external/react","modules/clean/em_string","modules/clean/react/modal","modules/clean/react_format","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,s,r,o,a,i){var l,d,c,p,u,h,m,_;return c=s.Modal,m=r.reactFormat,l=o.ConfirmWithOptionModal,d=a.MEMBER_ACTION,u=t.createElement,h=t.DOM,p=i.i18n_default_project("sharing")._,_=function(e,t,s,r,o,a,i){var _,f,g,y,b;return y=n.em_snippet(e,40),g=null,t===d.REMOVE?(b=p("Remove access for %(name)s?").format({name:y}),s?(_=r?m(p("<strong>%(name)s</strong> may still have access to this folder through a company group or parent folder."),{strong:h.strong(),name:y}):m(p("If you remove <strong>%(name)s</strong>, they won’t be able to see future changes to these files."),{strong:h.strong(),name:y}),o&&(g=p("%(name)s should be able to keep a copy of these files").format({name:y}))):_=m(p("If you continue, <strong>%(name)s</strong> will lose access to this file."),{strong:h.strong(),name:y}),f=p("Remove")):(b=p("Make %(name)s the owner of this folder?").format({name:y}),_=m(p("Only <strong>%(name)s</strong> will be able to unshare this folder or change folder settings."),{strong:h.strong(),name:y}),f=p("Make owner")),c.showInstance(u(l,{autoClose:!1,confirmText:f,cancelText:p("Cancel"),onConfirm:a,onCancel:i,optionLabel:g,showOption:null!=g,title:b},_))},{showMemberAccessChangeConfirmationModal:_}})}.call(this),function(){define("modules/clean/sharing/confirmation_modals/relinquish_membership_confirmation_modal",["external/purify","external/react","modules/clean/react/modal","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","modules/core/i18n"],function(e,t,n,s,r){var o,a,i,l,d;return a=n.Modal,o=s.ConfirmWithOptionModal,l=t.createElement,i=r.i18n_default_project("sharing")._,d=function(e,t,n,s,r){var d,c,p;return c=null,e?(p=i("Remove your access to this folder?"),d=i(t?"You may still have access to this folder through a company group or parent folder.":"If you continue, you won’t be able to access this folder anymore."),r&&(c=i("Keep a copy of this folder"))):(p=i("Remove your access to this file?"),d=i("If you continue, you won’t be able to access this file anymore.")),a.showInstance(l(o,{cancelText:i("Cancel"),confirmText:i("Remove my access"),onCancel:s,onConfirm:n,optionLabel:c,showOption:null!=c,title:p},d))},{showRelinquishMembershipConfirmationModal:d}})}.call(this),define("modules/clean/sharing/confirmation_modals/reset_access_modal",["require","exports","external/react","modules/clean/em_string","modules/clean/react/modal","modules/clean/sharing/confirmation_modals/confirm_with_option_modal","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,s,r,o,a,i){"use strict";function l(e){var t;t=d(e.linkAccessLanguage?e.isFolder?"Everyone else will lose access to this folder and its link         except those who have access from a parent folder.         You’ll still keep a copy of this folder in your Dropbox.":"Everyone else will lose access to this file and its link         except those who have access from a parent folder.         You’ll still keep a copy of this file in your Dropbox.":e.isFolder?"Everyone else will lose access to this folder. You’ll         still keep a copy of this folder in your Dropbox.":"Everyone else will lose access to this file. You’ll         still keep a copy of this folder in your Dropbox.");var i=d("Unshare “%(content_name)s”?").format({content_name:s.em_snippet(e.contentName,a.SNIPPET_SIZES.FILENAME)});r.Modal.showInstance(n.createElement(o.ConfirmWithOptionModal,{cancelText:d("Cancel"),confirmText:d("Unshare"),onCancel:e.onCancel,onConfirm:e.onConfirm,optionLabel:d("Let my collaborators keep a copy of these files."),showOption:e.allowLeaveACopy&&e.isFolder,title:i},t))}var d=i.i18n_default_project("sharing")._;t.confirmResetAccess=l}),define("modules/clean/sharing/confirmation_modals/simple_confirm_modal",["require","exports","tslib","external/react","modules/clean/react/modal","modules/core/i18n"],function(e,t,n,s,r,o){"use strict";var a=o.i18n_default_project("sharing")._,i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(r.Modal,{style:"bare"},s.createElement("div",{className:"simple-confirm-modal"},s.createElement("div",{className:"simple-confirm-modal__main"},s.createElement("div",{className:"simple-confirm-modal__title"},this.props.title),s.createElement("div",{className:"simple-confirm-modal__body"},this.props.children)),s.createElement("div",{className:"simple-confirm-modal__footer"},s.createElement("button",{className:"simple-confirm-modal__cancel c-btn c-btn--secondary",onClick:this.props.onCancel},this.props.cancelText||a("Cancel")),s.createElement("button",{className:"simple-confirm-modal__confirm c-btn c-btn--primary",onClick:this.props.onConfirm},this.props.confirmText))))},t})(s.Component);t.SimpleConfirmModal=i}),define("modules/clean/sharing/content_info",["require","exports","tslib","external/immutable","modules/constants/python"],function(e,t,n,s,r){"use strict";function o(e){var t=(e.isFolder?e.targetNsId:e.fileId)||e.fqPath;if(null===t)throw new Error("Not enough fields provided for extras");return t}var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.createFromParams=function(e){var n=new i(e);return new t({extras:n,id:o(n)})},t.prototype.setNsId=function(e){var t=this.setIn(["extras","targetNsId"],e);return t.set("id",o(t.extras))},t.prototype.setFQPath=function(e){var t=this.setIn(["extras","fqPath"],e);return t.set("id",o(t.extras))},t.prototype.isFolder=function(){return this.extras.isFolder},t.prototype.isFile=function(){return!this.isFolder()},t.prototype.isFileFolder=function(){return this.isFolder()&&!this.isSharedFolder()},t.prototype.isSharedFolder=function(){return Boolean(this.extras.targetNsId)},t.prototype.isTeamSharedFolder=function(){return this.extras.isTeamSharedFolder},t.prototype.isInSharedFolder=function(){return Boolean(this.extras.nsId&&this.extras.nsId!==this.extras.userHomeNs)},t.prototype.isNestedSharedFolder=function(){return this.isInSharedFolder()&&this.isSharedFolder()},t.prototype.isOSXPackage=function(){var e=this.extras.fqPath,t=e.substr(e.lastIndexOf("."));return r.PACKAGE_EXTS.indexOf(t)>=0},t.prototype.isMounted=function(){return!this.extras.url},t.prototype.url=function(){return this.extras.url},t.prototype.pathExists=function(){return Boolean(this.extras.exists)},t.prototype.name=function(){return this.displayPath()?this.displayPath().split("/").pop():this.filename()},t.prototype.idForLink=function(){var e=this.extras.fileId||this.extras.fqPath;if(!e)throw new Error("No identifiers for getting links");return e},t.prototype.sharedFolderId=function(){var e=this.extras.targetNsId;if(!e)throw new Error("No shared folder ID");return e},t.prototype.displayPath=function(){return this.extras.fqPath},t.prototype.filename=function(){return this.extras.filename},t.prototype.nsId=function(){if(!this.extras.nsId)throw new Error("Can't determine nsId");return this.extras.nsId},t.prototype.nsPath=function(){if(null===this.extras.nsPath)throw new Error("Can't determine nsPath");return this.extras.nsPath},t.prototype.sjid=function(){return this.extras.sjid},t.prototype.teamGroupInfo=function(){return this.extras&&this.extras.teamGroupInfo},t.prototype.beaconContext=function(){return this.extras&&this.extras.beaconContext},t})(s.Record({extras:null,id:null},"ContentInfo"));t.ContentInfo=a;var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(s.Record({beaconContext:null,exists:!0,fileId:null,filename:null,fqPath:null,isFolder:null,isTeamSharedFolder:!1,modalSessionId:null,nsId:null,nsPath:null,origin:null,sjid:null,targetNsId:null,url:null,userHomeNs:null,teamGroupInfo:null},"ContentInfoExtras"));t.ContentInfoExtras=i}),define("modules/clean/sharing/file_settings_modal",["require","exports","tslib","external/react","modules/clean/api_v2/error","modules/clean/em_string","modules/clean/flux/dispatcher","modules/clean/previews/util","modules/clean/react/browse/constants","modules/clean/react/modal","modules/clean/react/pass/store","modules/clean/react/util","modules/clean/sharing/actions/sharing_actions","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/confirmation_modals/reset_access_modal","modules/clean/sharing/constants","modules/clean/sharing/settings_modal_components","modules/clean/sharing/sharing_settings_modal","modules/clean/sharing/sharing_settings_util","modules/core/i18n","modules/core/notify"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g,y,b,v,S){"use strict";var I=v.i18n_default_project("sharing")._,E=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleAcceptClick=function(){var e=n.getPolicyUpdate();e?p.setStatePromise(n,{isSubmitting:!0}).then(function(){return n.getClient().updatePolicy({contentId:n.props.contentId,newPolicy:e,actions:Object.keys(f.ALPHA_FILE_METADATA_PERMISSIONS)})}).catch(r.catchApiError(function(){n.setState({isSubmitting:!1}),Promise.reject({})})).then(function(e){S.success(I("File settings updated")),n.props.onPolicySet&&n.props.onPolicySet(e)}):n.props.onPolicySet&&n.props.onPolicySet(void 0)},n.handleDismissClick=function(){d.Modal.close(),n.props.onCancel&&n.props.onCancel()},n.handleDismissCompleted=function(){n.props.onCancel&&n.props.onCancel()},n.handlePolicyUpdate=function(e,t){n.setState({desiredPolicy:n.state.desiredPolicy.set(e,t)})},n.getPolicyUpdate=function(){return n.state.desiredPolicy.equals(n.props.initialPolicy)?null:n.state.desiredPolicy},n.handleUnshareFile=function(){var e=function(){return n.getClient().unshare({contentId:n.props.contentId}).then(function(){n.refreshSharedMemberData(),S.success(I("Unshared %(file_name)s").format({file_name:n.props.fileName})),d.Modal.close(),f.TRUELINK.TRUELINK_UI[n.props.user.id]&&u.SharingActions.loadFileMetadata({user:n.props.user,contentId:n.props.contentId})})};_.confirmResetAccess({allowLeaveACopy:!1,contentName:n.props.fileName,isFolder:!1,linkAccessLanguage:f.TRUELINK.TRUELINK_UI[n.props.user.id],onConfirm:e})},n.refreshSharedMemberData=function(){a.dispatch({type:l.SharedWithActionTypes.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE,data:{fileIds:[n.props.contentId]}})},n.state={isSubmitting:!1,desiredPolicy:t.initialPolicy},n}return n.__extends(t,e),t.prototype.render=function(){return f.TRUELINK.TRUELINK_UI[this.props.user.id]?this.openSharingSettingsModal():s.createElement(w,{canChangeOptions:this.props.canChangeOptions,canUnshareFile:this.props.canUnshareFile,contentId:this.props.contentId,desiredPolicy:this.state.desiredPolicy,fileName:this.props.fileName,handleUnshareFile:this.handleUnshareFile,isSubmitting:this.state.isSubmitting,onAccept:this.handleAcceptClick,onDismiss:this.handleDismissClick,onDismissCompleted:this.handleDismissCompleted,onPolicyUpdate:this.handlePolicyUpdate,user:this.props.user})},t.prototype.getClient=function(){return new h.FileShareApiClient({userId:this.props.user.id})},t.prototype.openSharingSettingsModal=function(){var e=this,t=function(t,n){var s=e.props.canChangeOptions;return b.isCommonSharingSettingsPolicy(t)&&(s=b.canChangePolicy(t,e.props.initialPolicy,e.state.desiredPolicy,e.props.linkMetadata,e.props.permissions)),[e.state.desiredPolicy.get(t),s]};return s.createElement(y.SharingSettingsModal,{contentId:this.props.contentId,currentPolicy:this.props.initialPolicy,fileName:this.props.fileName,folderName:this.props.fileName,getEffectivePolicyValue:t,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,isFolder:!1,isLoading:!1,isSubmitting:this.state.isSubmitting,linkMetadata:this.props.linkMetadata,onDismiss:this.handleDismissClick,onOptionChange:this.handlePolicyUpdate,onSaveSettings:this.handleAcceptClick,onUnshare:this.handleUnshareFile,ownerTeam:this.props.ownerTeam,permissions:this.props.permissions,policyUpdate:this.getPolicyUpdate(),user:this.props.user})},t})(s.Component);E.displayName="FileSettingsModal",t.FileSettingsModal=E;var w=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e;return this.props.canChangeOptions&&(e=s.createElement(g.SettingsModalButtons,{disableSave:!1,isAccepting:this.props.isSubmitting,onAccept:this.props.onAccept,onDismiss:this.props.onDismiss})),s.createElement(d.Modal,{autoClose:!1,className:"file-settings-modal",buttonComponent:s.createElement("span",null),onDismissCompleted:this.props.onDismissCompleted,title:I("“%(file_name)s” settings").format({file_name:o.em_snippet(this.props.fileName,f.SNIPPET_SIZES.FILENAME)})},s.createElement("div",{className:"file-settings-form"},this.renderHeader(),this.renderPolicies(),this.renderButtons(),e))},t.prototype.renderHeader=function(){if(!this.props.canChangeOptions)return s.createElement("div",{className:"u-pad-xs u-font-center u-mar-bottom-s file-settings-form__no-permission-banner"},I("You don’t have permission to change the settings on this file."))},t.prototype.renderPolicies=function(){var e,t=i.is_pass_ga_receive_enabled(this.props.user)&&(e=c.getPassPermissions(this.props.contentId))&&e.canReadPresence;return s.createElement("div",null,i.is_pass_enabled(this.props.user)||t?this.renderPassPolicy():void 0)},t.prototype.renderPassPolicy=function(){return s.createElement(g.SinglePolicyControl,{canChange:this.props.canChangeOptions,policyName:m.PassPolicy.policy_name,policyDescription:I("Show who accessed this file?"),currentValue:this.props.desiredPolicy.pass_policy,options:[{label:I("Only show to people on your Dropbox team"),value:m.PassPolicy.enabled},{label:I("Don’t show"),value:m.PassPolicy.disabled}],handleOptionChange:this.props.onPolicyUpdate})},t.prototype.renderButtons=function(){var e;return this.props.canUnshareFile&&(e=s.createElement("div",{className:"u-l-fl"},s.createElement("button",{className:"button-as-link",style:{lineHeight:"32px"},onClick:this.props.handleUnshareFile},I("Unshare file")))),s.createElement("div",{className:"u-mar-top-m clearfix"},e)},t})(s.Component);w.displayName="FileSettingsModalContents",t.FileSettingsModalContents=w}),function(){define("modules/clean/sharing/folder_settings_modal",["external/classnames","external/immutable","external/purify","external/react","external/underscore","modules/clean/api_v2/error","modules/clean/em_string","modules/clean/flux/dispatcher","modules/clean/react/browse/constants","modules/clean/react/browse/store","modules/clean/react/content_manager/api","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/util","modules/clean/sharing/actions/share_modal","modules/clean/sharing/constants","modules/clean/sharing/ui_util","modules/clean/sharing/settings_modal_components","modules/clean/sharing/share_page/action_types","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/confirmation_modals/reset_access_modal","modules/clean/sharing/sharing_settings_constants","modules/clean/sharing/sharing_settings_modal","modules/clean/sharing/sharing_settings_util","modules/clean/user","modules/constants/python","modules/core/i18n","modules/core/uri","modules/core/notify"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,E,w,C,N,T,P,M){var A,k,F,x,L,R,O,D,U,B,q,H,V,G,W,K,Y,z,j,Q,X,J,Z,$,ee,te,ne,se,re,oe,ae,ie,le,de;return se=o.catchApiError,l.BrowseActionTypes,l.SharedWithActionTypes,A=d.BrowseStore,c.shareFolder,B=u.Modal,Q=u.SimpleModal,de=h.setStatePromise,H=_.SNIPPET_SIZES,Z=_.TRUELINK,D=f.GoldenGate,ie=f.genContentManagerBridgeUri,V=g.SettingsModalButtons,X=g.SinglePolicyControl,G=y.SharePageActionTypes,O=b.FolderShareApiClient,b.ShareApiClient,$=b.TeamSharingPolicies,k=v.CombinedPolicy,R=v.FolderPolicy,L=v.FolderPermissions,U=v.LinkMetadata,W=v.SharedContentLinkMetadata,K=v.SharedFolderMetadata,oe=S.confirmResetAccess,I.AUDIENCE_POLICY,I.EXPIRY_POLICY,I.PASSWORD_POLICY,I.FOLDER_SETTINGS,I.LINK_SETTINGS,j=E.SharingSettingsModal,ne=w.canChangePolicy,le=w.isCommonSharingSettingsPolicy,J=N.TRADEMARK_BUSINESS,re=s.createElement,ae=s.DOM,ee=T.i18n_default_project("sharing")._,F={shared_folder_member_policy:"team"},x={shared_folder_member_policy:"team"},q={member_policy:"shared_folder_member_policy"},Y=s.createClass({displayName:"SharedFolderSettingsModal",propTypes:{actionHandler:s.PropTypes.instanceOf(m),altAction:s.PropTypes.node,folderName:s.PropTypes.string.isRequired,folderId:s.PropTypes.string,folderPath:s.PropTypes.string,hasDisplayableMembers:s.PropTypes.bool,hasNonOwnerMembers:s.PropTypes.bool,nsId:s.PropTypes.string,nsPath:s.PropTypes.string,initialHasParentSharedFolder:s.PropTypes.bool,initialIsTeamSharedFolder:s.PropTypes.bool,initialMetadata:s.PropTypes.instanceOf(K),initialOwnerTeam:s.PropTypes.shape({id:s.PropTypes.string.isRequired,name:s.PropTypes.string.isRequired}),
initialPermissions:s.PropTypes.instanceOf(L),initialPolicy:s.PropTypes.oneOfType([s.PropTypes.instanceOf(k),s.PropTypes.instanceOf(R)]),isFolderInsideTeamFolderTree:s.PropTypes.bool,isLimitedTeam:s.PropTypes.bool,isSharedFolder:s.PropTypes.bool,isUserOnOwnerTeam:s.PropTypes.bool,linkMetadata:s.PropTypes.oneOfType([s.PropTypes.instanceOf(U),s.PropTypes.instanceOf(W)]),onCancel:s.PropTypes.func,onPolicySet:s.PropTypes.func,onUnshare:s.PropTypes.func,showContentManagerBridge:s.PropTypes.bool,isInContentManager:s.PropTypes.bool,teamPolicy:s.PropTypes.instanceOf($),updateLinkSettings:s.PropTypes.func,user:s.PropTypes.instanceOf(C).isRequired},getInitialState:function(){return{currentPolicy:this.props.initialPolicy,hasParentSharedFolder:this.props.initialHasParentSharedFolder,isLoading:!(null!=this.props.initialPolicy&&null!=this.props.initialPermissions),isPolicyChangeRecursive:this._hasRecursivePolicyChanges(this.props.initialIsTeamSharedFolder,this.props.initialHasParentSharedFolder),isSubmitting:!1,isTeamSharedFolder:this.props.initialIsTeamSharedFolder,metadata:this.props.initialMetadata,teamPolicy:this.props.teamPolicy,newPolicy:this.props.initialPolicy,ownerTeam:this.props.initialOwnerTeam,permissions:this.props.initialPermissions}},componentDidMount:function(){if(this.state.isLoading)return this._fetchInitialState()},render:function(){var e;return e={altAction:this.props.altAction,contentId:this.props.folderId,currentPolicy:this.state.currentPolicy,folderId:this.props.folderId,folderName:this.props.folderName,folderPath:this.props.folderPath,getEffectivePolicyValue:this._getEffectivePolicyValue,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,hasParentSharedFolder:this.state.hasParentSharedFolder,isFolder:!0,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isInContentManager:this.props.isInContentManager,isLimitedTeam:this.props.isLimitedTeam,isLoading:this.state.isLoading,isSharedFolder:this.props.isSharedFolder,isSubmitting:this.state.isSubmitting,isTeamSharedFolder:this.state.isTeamSharedFolder,isUserOnOwnerTeam:this.props.isUserOnOwnerTeam,linkMetadata:this.props.linkMetadata,onDismiss:this._handleDismiss,onOptionChange:this._handleOptionChange,onSaveSettings:this._handleSaveSettings,onUnshare:this._handleUnshareFolder,ownerTeam:this.state.ownerTeam,permissions:this.state.permissions,showContentManagerBridge:this.props.showContentManagerBridge,shouldHideHeader:this.state.shouldHideHeader,teamPolicy:this.state.teamPolicy,policyUpdate:this._getPolicyUpdate(),user:this.props.user},Z.TRUELINK_UI[this.props.user.id]?re(j,e):re(z,e)},_getClient:function(){var e;return e=A.context().isNonUserRelativeContext,new O({userId:this.props.user.id,isNonUserRelativeContext:e})},_fetchFolderMetadata:function(){var e;return e=[{".tag":"change_options"},{".tag":"unshare"}],null!=this.props.folderId?this._getClient().getMetadata({contentId:this.props.folderId,actions:e}):this._getClient().validateFqPath({fqPath:this.props.folderPath,actions:e}).then(function(e){return e.metadata})},_fetchInitialState:function(){return this._fetchFolderMetadata().then((function(e){return function(t){var n,s,r,o;if(e.isMounted())return n=t.policy,s={hasParentSharedFolder:null!=t.parent_shared_folder_id,isTeamSharedFolder:t.is_team_folder,shouldHideHeader:"folder_is_limited_team_folder"===(null!=(r=t.permissions)&&null!=(o=r.change_options)?o.reason:void 0),isLoading:!1,permissions:t.permissions,newPolicy:n,ownerTeam:t.owner_team,metadata:t},null!=e.props.folderId&&(s.currentPolicy=n),s.isPolicyChangeRecursive=e._hasRecursivePolicyChanges(s.isTeamSharedFolder,s.hasParentSharedFolder),de(e,s)}})(this)).catch(se(function(){return B.close()}))},_hasRecursivePolicyChanges:function(e,t){return D.canDeepNest(this.props.user.id)&&(e||t)},_handlePolicyUpdate:function(e,t){return this.setState({newPolicy:this.state.newPolicy.set(e,t)})},_handleSaveSettings:function(){var e,t,s;if(t=this._getPolicyUpdate(),null!=t)return e=(function(e){return function(){var n;return n=e.props.onPolicySet,(e.isMounted()?de(e,{isSubmitting:!0}):Promise.resolve()).then(function(){var n,s,r;return n=function(e){return M.success(ee("Folder settings updated")),Promise.resolve({policyUpdate:t,sharedFolderMetadata:e})},null!=e.props.folderId?(s=Z.TRUELINK_UI[e.props.user.id]?e._getClient().updatePolicyAlpha:e._getClient().updatePolicy,s({contentId:e.props.folderId,newPolicy:t,url:null!=(r=e.props.linkMetadata)?r.url:void 0}).then(n)):(t=Z.TRUELINK_UI?new k(t):new R(t),e.props.actionHandler.shareIfFileFolder(t).then(n))}).then(function(e){var t,s;return t=e.policyUpdate,s=e.sharedFolderMetadata,"function"==typeof n?n(t,s):void 0}).catch(se(function(){if(e.isMounted())return e.setState({isSubmitting:!1})}))}})(this),this.state.isPolicyChangeRecursive?(s=this.props,Q.show({title_text:ee("Save settings?"),body_html:this.state.isTeamSharedFolder?n.sanitize(ee("Your changes will be applied to this team folder and any folders inside it.")):n.sanitize(ee("Your changes will be applied to this folder and any folders inside it.")),confirm_text:ee("Save settings"),cancel_text:ee("Cancel"),autoclose:!1,confirm_callback:e,cancel_completed_callback:function(){return B.showInstance(re(Y,s))}})):e()},_handleDismiss:function(){var e;return B.close(),"function"==typeof(e=this.props).onCancel?e.onCancel():void 0},_handleDismissCompleted:function(){var e;return"function"==typeof(e=this.props).onCancel?e.onCancel():void 0},_handleUnshareFolder:function(){var e,t,n,s,r,o;if(null!=this.props.folderId&&(null!=(n=this.state.permissions)&&null!=(s=n.unshare)?s.allow:void 0))return e=(function(e){return function(t){var n;return n=e._getClient().unshare({contentId:e.props.folderId,leaveACopy:t}),n.then(function(){return M.success(ee("Unshared “%(folder_name)s”").format({folder_name:e.props.folderName})),B.close(),i.dispatch({type:G.UNSHARE_FOLDER_SUCCESS,metadata:e.state.metadata,user:e.props.user})})}})(this),t=(function(e){return function(){return B.showInstance(re(Y,e))}})(this.props),oe({allowLeaveACopy:null!=(r=this.state.permissions)&&null!=(o=r.leave_a_copy)?o.allow:void 0,contentName:this.state.metadata.name,isFolder:!0,linkAccessLanguage:Z.TRUELINK_UI[this.props.user.id],onCancel:t,onConfirm:e})},_getPolicyUpdate:function(){var e;return null==this.state.newPolicy&&null==this.state.currentPolicy?null:(e={},this.state.newPolicy.forEach((function(t){return function(n,s){var o,a,i,l;if(l=t._getEffectivePolicyValue(s),a=l[0],o=l[1],o&&(i="object"==typeof n?r.isEqual(n,a):n===a,!i))return e[s]=n}})(this)),e)},_handleOptionChange:function(e,t){var n;if((null!=(n=this._getPolicyUpdate())?n[e]:void 0)!==t)return"function"==typeof this._handlePolicyUpdate?this._handlePolicyUpdate(e,t):void 0},_getEffectivePolicyValue:function(e,t){var n,s,r,o,a,i;return null==t&&(t=void 0),a=q[e],null!=a&&null!=this.props.teamPolicy&&(i=this.props.teamPolicy.get(a)),s=null!=(r=null!=t?t[e]:void 0)?r:this.state.currentPolicy.get(e),n=null!=(o=this.state.permissions.change_options)?o.allow:void 0,null!=i&&F[a]===i&&(n=!1,s=x[a]),le(e)&&(n=ne(e,this.state.currentPolicy,this.state.newPolicy,this.props.linkMetadata,this.state.permissions,this.props.showContentManagerBridge)),this.props.showContentManagerBridge&&(n=!1),[s,n]}}),te=s.createClass({displayName:"SharedFolderSettingsModalContents",propTypes:{altAction:s.PropTypes.node,currentPolicy:s.PropTypes.instanceOf(R),folderId:s.PropTypes.string,folderName:s.PropTypes.string.isRequired,folderPath:s.PropTypes.string,permissions:s.PropTypes.instanceOf(L),getEffectivePolicyValue:s.PropTypes.func,hasParentSharedFolder:s.PropTypes.bool,isLimitedTeam:s.PropTypes.bool,isLoading:s.PropTypes.bool.isRequired,isSharedFolder:s.PropTypes.bool,isSubmitting:s.PropTypes.bool,isTeamSharedFolder:s.PropTypes.bool,isUserOnOwnerTeam:s.PropTypes.bool,onDismiss:s.PropTypes.func,onSaveSettings:s.PropTypes.func,onOptionChange:s.PropTypes.func,onUnshare:s.PropTypes.func,ownerTeam:s.PropTypes.shape({id:s.PropTypes.string.isRequired,name:s.PropTypes.string.isRequired}),showContentManagerBridge:s.PropTypes.bool,shouldHideHeader:s.PropTypes.bool,teamPolicy:s.PropTypes.instanceOf($),policyUpdate:s.PropTypes.instanceOf(R)},getDefaultProps:function(){return{currentPolicy:null,folderId:null,getEffectivePolicyValue:null,hasParentSharedFolder:!1,isTeamSharedFolder:!1,onDismiss:null,onOptionChange:null,onSaveSettings:null,onUnshareFolder:null,ownerTeam:null,shouldHideHeader:!1,teamPolicy:null,policyUpdate:null}},render:function(){var t,n;return re(B,{altAction:this.props.altAction,autoClose:!1,className:e({"shared-folder-settings-modal":!0,"shared-folder-settings-modal--no-permissions":!(null!=(t=this.props.permissions)&&null!=(n=t.change_options)?n.allow:void 0)}),buttonComponent:ae.span(),onDismissCompleted:this.props.onDismiss,title:this.props.isTeamSharedFolder?ee("“%(folder_name)s” team folder settings").format({folder_name:a.em_snippet(this.props.folderName,H.FILENAME)}):ee("“%(folder_name)s” settings").format({folder_name:a.em_snippet(this.props.folderName,H.FILENAME)})},this.props.isLoading?ae.div({className:"shared-folder-settings-modal__loading-text"},ee("Loading...")):ae.div({},this._renderHeader(),this._renderPolicies(),this._renderButtons()))},_renderHeader:function(){var t,n,s,o,a;if(!this.props.shouldHideHeader)return t={"shared-folder-settings-form__team-folder-banner":!0,"u-pad-xs":!0,"u-font-center":!0,"u-mar-bottom-s":!0},o=ae.div({},ee("These settings will apply to all folders inside “%(folder_name)s”.").format({folder_name:this.props.folderName})),this.props.isInContentManager?ae.div({className:e(t)},o):this.props.showContentManagerBridge?(a=ie(this.props.isLimitedTeam,this.props.folderPath),ae.div({className:e(t)},o,ae.div({},ee("You can change these settings in the Admin Console. "),ae.a({href:a.toString(),target:"_blank"},ee("Open in new tab."))))):(this.props.isTeamSharedFolder||this.props.hasParentSharedFolder)&&this.props.isUserOnOwnerTeam?ae.div({className:e(t)},o,ae.div({},ae.a({href:"/team",target:"_blank"},ee("To edit, ask your admin.")))):(null!=(n=this.props.permissions)&&null!=(s=n.change_options)?s.allow:void 0)?void 0:ae.div({className:e(r.extend(t,{"shared-folder-settings-form__team-folder-banner":!1,"shared-folder-settings-form__no-permissions-banner":!0}))},ee("You don’t have permission to change the settings on this folder."))},_renderPolicies:function(){var e,t,n;return t=null!=this.props.ownerTeam,n=null!=this.props.ownerTeam&&!this.props.isLimitedTeam,e=this.props.isTeamSharedFolder||this.props.isFolderInsideTeamFolderTree,ae.div({},t?this._renderPolicy("member_policy",ee(e?"Who can be added to folders?":"Who can be invited to this folder?"),[{label:this.props.isLimitedTeam?ee("Only people on your team"):ee("Only people on your %(trademark_business)s account").format({trademark_business:J}),value:"team"},{label:ee("Anyone"),value:"anyone"}]):void 0,this._renderPolicy("acl_update_policy",ee(e?"Who can manage access to folders?":"Who can manage access to this folder?"),[{label:ee(e?"Only Team Admins":"Only owners"),value:"owner"},{label:t?this.props.isLimitedTeam?ee("Anyone on your team with edit permissions"):ee("Anyone on your %(trademark_business)s account with edit permissions").format({trademark_business:J}):ee("People with edit permissions"),value:"editors"}]),n?this._renderPolicy("shared_link_policy",ee(this.props.isTeamSharedFolder?"Allow members of this team folder to share links with others?":"Allow links to be shared with people outside of this folder?"),[{label:ee("No"),value:"members"},{label:ee("Yes"),value:"anyone"}]):void 0)},_renderPolicy:function(e,t,n){var s,r,o;return o=this.props.getEffectivePolicyValue(e,this.props.policyUpdate),r=o[0],s=o[1],re(X,{canChange:s,policyName:e,policyDescription:t,currentValue:r,options:n,handleOptionChange:this.props.onOptionChange})},_renderButtons:function(){var e,t,n;return e=null!=(t=this.props.permissions)&&null!=(n=t.unshare)?n.allow:void 0,ae.div({className:"u-mar-top-m clearfix"},this.props.isSharedFolder&&e?ae.div({className:"u-l-fl"},ae.button({className:"button-as-link",style:{lineHeight:"32px"},onClick:this.props.onUnshare},ee(this.props.hasParentSharedFolder?"Reset membership":"Unshare folder"))):void 0,this._renderUpdateSettingsButtons())},_renderUpdateSettingsButtons:function(){var e;if(null!=(e=this.props.permissions)?e.change_options.allow:void 0)return re(V,{disableSave:null==this.props.policyUpdate,isAccepting:this.props.isSubmitting,onAccept:this.props.onSaveSettings,onDismiss:this.props.onDismiss})}}),z=p(te,["/static/css/sharing/share_modal-vflqkhEAI.css"],[X]),{SharedFolderSettingsModal:Y,SharedFolderSettingsModalContents:z}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/sharing/link_settings_modal",["external/classnames","external/immutable","external/react","external/underscore","modules/clean/api_v2/types","modules/clean/datetime","modules/clean/em_string","modules/clean/filepath","modules/clean/react/bubble_menu","modules/clean/react/calendar","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/sharing/api/client","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/delete_link_modal","modules/clean/sharing/link_description","modules/clean/static_urls","modules/clean/user","modules/clean/previews/util","modules/constants/python","modules/core/i18n","modules/core/notify"],function(t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,E,w){var C,N,T,P,M,A,k,F,x,L,R,O,D,U,B,q,H,V,G,W,K,Y,z,j,Q,X,J;return z=o.formatTimestamp,V=a.daysAfterToday,j=a.format_date,Q=a.localized_date_format,W=l.file_extension,C=d.BubbleMenu,N=d.BubbleMenuItem,T=c.Calendar,A=u.Modal,x=m.ShareApiClient,P=_.LinkMetadata,M=_.LinkPolicy,k=_.RequestedVisibilityPolicy,F=_.ResolvedVisibilityPolicy,D=_.VisibilityDisallowedReason,G=g.deleteLinkWithConfirm,K=y.formatLinkCommentingVisibility,Y=y.formatLinkVisibilityOption,J=b.static_url,R=I.TRADEMARK_BUSINESS,O=I.TRADEMARK_PLUS,q=s.createElement,H=s.DOM,U=E.i18n_default_project("sharing")._,B=s.createClass({displayName:"SharedLinkSettingsModal",propTypes:{client:s.PropTypes.instanceOf(x).isRequired,isFile:s.PropTypes.bool.isRequired,linkMetadata:s.PropTypes.instanceOf(P).isRequired,onClose:s.PropTypes.func,onDeleteLink:s.PropTypes.func,onPolicySet:s.PropTypes.func,showUpgradeToBiz:s.PropTypes.bool.isRequired,isTeam:s.PropTypes.bool},getInitialState:function(){var e,t,n;return t=this.props.linkMetadata.link_permissions.requested_visibility,n=this.props.linkMetadata.link_permissions.resolved_visibility,t===k.public&&n===F.team_only&&(t=k.team_only),e=M({requested_visibility:t,link_password:t===k.password?null:"",expires:this.props.linkMetadata.expires,allow_download:this.props.linkMetadata.link_permissions.allow_download}),{existingPolicy:e,isSubmitting:!1,newPolicy:e}},render:function(){var e,t;return e=this.props.linkMetadata.link_permissions.visibility_policies.filter(function(e){return e.disallowed_reason===D.user_account_type}),t=e.length>0,q(A,{autoClose:!1,className:"shared-link-settings-modal",buttonComponent:H.span(),onDismissCompleted:this._handleDismissed,title:U("Link permissions for “%(content_name)s”").format({content_name:this.props.linkMetadata.name})},q(L,{canSubmit:!this.state.existingPolicy.equals(this.state.newPolicy),isFile:this.props.isFile,isSubmitting:this.state.isSubmitting,linkMetadata:this.props.linkMetadata,onCancel:this._dismissModal,onSubmit:this._saveSettings,onPolicyUpdate:this._handlePolicyUpdate,onDeleteLink:this._deleteLink,renderedPolicy:this.state.newPolicy,showUpgradeToBiz:this.props.showUpgradeToBiz,showUpgradeMessage:t,isTeam:this.props.isTeam}))},_handlePolicyUpdate:function(e,t){return"expires"===e&&null!=t&&(t.setHours(23),t.setMinutes(59),t.setSeconds(59)),this.setState({newPolicy:this.state.newPolicy.set(e,t)})},_getModifiedSettings:function(){var e,t;if(t=this.state.newPolicy,t.requested_visibility===k.password){if(null==t.link_password)t=t.set("requested_visibility",null);else if(""===t.link_password)return w.error(U("Password can’t be empty")),null}else t=t.set("link_password",null);return e=this.props.linkMetadata.link_permissions.resolved_visibility,e===F.shared_folder_only&&(t=t.set("requested_visibility",null)),null!=t.expires&&(t=this.props.linkMetadata.link_permissions.can_set_expiry?t.set("expires",z(t.expires)):t.set("expires",null)),t.allow_download===this.state.existingPolicy.allow_download&&(t=t.set("allow_download",void 0)),{url:this.props.linkMetadata.url,settings:t,remove_expiration:null!=this.props.linkMetadata.expires&&null==this.state.newPolicy.expires}},_saveSettings:function(){var e;if(e=this._getModifiedSettings(),null!=e)return this.setState({isSubmitting:!0}),this.props.client.modifySharedLinkSettings(e).catch((function(e){return function(){return e.setState({isSubmitting:!1}),Promise.reject()}})(this)).then((function(e){return function(t){var n;return w.success(U("Settings saved.")),"function"==typeof(n=e.props).onPolicySet&&n.onPolicySet(t),e._dismissModal()}})(this))},_dismissModal:function(){return A.close(),this._handleDismissed()},_handleDismissed:function(){var e;return"function"==typeof(e=this.props).onClose?e.onClose():void 0},_deleteLink:function(){var e,t;return t=(function(e){return function(){var t;return"function"==typeof(t=e.props).onDeleteLink?t.onDeleteLink():void 0}})(this),e=(function(e){return function(){return A.showInstance(q(B,e))}})(this.props),G({client:this.props.client,contentName:this.props.linkMetadata.name,onCancel:e,onDeleteLink:t,url:this.props.linkMetadata.url})}}),L=s.createClass({displayName:"SharedLinkSettingsModalContents",propTypes:{canSubmit:s.PropTypes.bool.isRequired,isFile:s.PropTypes.bool.isRequired,isSubmitting:s.PropTypes.bool.isRequired,linkMetadata:s.PropTypes.instanceOf(P).isRequired,onCancel:s.PropTypes.func,onSubmit:s.PropTypes.func,onPolicyUpdate:s.PropTypes.func,onDeleteLink:s.PropTypes.func,renderedPolicy:s.PropTypes.instanceOf(M).isRequired,showUpgradeToBiz:s.PropTypes.bool.isRequired,showUpgradeMessage:s.PropTypes.bool.isRequired,isTeam:s.PropTypes.bool},getInitialState:function(){return{selectedExpiry:null!=this.props.renderedPolicy.expires?this.props.linkMetadata.link_permissions.can_set_expiry?"custom":"read-only":"no-expiry"}},render:function(){return H.div({className:"shared-link-settings-modal__contents"},this._renderHeader(),this._renderPolicies(),this._renderButtons())},_renderHeader:function(){var e,t;return this.props.showUpgradeToBiz?H.div({className:"shared-link-settings-modal__upgrade-to-biz-banner"},H.div({className:"shared-link-settings-modal__upgrade-to-biz-banner-text"},U("Did you know %(trademark_business)s lets you add passwords and expiration dates to shared links?").format({trademark_business:R})),H.div({className:"shared-link-settings-modal__upgrade-to-biz-banner-cta"},H.a({className:"c-btn c-btn--secondary shared-link-settings-modal__upgrade-to-biz-banner-cta-button",href:"/business?tk=teams&camp=sharing_link_modal",target:"_blank"},U("Learn More")))):this.props.showUpgradeMessage?(this.props.isTeam?(e="/team/upgrade",t=U("Upgrade to %(trademark_business)s to enable permission settings").format({trademark_business:R})):(e="/upgrade?oqa=sfp",t=U("Upgrade to Dropbox %(trademark_plus)s to enable permission settings.").format({trademark_plus:O})),H.div({className:"shared-link-settings-modal__upgrade-to-pro-banner"},H.a({href:e,target:"_blank"},t))):void 0},_renderPolicies:function(){return H.div({},this._renderVisibilityPolicies(),this._renderExpiryPolicy(),this._renderDownloadPolicy(),this._renderCommentsPolicy())},_renderVisibilityPolicies:function(){var e,t;return t=this.props.linkMetadata.link_permissions.visibility_policies.filter(function(e){return e.allowed||e.disallowed_reason===D.user_account_type}),e=this.props.linkMetadata.link_permissions.visibility_policies[0].disallowed_reason,this._renderFieldset(U("Who can view this link?"),e===D.permission_denied&&0===t.length?this._renderNonPermissionVisibility():t.length<2?this._renderRestrictedBySharedFolderVisibility():t.map(this._renderVisibilityOption))},_renderNonPermissionVisibility:function(){var e;return e=this.props.linkMetadata.link_permissions.resolved_visibility,H.span({},H.span({className:"shared-link-settings-modal__visibility-text"},e===F.shared_folder_only?U("Only invited members can view this link."):Y(e))," ",H.span({className:"shared-link-settings-modal__visibility-advice u-font-meta"},U("You don’t have permission to change the visibility.")))},_renderRestrictedBySharedFolderVisibility:function(){var e,t,n;return t=this.props.linkMetadata.link_permissions.resolved_visibility,e=this.props.linkMetadata.link_permissions.visibility_policies[0].disallowed_reason,H.span({},H.span({className:"shared-link-settings-modal__visibility-text"},function(){if(t===F.shared_folder_only)return n=this.props.linkMetadata.link_permissions.restricting_shared_folder_path,n=i.em_snippet(n,f.SNIPPET_SIZES.FILENAME),U("Only members of the shared folder “%(shared_folder_name)s” can view this link.").format({shared_folder_name:n});if(t===F.only_you)return U("Only you can view this link.");throw"Unexpected visibility "+t}.call(this))," ",H.span({className:"shared-link-settings-modal__visibility-advice u-font-meta"},(function(){if(e===D.restricted_by_shared_folder)return U("To change who can access the link, go to the shared folder options.");if(e===D.delete_and_recreate)return U("To change who can access the link, delete this link and create a new one.");throw"Unexpected disallowed reason "+e})()))},_renderVisibilityOption:function(e){var n,s;return n=e.disallowed_reason===D.user_account_type,[H.label({className:t({"u-font-meta":!e.allowed}),key:"visibility-label"},H.input({checked:e.policy===this.props.renderedPolicy.requested_visibility,className:t((s={"shared-link-settings-modal__audience":!0},s["shared-link-settings-modal__audience-"+e.policy]=!0,s)),disabled:n,name:k.policy_name,onChange:(function(e){return function(t){return e.props.onPolicyUpdate(t.target.name,t.target.value)}})(this),type:"radio",value:e.policy}),this._renderVisibilityLabelText(e)),e.policy===k.password&&this.props.renderedPolicy.requested_visibility===k.password?H.div({key:"password-input"},this._renderPasswordInput(n)):void 0]},_renderVisibilityLabelText:function(e){var n;return H.span({className:t((n={"shared-link-settings-modal__audience":!0},n["shared-link-settings-modal__audience-"+e.policy+"-label"]=!0,n))},Y(e.resolved_policy))},_renderPasswordInput:function(e){var t,n;return n=null==this.props.renderedPolicy.link_password,H.div({className:"shared-link-settings-modal__password-container u-mar-left-m u-mar-right-xl u-mar-top-xs"},H.input({className:"shared-link-settings-modal__password-input c-input",disabled:e||n,name:"link_password",onChange:(function(e){return function(t){return e.props.onPolicyUpdate(t.target.name,t.target.value)}})(this),placeholder:U("Set password"),value:null!=(t=this.props.renderedPolicy.link_password)?t:"123456",type:"password"}),n&&!e?H.button({className:"shared-link-settings-modal__password-change button-as-link",onClick:(function(e){return function(){return e.props.onPolicyUpdate("link_password","")}})(this)},U("Change",{comment:"A link to change the password for the shared link"})):void 0)},_renderExpiryPolicy:function(){return this._renderFieldset(U("Add an expiry date to this link?"),H.div({},H.label({className:t({"shared-link-settings-modal__expiry-label-yes":!0,"u-font-meta":!this.props.linkMetadata.link_permissions.can_set_expiry})},H.input({checked:"no-expiry"!==this.state.selectedExpiry,className:"shared-link-settings-modal__expiry-option-yes",disabled:!this.props.linkMetadata.link_permissions.can_set_expiry,onChange:(function(e){return function(){if("no-expiry"===e.state.selectedExpiry)return e._handleExpirySelectChange(30)}})(this),type:"radio"}),this._renderYesExpiryText()),"custom"===this.state.selectedExpiry?this._renderExpiryCustom():void 0,H.label({className:t({"u-font-meta":!this.props.linkMetadata.link_permissions.can_remove_expiry})},H.input({checked:null==this.props.renderedPolicy.expires,className:"shared-link-settings-modal__expiry-option-no",disabled:!this.props.linkMetadata.link_permissions.can_remove_expiry,onChange:(function(e){return function(){var t;return"function"==typeof(t=e.props).onPolicyUpdate&&t.onPolicyUpdate("expires",null),e.setState({selectedExpiry:"no-expiry"})}})(this),type:"radio"}),U("No"))))},_renderYesExpiryText:function(){var e,t;if(7===(e=this.state.selectedExpiry)||30===e)return H.span({className:"shared-link-settings-modal__expiry-text-yes"},U("Yes, expires in",{comment:'Label followed by a date range e.g. "Yes, expires in 7 days"'})," ",this._renderExpirySelect());if("custom"===(t=this.state.selectedExpiry)||"read-only"===t)return H.span({className:"shared-link-settings-modal__expiry-text-yes"},U("Yes, expires on",{comment:'Label followed by a date. e.g. "Yes, expires on 5/10/2017"'})," ","read-only"===this.state.selectedExpiry?j(this.props.linkMetadata.expires,Q):void 0);if("no-expiry"===this.state.selectedExpiry)return H.span({className:"shared-link-settings-modal__expiry-text-yes"},U("Yes"));throw"Expiry policy is in an unknown state"},_renderExpirySelect:function(){var e;return q(C,{position:C.POSITIONS.BOTTOM,targetFixed:!0,items:function(){var t,n,s,r;for(s=[7,30,"custom"],r=[],t=0,n=s.length;t<n;t++)e=s[t],r.push(q(N,{onClick:(function(e){return function(t){return function(){return e._handleExpirySelectChange(t)}}})(this)(e)},this._renderExpirySelectLabel(e)));return r}.call(this),targetButton:H.button({className:"shared-link-settings-modal__selected-expiry button-as-link"},this._renderExpirySelectLabel(this.state.selectedExpiry)," ",H.img({alt:"",className:"sprite sprite_web s_web_arrow-down-gray",src:J("/static/images/icons/icon_spacer-vflN3BYt2.gif")}))})},_renderExpirySelectLabel:function(e){if(7===e)return U("7 days",{comment:'as in "This link expires in 7 days"'});if(30===e)return U("30 days",{comment:'as in "This link expires in 30 days"'});if("custom"===e)return U("Custom date...",{comment:"Dropdown option for expiry date on a link. The user can choose 7 days, 30 days, or a custom expiry"});throw"Unknown selected expiry"},_handleExpirySelectChange:function(e){var t;return this.setState({selectedExpiry:e}),"custom"===e&&(e=30),"function"==typeof(t=this.props).onPolicyUpdate?t.onPolicyUpdate("expires",V(e)):void 0},_renderExpiryCustom:function(){var e;return H.span({className:"shared-link-settings-modal__calendar-input"},q(T,{alignAtLeft:!1,onDateChange:(function(e){return function(t){var n;return"function"==typeof(n=e.props).onPolicyUpdate?n.onPolicyUpdate("expires",t):void 0}})(this),initDate:null!=(e=this.props.linkMetadata.expires)?e:V(30),firstDay:V(1),lastDay:V(365)}))},_renderDownloadPolicy:function(){var e,n,s;if(s=this.props.linkMetadata.link_permissions.can_disallow_download,n=this.props.linkMetadata.link_permissions.can_allow_download,e=this.props.linkMetadata.link_permissions.allow_download,null!=s&&null!=n&&null!=e&&(s!==!1||e!==!0))return this._renderFieldset(U("Allow people to download this?"),H.div({},H.label({className:t({"u-font-meta":!n})},H.input({checked:this.props.renderedPolicy.allow_download,className:"shared-link-settings-modal__allow-download-yes",disabled:!n,onChange:(function(e){return function(){var t;return"function"==typeof(t=e.props).onPolicyUpdate?t.onPolicyUpdate("allow_download",!0):void 0}})(this),type:"radio"}),U("Yes")),H.label({className:t({"u-font-meta":!s})},H.input({checked:!this.props.renderedPolicy.allow_download,className:"shared-link-settings-modal__allow-download-no",disabled:!s,onChange:(function(e){return function(){var t;return"function"==typeof(t=e.props).onPolicyUpdate?t.onPolicyUpdate("allow_download",!1):void 0}})(this),type:"radio"}),U("No"))),this._renderNoPreviewFileWarning())},_renderNoPreviewFileWarning:function(){var t,n,s,r;if(this.props.isFile&&(t=W(this.props.linkMetadata.name),n=t.toUpperCase(),!(null!=(null!=(r=this.props.linkMetadata)?r.preview_type:void 0)&&(s=this.props.linkMetadata.preview_type,e.call(S.VALID_PREVIEW_TYPES,s)>=0))))return this.props.renderedPolicy.allow_download===!1?H.div({className:"shared-link-settings-modal__preview-warning c-banner c-banner--warning"},H.div({className:"o-flag"},H.div({className:"o-flag-fix"},q(h,{alt:"",group:"web",name:"page_white_32"})),H.div({className:"o-flag__flex u-pad-left-xs"},U("People can’t view this %(file_extension)s file if they can’t download it.",{comment:'as in "People can’t view this .PDF file'}).format({file_extension:"."+n})))):void 0},_renderCommentsPolicy:function(){if(!this.props.linkMetadata.link_permissions.team_restricts_comments)return this._renderFieldset(U("Who can comment?"),H.div({},H.div({className:"shared-link-settings-modal__commenting-policy"},K(this.props.linkMetadata.link_permissions.allow_comments,this._getResolvedVisibility(this.props.renderedPolicy.requested_visibility),this.props.linkMetadata.link_permissions.restricting_shared_folder_path)),H.div({className:"shared-link-settings-modal__commenting-advice"},this.props.linkMetadata.link_permissions.allow_comments?H.a({href:"/help/9016#comments",target:"_blank"},U("Learn how to disable comments")):H.a({href:"/help/9016#comments",target:"_blank"},U("Learn how to enable comments")))))},_getResolvedVisibility:function(e){var t;if(t=this.props.linkMetadata.link_permissions.visibility_policies.filter(function(t){return t.policy===e}),1!==t.length)throw"Logic error: "+t.length+" should be 1.";return t[0].resolved_policy},_renderFieldset:function(e,t,n){return null==n&&(n=null),H.fieldset({className:"settings-form-entry"},H.legend({className:"settings-form-entry__explanation u-trim-margin"},e),H.div({className:"settings-form-entry__options"},t),H.div({className:"u-mar-top-m"},n))},_renderButtons:function(){return H.div({className:"u-mar-top-m clearfix"},this.props.linkMetadata.link_permissions.can_revoke?H.div({className:"u-l-fl"},H.button({className:"button-as-link delete-link",onClick:this.props.onDeleteLink,style:{lineHeight:"32px"},type:"button"},U("Delete link"))):void 0,H.div({className:"u-l-fr"},H.button({className:"c-btn c-btn--primary confirm-button",disabled:this.props.isSubmitting||!this.props.canSubmit,onClick:this.props.onSubmit},U(this.props.isSubmitting?"Saving...":"Save settings")),H.button({className:"c-btn c-btn--secondary u-mar-left-xs cancel-button",onClick:this.props.onCancel},U("Cancel"))))}}),X=function(e){return f.SHARING_EXPERIMENTS.SHOW_UPGRADE_TO_BIZ_BANNER[e]},{SharedLinkSettingsModal:p(B,["/static/css/sharing/share_modal-vflqkhEAI.css"]),SharedLinkSettingsModalContents:L,showUpgradeToBizBanner:X}})}.call(this),function(){define("modules/clean/sharing/parent_folder_access_modal",["external/classnames","external/react","modules/clean/em_string","modules/clean/react/flag","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/content_info","modules/core/i18n"],function(e,t,n,s,r,o,a,i,l,d){var c,p,u,h,m,_,f,g,y,b,v;return h=r.Modal,u=a.MemberAccessLevelResult,c=i.ACCESS_LEVEL,_=i.SNIPPET_SIZES,p=l.ContentInfo,g=t.createElement,y=t.DOM,b=d.i18n_default_project("sharing"),f=b._,v=b.ungettext,m=t.createClass({displayName:"ParentFolderAccessModal",propTypes:{contentInfo:t.PropTypes.instanceOf(p).isRequired,memberAccessLevelResult:t.PropTypes.instanceOf(u).isRequired,memberDisplayName:t.PropTypes.string.isRequired,originalAction:t.PropTypes.oneOf(["remove","update"]).isRequired,isInContentManager:t.PropTypes.bool,onClose:t.PropTypes.func,onParentFolderClicked:t.PropTypes.func},_dismissModal:function(){return h.close(),this._handleDismissed()},
_handleDismissed:function(){var e;return"function"==typeof(e=this.props).onClose?e.onClose():void 0},_handleNavigateToParentFolder:function(e){var t;return h.close(),"function"==typeof(t=this.props).onParentFolderClicked?t.onParentFolderClicked(e.path,this._arePermissionsAllowed(e.permissions)):void 0},_arePermissionsAllowed:function(e){return e.some(function(e){return null!=e?e.allow:void 0})},_memberCanEdit:function(){var e;return(e=this.props.memberAccessLevelResult.access_level)===c.OWNER||e===c.WRITER},_renderParentFolderContent:function(){var e;return e="remove"===this.props.originalAction?this.props.contentInfo.isFolder()?v("As a member of the parent folder listed below, %(member_name)s can still access the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still access the contents of “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):v("As a member of the parent folder listed below, %(member_name)s can still access “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still access “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):"update"===this.props.originalAction?this.props.contentInfo.isFolder()?this._memberCanEdit()?v("As a member of the parent folder listed below, %(member_name)s can still edit the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still edit the contents of “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):v("As a member of the parent folder listed below, %(member_name)s can still view the contents of “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still view the contents of “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):this._memberCanEdit()?v("As a member of the parent folder listed below, %(member_name)s can still edit “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still edit “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):v("As a member of the parent folder listed below, %(member_name)s can still view “%(content_name)s”.","As a member of the parent folders listed below, %(member_name)s can still view “%(content_name)s”.",this.props.memberAccessLevelResult.parentFolders.length):void 0,y.div({},e.format({member_name:n.em_snippet(this.props.memberDisplayName,_.DISPLAY_NAME),content_name:n.em_snippet(this.props.contentInfo.name(),_.FILENAME)}),y.div({className:"parent-folder-access-modal__folder-list u-mar-top-s"},y.ul({className:"o-list-ui o-list-ui--dividers"},this.props.memberAccessLevelResult.parentFolders.map(this._renderParentFolder))))},_renderParentFolder:function(e){var t;return t=g(o,{group:"web",name:"folder_user_32",className:"u-pad-right-xs",alt:""}),y.li({},y.div({className:"parent-folder-access-modal__parent-folder u-pad-vertical-xs u-pad-horizontal-s",onClick:this._handleNavigateToParentFolder.bind(null,e)},g(s.Flag,{leftAttachment:t,rightAttachment:this._renderFolderLink(e)},y.span({className:"parent-folder-access-modal__folder-name"},n.em_snippet(e.name,_.FILENAME)))))},_renderFolderLink:function(e){return y.button({className:"button-as-link",onClick:this._handleNavigateToParentFolder.bind(null,e),type:"button"},f(this._arePermissionsAllowed(e.permissions)?"Manage membership":"View folder"))},_renderSimpleContent:function(){return y.div({},y.span({className:"parent-folder-access-modal__warning"},this.props.memberAccessLevelResult.warning),y.div({className:"u-mar-top-m clearfix"},y.div({className:"u-l-fr"},y.button({className:"c-btn c-btn--primary confirm-button",onClick:this._dismissModal},f("OK")))))},render:function(){var e;return e="remove"===this.props.originalAction?f(this.props.contentInfo.isFolder()?"%(member_name)s can still access this folder":"%(member_name)s can still access this file"):"update"===this.props.originalAction?f(this.props.contentInfo.isFolder()?this._memberCanEdit()?"%(member_name)s can still edit this folder":"%(member_name)s can still view this folder":this._memberCanEdit()?"%(member_name)s can still edit this file":"%(member_name)s can still view this file"):void 0,g(h,{autoClose:!1,className:"parent-folder-access-modal",buttonComponent:y.span(),onDismissCompleted:this._handleDismissed,title:e.format({member_name:n.em_snippet(this.props.memberDisplayName,_.DISPLAY_NAME)})},y.div({className:"parent-folder-access-modal__contents"},null==this.props.memberAccessLevelResult.parentFolders||this.props.isInContentManager?this._renderSimpleContent():this._renderParentFolderContent()))}}),{ParentFolderAccessModal:m}})}.call(this),function(){var e=function(e,n){function s(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return s.prototype=n.prototype,e.prototype=new s,e.__super__=n.prototype,e},t={}.hasOwnProperty;define("modules/clean/sharing/role_selector_modal",["jquery","modules/clean/dbmodal","modules/clean/multiaccount_login","modules/clean/viewer"],function(t,n,s,r){var o;return o=n.DBModal,(function(n){function o(e){this.onSelectRole=e,o.__super__.constructor.call(this,{element_id:"select-role-modal-sync"})}return e(o,n),o.prototype.on_show=function(){return t(".role-options li").click((function(e){return function(n){var o;return o=t(n.target).closest("li").data("role"),e.hide(),r.get_viewer().is_role_signed_in(o)?e.onSelectRole(o):s.show_modal({role:o,on_success:function(){return e.onSelectRole(o)}})}})(this))},o})(o)})}.call(this),function(){define("modules/clean/sharing/set_confidential_modal",["external/react","modules/clean/em_string","modules/clean/filepath","modules/clean/react/modal","modules/clean/sharing/api/client","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,s,r,o,a){var i,l,d,c,p,u,h,m;return h=n.filename,m=n.parent_dir,i=s.Modal,l=o.SNIPPET_SIZES,p=e.createElement,u=e.DOM,c=a.i18n_default_project("sharing")._,d=e.createClass({displayName:"SetConfidentialModal",propTypes:{client:e.PropTypes.instanceOf(r).isRequired,folderId:e.PropTypes.string.isRequired,folderName:e.PropTypes.string.isRequired,folderPath:e.PropTypes.string.isRequired,initialIsConfidentialFolder:e.PropTypes.bool.isRequired,onCancel:e.PropTypes.func,onUpdateConfidentiality:e.PropTypes.func},getInitialState:function(){return{isAccepting:!1,setConfidential:this.props.initialIsConfidentialFolder}},render:function(){return p(i,{autoClose:!1,buttonComponent:u.span(),onDismissCompleted:this._handleDismiss,title:c("“%(folder_name)s” access").format({folder_name:t.em_snippet(this.props.folderName,l.FILENAME)})},this._renderContent(),this._renderButtons())},_renderContent:function(){var e;return e=t.em_snippet(h(m(this.props.folderPath)),l.FILENAME),u.div({className:"set-confidential-content"},u.div({className:"set-confidential-content__info"},c("Should members of the parent folder “%(parent_folder)s” automatically get access to the folder “%(folder_name)s”?").format({folder_name:t.em_snippet(this.props.folderName,l.FILENAME),parent_folder:e})),u.div({className:"set-confidential-content__options u-pad-top-s"},u.label({className:"u-l-b",key:"inherit"},u.input({checked:!this.state.setConfidential,name:"inherit",onChange:this._handleSetConfidentialValueUpdate,type:"radio",value:!1}),c("Yes, allow members of “%(parent_folder)s” to access").format({parent_folder:e})),u.label({className:"u-l-b",key:"confidential"},u.input({checked:this.state.setConfidential,name:"confidential",onChange:this._handleSetConfidentialValueUpdate,type:"radio",value:!0}),c("No, make this folder invite only"))))},_renderButtons:function(){return u.div({className:"u-l-fr"},u.button({className:"c-btn c-btn--primary",disabled:this.state.isAccepting||this.state.setConfidential===this.props.initialIsConfidentialFolder,onClick:this._handleAcceptClick},c(this.props.isAccepting?"Saving...":"Save")),u.button({className:"c-btn c-btn--secondary u-mar-left-xs",onClick:this._handleDismiss},c("Cancel")))},_handleSetConfidentialValueUpdate:function(e){return this.setState({setConfidential:"true"===e.target.value})},_handleAcceptClick:function(){return this.setState({isAccepting:!0}),this.props.folderId?this.props.client.setConfidentiality({contentId:this.props.folderId,confidential:this.state.setConfidential}).then((function(e){return function(t){var n;return"function"==typeof(n=e.props).onUpdateConfidentiality?n.onUpdateConfidentiality(t):void 0}})(this)):this.props.client.shareInternal({fqPath:this.props.folderPath,confidential:this.state.setConfidential}).then((function(e){return function(t){var n;return"function"==typeof(n=e.props).onUpdateConfidentiality?n.onUpdateConfidentiality(t):void 0}})(this))},_handleDismiss:function(){var e;return"function"==typeof(e=this.props).onCancel?e.onCancel():void 0}}),{SetConfidentialModal:d}})}.call(this),function(){define("modules/clean/sharing/settings_modal_components",["external/classnames","external/react","modules/clean/react/css","modules/core/i18n"],function(e,t,n,s){var r,o,a,i,l;return l=t.DOM,a=s.i18n_default_project("sharing")._,r=t.createClass({displayName:"SettingsModalButtons",propTypes:{disableSave:t.PropTypes.bool,isAccepting:t.PropTypes.bool,onAccept:t.PropTypes.func,onDismiss:t.PropTypes.func},render:function(){return l.div({className:"u-l-fr"},l.button({className:"confirm-button c-btn c-btn--primary",disabled:this.props.disableSave||this.props.isAccepting,onClick:this.props.onAccept},a(this.props.isAccepting?"Saving...":"Save")),l.button({className:"cancel-button c-btn c-btn--secondary u-mar-left-xs",onClick:this.props.onDismiss},a("Cancel")))}}),i=t.createClass({displayName:"SinglePolicyControl",propTypes:{canChange:t.PropTypes.bool,currentValue:t.PropTypes.string,handleOptionChange:t.PropTypes.func,options:t.PropTypes.array,policyDescription:t.PropTypes.string,policyName:t.PropTypes.string},getDefaultProps:function(){return{canChange:!0}},render:function(){var t;return l.fieldset({className:e({"settings-form-entry":!0,"settings-form-entry--no-permissions":!this.props.canChange})},l.legend({className:"settings-form-entry__explanation u-trim-margin"},this.props.policyDescription),l.div({className:"settings-form-entry__options"},function(){var e,n,s,r;for(s=this.props.options,r=[],e=0,n=s.length;e<n;e++)t=s[e],r.push(l.label({key:t.value},l.input({checked:t.value===this.props.currentValue,className:"settings-form-entry-option-"+this.props.policyName+"__"+t.value,disabled:!this.props.canChange,name:this.props.policyName,onChange:(function(e){return function(t){var n;return"function"==typeof(n=e.props).handleOptionChange?n.handleOptionChange(t.target.name,t.target.value):void 0}})(this),type:"radio",value:t.value}),t.label));return r}.call(this)))}}),o=n(i,["/static/css/sharing/share_modal-vflqkhEAI.css"]),{SettingsModalButtons:r,SinglePolicyControl:o}})}.call(this),define("modules/clean/sharing/share_modal",["require","exports","tslib","external/immutable","external/react","modules/clean/flux/dispatcher","modules/clean/flux/store_listener","modules/clean/growth/experiments/manage_shared_folders_modal","modules/clean/growth/experiments/sharing_paywall_info_modal","modules/clean/previews/util","modules/clean/react/browse/constants","modules/clean/react/modal","modules/clean/react/pass/store","modules/clean/sharing/constants","modules/clean/sharing/api/util/types","modules/clean/sharing/file_settings_modal","modules/clean/sharing/folder_settings_modal","modules/clean/sharing/set_confidential_modal","modules/clean/sharing/share_page/action_types","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/ui_util","modules/clean/sharing/views/modal_content","modules/clean/sharing/views/viewer_list_modal","modules/clean/viewer","modules/core/i18n","modules/core/notify"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,E,w,C){"use strict";var N=r.createElement,T=w.i18n_default_project("sharing").ungettext,P=function(e){var t=e.actionHandler.getSharingInfo(),r=e.actionHandler.getPassInfo(),o=r[0],a=r[1],i=r[2],l=r[3],d={actionHandler:e.actionHandler,areMembersFullyLoaded:t.areMembersFullyLoaded(),areSharingPrefsLoaded:t.areSharingPrefsLoaded(),banner:t.banner(),canChangeOptions:t.canChangeOptions(),canInviteEditor:t.canInviteEditor(),canInviteViewer:t.canInviteViewer(),canInviteViewerNoComment:t.canInviteViewerNoComment(),canMakeViewerNoComment:t.canMakeViewerNoComment(),canRelinquishMembership:t.canRelinquishMembership(),canShareLink:t.canShareLink(),canUnshareFile:t.canUnshareFile(),canUnshareFolder:t.canUnshareFolder(),canUpdateConfidentiality:t.canUpdateConfidentiality(),contactsError:t.contactsError(),contentInfo:t.contentInfo(),contentNameMessage:t.contentNameMessage(),contentNameMessageLevel:t.contentNameMessageLevel(),filePolicy:t.filePolicy(),folderPolicy:t.folderPolicy(),groupSeenStateInfo:a,hasDisplayableMembers:t.hasDisplayableMembers(),hasNonOwnerMembers:t.hasNonOwnerMembers(),hasParentSharedFolder:t.hasParentSharedFolder(),icon:t.icon(),initialRecipientRawInput:t.initialRecipientRawInput(),initialRecipientTokens:t.initialRecipientTokens(),isAddMessageAsCommentChecked:t.isAddMessageAsCommentChecked(),isAddMessageAsCommentHelpShown:t.isAddMessageAsCommentHelpShown(),isConfidentialFolder:t.isConfidentialFolder(),isContentNameFocused:t.isContentNameFocused(),isFolderInsideTeamFolderTree:t.isFolderInsideTeamFolderTree(),isLinkMetadataLoaded:t.isLinkMetadataLoaded(),isMetadataLoaded:t.isMetadataLoaded(),isNoCommentEnabledForFolders:t.isNoCommentEnabledForFolders(),isNoCommentEnabledForLinks:t.isNoCommentEnabledForLinks(),isOwner:t.isOwner(),isSharingPaywallInfoLoaded:t.isSharingPaywallInfoLoaded(),isTeamPolicyLoaded:t.isTeamPolicyLoaded(),isTeamSharedFolder:t.isTeamSharedFolder(),isTokenizerEmpty:t.isTokenizerEmpty(),isUserOnOwnerTeam:t.isUserOnOwnerTeam(),linkMetadata:t.linkMetadata(),linkOnlyReason:t.linkOnlyReason(),linkSeenStateInfo:o,memberCounts:t.memberCounts(),memberCountWithRecipients:t.memberCountWithRecipients(),members:t.members(),metadata:t.metadata(),ownerTeam:t.ownerTeam(),passFetchingStatus:l,pendingMemberAction:t.pendingMemberAction(),permissions:t.permissions(),presentAccountIds:s.Set(i),recipientAccess:t.recipientAccess(),recipientMessage:t.recipientMessage(),recipientTokens:t.recipientTokens(),shareFolderPromise:t.shareFolderPromise(),sharingPaywallInfo:{foldersToUnshare:t.foldersToUnshare(),isInExperiment:t.isPaywallOn(),maxOwned:t.paywallMax(),numOwned:t.paywallNumOwned(),grandfatherModal:t.paywallGrandfatherModal()},shouldBlockMemberListOnPassLoad:t.shouldBlockMemberListOnPassLoad(),teamPolicy:t.teamPolicy(),uiMode:t.uiMode(),expSubgrowthProOverquotaCreateSharedLink:t.expSubgrowthProOverquotaCreateSharedLink()};return n.__assign({},t.getInitialProps(),d)},M=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleLinkViewersClick=function(){p.Modal.showInstance(r.createElement(I.ViewerListModal,{contentInfo:n.props.contentInfo,seenStateInfo:n.props.linkSeenStateInfo,onCancel:n.props.actionHandler.openShareModal,presentAccountIds:n.props.presentAccountIds,user:n.props.user})),v.logTiburonEvent(n.props.contentInfo,n.props.user.id,"OPEN_SHARED_LINK_VIEWER_LIST_MODAL")},n.handleManageSharedFoldersClick=function(){var e=function(e,t){if(e&&e.size>0){n.props.actionHandler.onUnshareFromPaywall({foldersToUnshare:e,keepACopy:t});var s=T("%(num_folders)s folder will be unshared","%(num_folders)s folders will be unshared",e.size).format({num_folders:e.size});C.success(s)}n.props.sharingPaywallInfo&&n.props.sharingPaywallInfo.grandfatherModal&&n.props.sharingPaywallInfo.grandfatherModal.show&&n.props.actionHandler.paywallGrandfatherModalDismiss(),n.props.actionHandler.openShareModal()};p.Modal.showInstance(r.createElement(i.ManageSharedFoldersModal,{maxOwned:n.props.sharingPaywallInfo.maxOwned,numOwned:n.props.sharingPaywallInfo.numOwned,user:n.props.user,onUnshare:e}))},n.handleUpgradeClick=function(){return n.props.actionHandler.redirectToUpgrade()},n.handleSettingsClick=function(){n.props.contentInfo.isFolder()?n.handleFolderSettingsClick():n.handleFileSettingsClick()},n.handleSetConfidentialClick=function(){var e=function(e){e&&(n.props.actionHandler.handleGetMetadataSuccess(e),n.props.actionHandler.listMembers(e.shared_folder_id)),n.props.actionHandler.openShareModal()};p.Modal.showInstance(r.createElement(g.SetConfidentialModal,{client:n.client,folderId:n.props.contentInfo.isSharedFolder()?n.props.contentInfo.sharedFolderId().toString():void 0,folderName:n.props.contentInfo.name(),folderPath:n.props.contentInfo.displayPath(),initialIsConfidentialFolder:n.props.isConfidentialFolder,onCancel:e.bind(n,null),onUpdateConfidentiality:e}))},n.client=n.props.client,n}return n.__extends(t,e),t.prototype.componentWillUnmount=function(){var e=this.getTokenizer();this.props.actionHandler.onShareModalUnmount(e)},t.prototype.render=function(){var e=this,t=d.is_pass_ga_receive_enabled(this.props.user)&&u.getPassPermissions(this.props.contentInfo.id)&&u.getPassPermissions(this.props.contentInfo.id).canReadPresence,s={headerId:"unified-share-modal-title",areCheckboxSettingsLoaded:this.props.areSharingPrefsLoaded,isLimitedTeam:this.props.viewer.team_is_limited,isPassEnabled:d.is_pass_enabled(this.props.user)||t,isInContentManager:this.props.isInContentManager,onSettingsClick:this.handleSettingsClick,onLinkViewersClick:this.props.linkSeenStateInfo&&this.props.linkSeenStateInfo.length?this.handleLinkViewersClick:void 0,onSetConfidentialClick:this.handleSetConfidentialClick,mode:this.props.uiMode,ref:"content",showContentManagerBridge:this.shouldRenderContentManagerBridge(),showPassFileSettings:this.showFileSettings(),sharingPaywallInfo:{foldersToUnshare:this.props.sharingPaywallInfo.foldersToUnshare,isFolderOwner:this.props.isOwner,isInExperiment:this.props.sharingPaywallInfo.isInExperiment,maxOwned:this.props.sharingPaywallInfo.maxOwned,numOwned:this.props.sharingPaywallInfo.numOwned,onLearnMoreClick:function(){return e.props.actionHandler.paywallGrandfatherModalLearnMore()},onManageSharedFoldersClick:this.handleManageSharedFoldersClick,onUpgradeClick:this.handleUpgradeClick},suppressLinkUI:this.shouldSuppressLinkUI()};return s=n.__assign({},this.props,s),this.shouldShowGrandfatherModal()?this.renderSharingPaywallGrandfatherModal():r.createElement(p.Modal,{style:"bare",acceptButtonText:null,dismissButtonText:null,headerId:"unified-share-modal-title",ref:"modal"},N(S.ShareModalContent,s))},t.prototype.shouldSuppressLinkUI=function(){return this.props.isInContentManager&&!h.TRUELINK.TRUELINK_UI[this.props.user.id]},t.prototype.shouldShowGrandfatherModal=function(){return this.props.sharingPaywallInfo&&this.props.sharingPaywallInfo.grandfatherModal&&this.props.sharingPaywallInfo.grandfatherModal.show&&this.props.isOwner&&this.props.sharingPaywallInfo.isInExperiment&&this.props.contentInfo&&this.props.contentInfo.isFolder()},t.prototype.renderSharingPaywallGrandfatherModal=function(){var e=this,t=function(){e.props.actionHandler.paywallGrandfatherModalDismiss()};return r.createElement(l.SharingPaywallInfoModal,{actionHandler:this.props.actionHandler,onDismiss:t,onManage:this.handleManageSharedFoldersClick,sharedFolderCount:this.props.sharingPaywallInfo.numOwned,grandfather:!this.props.sharingPaywallInfo.grandfatherModal.learnMore})},t.prototype.showFileSettings=function(){return v.showFileSettings(this.props.user,this.props.contentInfo.id)},t.prototype.refreshSharedWithColumnLinkData=function(){o.dispatch({type:c.SharedWithActionTypes.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE,data:{fileFqPaths:[this.props.contentInfo.displayPath()]}})},t.prototype.handleFolderPolicySuccess=function(e,t){o.dispatch({type:y.SharePageActionTypes.FETCH_FOLDER_POLICY_SUCCESS,user:this.props.user,metadata:t,folderPolicy:e})},t.prototype.getTokenizer=function(){return this.refs.content&&this.refs.content.getWrappedComponent()&&this.refs.content.getWrappedComponent().refs.tokenizer},t.prototype.handleFileSettingsClick=function(){var e=this,t=h.TRUELINK.TRUELINK_UI[this.props.user.id]?m.getCombinedPolicy(this.props.filePolicy,this.props.linkMetadata):this.props.filePolicy,n=function(n){null!=n&&e.props.actionHandler.handleUpdateFilePolicy(n,t),e.props.actionHandler.openShareModal()};p.Modal.showInstance(r.createElement(_.FileSettingsModal,{fileName:this.props.contentInfo.name(),contentId:this.props.contentInfo.id,canChangeOptions:this.props.canChangeOptions,canUnshareFile:this.props.canUnshareFile,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,initialPolicy:t,linkMetadata:this.props.linkMetadata,onCancel:n,onPolicySet:n,ownerTeam:this.props.ownerTeam,permissions:this.props.permissions,user:this.props.user})),v.logTiburonEvent(this.props.contentInfo,this.props.user.id,"OPEN_FILE_SETTINGS_MODAL")},t.prototype.handleFolderSettingsClick=function(){var e=this,t=h.TRUELINK.TRUELINK_UI[this.props.user.id]?m.getCombinedPolicy(this.props.folderPolicy,this.props.linkMetadata):this.props.folderPolicy,n=function(t,n){null!=n&&(e.props.actionHandler.handleUpdateSharingSettings(n),e.handleFolderPolicySuccess(t,n),e.props.onSuccessSharing&&e.props.onSuccessSharing(),n.policy.shared_link_policy!==e.props.folderPolicy.shared_link_policy&&(e.props.actionHandler.fetchLinkMetadata(),e.refreshSharedWithColumnLinkData())),e.props.actionHandler.openShareModal()},s=null,o=null;this.props.contentInfo.extras&&this.props.contentInfo.extras.nsId&&(s=this.props.contentInfo.extras.nsId,o=this.props.contentInfo.extras.nsPath),p.Modal.showInstance(r.createElement(f.SharedFolderSettingsModal,{actionHandler:this.props.actionHandler,folderName:this.props.contentInfo.name(),folderId:this.props.metadata.shared_folder_id,folderPath:this.props.contentInfo.displayPath(),nsId:s,nsPath:o,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,hasParentSharedFolder:this.props.hasParentSharedFolder,initialHasParentSharedFolder:this.props.hasParentSharedFolder,initialMetadata:this.props.metadata,initialOwnerTeam:this.props.ownerTeam,initialPermissions:this.props.permissions,initialPolicy:t,isInContentManager:this.props.isInContentManager,isSharedFolder:this.props.contentInfo.isSharedFolder(),initialIsTeamSharedFolder:this.props.isTeamSharedFolder,isFolderInsideTeamFolderTree:this.props.isFolderInsideTeamFolderTree,isLimitedTeam:this.props.viewer.team_is_limited,isUserOnOwnerTeam:this.props.isUserOnOwnerTeam,linkMetadata:this.props.linkMetadata,onCancel:n,onPolicySet:n,showContentManagerBridge:this.shouldRenderContentManagerBridge(!0),teamPolicy:this.props.teamPolicy,updateLinkSettings:this.props.actionHandler.updateLinkSettings,user:this.props.user}))},t.prototype.shouldRenderContentManagerBridge=function(e){return void 0===e&&(e=!1),v.GoldenGate.hasContentManager(this.props.user.id)&&this.props.user.is_team_admin&&!this.props.isInContentManager&&(this.props.isTeamSharedFolder||e&&this.props.isFolderInsideTeamFolderTree)},t})(r.Component);M.displayName="ShareModal",M.defaultProps={viewer:E.get_viewer()},t.ShareModal=a.listenToStores(M,{sharingInfoStore:b.sharingInfoStore,passStore:u},P)}),function(){define("modules/clean/sharing/share_modal_util",["external/react","external/underscore","modules/clean/account/email","modules/clean/account/email_verify_reasons","modules/clean/contacts/contact","modules/clean/contacts/types","modules/clean/filepath","modules/clean/react/browse/action_logger","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/modal","modules/clean/react/teams/modals/limited_team_folder_settings_modal","modules/clean/react/teams/modals/limited_team_share_folder_modal","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api","modules/clean/sharing/api/client","modules/clean/sharing/content_info","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/share_modal","modules/clean/sharing/shared_content_link_sync_utils","modules/clean/sharing/ui_util","modules/clean/user","modules/clean/viewer","modules/core/uri"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,E){var w,C,N,T,P,M,A,k,F,x,L,R,O,D,U,B,q,H,V,G,W,K,Y,z;return P=n.EmailVerification,N=r.Contact,C=i.BrowseLogger,k=l.FileTypes,w=d.BrowseContext,M=d.File,c.Modal,L=m.SharingApi,A=_.FileShareApiClient,F=_.FolderShareApiClient,T=f.ContentInfo,H=g.makePublicFolderLink,K=g.showPublicFolderLinkModal,x=y.ShareModal,D=v.getNewFolderPathFromContentName,q=v.logTiburonEvent,e.createElement,O=function(){return Math.random()},B=function(e,n,s){var r,o,a;null==s&&(s={}),e.id||(e=I.get_viewer().get_user_by_id(e)),null==s.userHomeNs&&(s.userHomeNs=e.home_ns_id),a=U(n),t.extend(a,s),a.modalSessionId||(a.modalSessionId=O()),C.logViewShareModel({uid:e.id,modal_session_id:a.modalSessionId});try{o=T.createFromParams(a)}catch(e){o=null}return r=n instanceof w?n:a.browseContext,{browseContext:r,contentInfo:o,shareModalInfo:a,user:e}},Y=function(e,t,n){var r,o,a,i,l,d,c,p,u,m,_,f;return null==n&&(n={}),m=B(e,t,n),o=m.browseContext,i=m.contentInfo,f=m.shareModalInfo,e=m.user,null!=i&&(q(i,e.id,"BEGIN_SHARE_FLOW"),!!V(e,f,o)||(!f.skipPublicFolderCheck&&i&&o&&(p=H(e.id,o.config,i.displayPath(),i.isFolder()))?(K(p),!0):(c=(null!=o?o.isNonUserRelativeContext:void 0)||f.isNonUserRelativeContext,u=void 0,"PREVIEW_PAGE"===f.origin&&(u=s.SHARE_FILEVIEWER),P.get_for_user(e).verified_or_show(u)?(_=i.isFolder()?F:A,a=new _({userId:e.id,isNonUserRelativeContext:c}),r=new h(a,e,x),l=f.inLinksPage,d=f.prefillContacts,r.initializeShareModal({contentInfo:i,initialRecipientTokens:d,inLinksPage:l},{client:a,user:e,onDeleteLink:f.onDeleteLink,teamGroupInfo:i.teamGroupInfo(),isInContentManager:c,onSuccessSharing:f.onSuccessSharing,shareAsConfidential:f.shareAsConfidential,initialContentName:f.initialContentName}),r.openShareModal()):q(i,e.id,"SHARE_MODAL_EMAIL_UNVERIFIED"),!0)))},V=function(e,t,n){var s;if(t.isTeamSharedFolder&&I.get_viewer().team_is_limited)return!e.is_team_admin||"BROWSE_SHARED_FOLDER_BANNER"!==(s=t.origin)&&"BROWSE_GLOBAL_ACTIONS"!==s?u.showModalInstance({fqPath:t.fqPath}):p.showWithProps({folderId:t.targetNsId.toString(),folderName:n.getNameOfTargetFolder(),user:e}),!0},U=function(e){var t,n;return e instanceof M?(t=(n=e.type)===k.FILE||n===k.PACKAGE,{beaconContext:e.beacon_context,exists:!e.isDeleted,fileId:e.file_id,fqPath:e.fq_path,isFolder:!t,isTeamSharedFolder:e.type===k.TEAM_SHARED_FOLDER,sjid:e.sjid,nsId:e.ns_id,nsPath:e.ns_path,targetNsId:e.target_ns}):e instanceof w?R(e):e},R=function(e){return e.isInsideDeletedFolder||e.isInsideDeletedSharedFolder?null:e.isInFolderMode?e.isInsideSharedFolder?e.currentNSPath?{fqPath:e.currentFQPath,isFolder:!0,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}:{fqPath:e.currentMountPoint,isFolder:!0,nsId:null,nsPath:e.currentMountPoint,targetNsId:e.currentNSID,isTeamSharedFolder:e.isInsideAutoTeamFolder}:{fqPath:e.currentFQPath,isFolder:!0,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}:{fqPath:e.currentFQPath,isFolder:!1,nsId:e.currentNSID,nsPath:e.currentNSPath,targetNsId:null}},G=function(e,t,n,s,r){var o;return null==t&&(t=null),null==n&&(n=null),null==s&&(s=null),null==r&&(r=!1),t||(t=O()),o=function(){var e,t,s;for(e="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=1;t<=100;++t)e+=s.charAt(Math.floor(Math.random()*s.length));return D(e,n)},Y(e,{fqPath:o(),isFolder:!0,exists:!1,origin:"WIZARD",modalSessionId:t,initialContentName:s,shareAsConfidential:r})},z=function(e,t){var n,s;return n=new L(e),s=function(e){var n;return n=JSON.parse(e.responseText),b.showSharedContentSyncModal(n,t)},n.get_sync_vars_for_ns_id(t.ns_id,t.ns_path,s)},W=function(e){var t,n,s,r,a;return a=e.user,r=e.sharePrefillEmail,t=e.content,r?(n="GRANT_ACCESS",s=[new N({type:o.EMAIL,email:r})]):(n="DESKTOP_CLIENT",s=[]),Y(a,t,{origin:n,prefillContacts:s})},{generateModalSessionId:O,getShareModalInfo:U,getSharingInfo:B,showFastrakShareModalIfAllowed:V,showNewFolderShareModal:G,showSharedContentLinkSyncModal:z,showShareModal:Y,showPrefilledShareModal:W}})}.call(this),function(){define("modules/clean/sharing/shared_content_link_sync_modal",["external/classnames","external/react","modules/clean/ajax","modules/clean/avatar/triple_avatars","modules/clean/analytics","modules/clean/avatar/avatar_with_default","modules/clean/avatar/faceholder","modules/clean/avatar/size","modules/clean/em_string","modules/clean/filepath","modules/clean/history","modules/clean/react/button","modules/clean/react/browse/models","modules/clean/react/image","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react_format","modules/clean/sharing/constants","modules/clean/sharing/views/hover_close_button","modules/clean/static_urls","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/teams","modules/constants/python","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","require"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,E,w,C,N,T,P){var M,A,k,F,x,L,R,O,D,U,B;return x=s.TripleAvatars,F=r.ShareTibEventLogger,M=i.AVATAR_DIMENSION_BY_SIZE,R=p.button,A=u.File,k=m.Modal,U=f.reactFormat,B=b.static_url,E.TRADEMARK_BUSINESS,L=C.i18n_default_project("sharing")._,D=t.DOM,O=t.createElement,t.createClass({statics:{showInstance:function(e){return k.showInstance(e)}},displayName:"SharedContentLinkSyncModal",ASK:"ask",ASKING:"asking",propTypes:{accessLevel:t.PropTypes.string.isRequired,folderName:t.PropTypes.string.isRequired,folderSize:t.PropTypes.string.isRequired,onMountSharedFolder:t.PropTypes.func.isRequired,canRequestToJoin:t.PropTypes.bool,previewCallback:t.PropTypes.func,previewUrl:t.PropTypes.string,outOfQuotaQP:t.PropTypes.string,ownerName:t.PropTypes.string,senderName:t.PropTypes.string,usageRemaining:t.PropTypes.string,usageNeeded:t.PropTypes.string,targetFile:t.PropTypes.instanceOf(A),syncNSId:t.PropTypes.string,expProSharingOverquotaModal:t.PropTypes.string,ownerProfilePhotoUrl:t.PropTypes.string},getDefaultProps:function(){return{canRequestToJoin:!1}},getInitialState:function(){return{state:this.ASK,ownerTeam:null}},componentWillMount:function(){var e,t,n,s;return s=S.start_time(),e=(new Date).getTime(),this.userId=v.get_viewer().get_users()[0].id,n=g.SHARE_ACTION_ORIGIN_TYPE.SYNC_MODAL,t=this.props.targetFile?"UNMOUNTED_SEARCH_MODAL_RENDER":"SYNC_MODAL_RENDER",F.log(this.userId,t,n,{timing:e-s,ns_id:this.props.syncNSId})},_closeSyncModal:function(){return c.remove_query_param("sm"),this.refs.modal.close()},_renderTopPanelIcon:function(){return this.props.targetFile?O(_,{alt:"",group:"web",name:this.props.targetFile.icon}):O(_,{alt:"",group:"web",name:"folder_user_32"})},_renderTopPanelTitle:function(){return this.props.targetFile?l.em_snippet(d.filename(this.props.targetFile.fq_path,15)):l.em_snippet(this.props.folderName,15)},_renderTopPanelSubtitle:function(){return this.props.targetFile?null!=this.props.ownerName?L("Owned by %(name)s").format({name:this.props.ownerName}):L("Not currently owned"):this.props.folderSize},_renderAccessText:function(){return this.props.outOfQuotaQP?this.props.canRequestToJoin?this.state.ownerTeam?D.div({},D.div({className:"content-link-sync-modal__access-text u-mar-top-m"},O(x,{contacts:this.state.ownerTeam.contacts,count:this.state.ownerTeam.count})),D.div({className:"content-link-sync-modal__access-text"},L("Your Dropbox is full—join the %(team_name)s Dropbox?").format({team_name:this.state.ownerTeam.name}))):D.div({}):D.div({className:"content-link-sync-modal__access-text"},L("Not enough space")):D.div({className:"content-link-sync-modal__access-text"},null!=this.props.senderName?"can_view"===this.props.accessLevel?L("%(name)s gave you access to view this folder").format({name:this.props.senderName}):L("%(name)s gave you access to edit this folder").format({name:this.props.senderName
}):L("can_view"===this.props.accessLevel?"You have access to view this folder":"You have access to edit this folder"))},_renderSharedFolderInfo:function(){var e;return D.div({className:"content-link-sync-modal__shared-folder-info"},D.div({className:"content-link-sync-modal__shared-folder-text"},L((null!=(e=this.props.targetFile)?e.is_dir:void 0)?"This folder is part of a shared folder:":"This file is part of a shared folder:")),D.div({},O(_,{alt:"",group:"web",name:"folder_user_32"})),D.p({className:"u-font-meta"},this.props.folderName,D.br({}),this.props.folderSize))},_renderTipBody:function(){return this.props.outOfQuotaQP?this.props.canRequestToJoin?this.state.ownerTeam?this.state.ownerTeam.contacts.length>0?L("Join %(name)s and your coworkers and get more space to work together.").format({name:this.state.ownerTeam.contacts[0].display_name}):void 0:D.img({className:"content-link-sync-modal__loader",src:B("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:L("Loading")}):this.props.usageRemaining?L("To add this folder, you’ll need %(needed)s of space in your Dropbox. You currently have %(remaining)s of space left.").format({remaining:this.props.usageRemaining,needed:this.props.usageNeeded}):L("To add this folder, you’ll need %(needed)s of space in your Dropbox. You currently have no space left.").format({needed:this.props.usageNeeded}):this.state.state===this.ASKING?D.img({src:B("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:L("Loading")}):L("can_view"===this.props.accessLevel?this.props.targetFile?"For easy access to this file in the future, add the folder to your Dropbox.":"For easy access to this folder in the future, add it to your Dropbox.":this.props.targetFile?"To start working on this file, you need to add the folder to your Dropbox first.":"To start working on this folder, you need to add it to your Dropbox first.")},_renderPreviewLink:function(){if("can_view"===this.props.accessLevel)return D.div({},D.span({className:"content-link-sync-modal__or"},L("Or")),D.button({className:"content-link-sync-modal__not-now-label button-as-link",onClick:this.onPreviewButtonClicked},L(!this.props.targetFile||this.props.targetFile.is_dir?"preview this folder":"preview this file")))},render:function(){var t,n,s,r,o;return s="V1"===(r=this.props.expProSharingOverquotaModal)||"V2"===r||"V3"===r,n=e({"content-link-sync-modal":!0,"exp-subgrowth-biz-upsell":this.props.canRequestToJoin,"content-link-sync-modal--pro-variant":s}),this.props.outOfQuotaQP&&s?(o=this.renderVariant(),t=this.renderButtonsVariant()):(o=this.renderControl(),t=this.renderButtons()),O(k,{autoClose:!1,buttonComponent:t,className:n,clickOutToClose:!1,ref:"modal",showX:!1,title:""},o)},renderControl:function(){return D.div({className:"content-link-sync-modal__content u-mar-bottom-xs"},D.div({className:"content-link-sync-modal__top-panel u-pad-s"},D.div({className:"content-link-sync-modal__icon"},this._renderTopPanelIcon()),D.div({className:"content-link-sync-modal__name-size u-l-ib u-pad-left-xs u-pad-top-xs o-flag__flex"},D.h3({className:"u-font-strong"},this._renderTopPanelTitle()),D.h4({className:"u-trim-margin u-font-meta"},this._renderTopPanelSubtitle())),D.div({className:"content-link-sync-modal__close u-pad-xs o-flag__fix"},O(y,{onClick:(function(e){return function(){return e._closeSyncModal()}})(this)}))),D.div({className:"content-link-sync-modal__tip-panel"},this.props.targetFile?this._renderSharedFolderInfo():this._renderAccessText(),D.div({className:"content-link-sync-modal__tip-body"},this._renderTipBody())))},renderVariant:function(){var e,t,n;return n=this.props.usageRemaining>0?U(L("To add this folder, you’ll need <strong>%(needed)s</strong> of space in your Dropbox. You currently have <span>%(remaining)s</span> of space left."),{strong:D.strong(),span:D.span({className:"content-link-sync-modal__alert"}),remaining:this.props.usageRemaining,needed:this.props.usageNeeded}):U(L("To add this folder, you’ll need <strong>%(needed)s</strong> of space in your Dropbox. You currently have no space left."),{strong:D.strong(),needed:this.props.usageNeeded}),t=null!=this.props.ownerName,D.div({className:"content-link-sync-modal--pro-variant__content u-mar-bottom-xs"},D.div({className:"content-link-sync-modal--pro-variant__close u-pad-xs u-font-right"},O(y,{onClick:(function(e){return function(){return e._closeSyncModal()}})(this)})),D.div({className:"content-link-sync-modal--pro-variant__container"},D.div({className:"content-link-sync-modal--pro-variant__left-container"},"V1"===this.props.expProSharingOverquotaModal?O(h,{src:B("/static/images/pro/overquota/big-shared-folder-vflkQGYtl.svg")}):"V2"===this.props.expProSharingOverquotaModal?D.div({className:"content-link-sync-modal--pro-variant__folder-container"},O(h,{src:B("/static/images/pro/overquota/big-shared-folder-vflkQGYtl.svg")}),t?D.div({className:"avatar-img"},O(o,{dimension:M.MEDIUM,photoUrl:this.props.ownerProfilePhotoUrl,shape:"CIRCLE",defaultAvatar:O(a,{dimension:M.MEDIUM})})):void 0):"V3"===this.props.expProSharingOverquotaModal?O(h,{src:B("/static/images/pro/overquota/spot-overquota-folder-vflUsxn3C.svg")}):"V4"===this.props.expProSharingOverquotaModal?O(h,{src:B("/static/images/pro/overquota/big-shared-folder-vflkQGYtl.svg")}):void 0,D.div({className:"content-link-sync-modal--pro-variant__content"},D.div({className:"content-link-sync-modal--pro-variant__folder-name"},l.em_snippet(this.props.folderName,g.OUT_OF_QUOTA_FOLDER_NAME)),"V1"!==(e=this.props.expProSharingOverquotaModal)&&"V2"!==e&&"V3"!==e||!t?void 0:D.div({className:"content-link-sync-modal--pro-variant__owner-name"},l.em_snippet(this.props.ownerName,g.DISPLAY_NAME)))),D.div({className:"content-link-sync-modal--pro-variant__right-container"},D.div({className:"content-link-sync-modal--pro-variant__tip-title"},L("Not enough space")),D.div({className:"content-link-sync-modal--pro-variant__tip-body"},n))))},renderButtons:function(){return this.props.canRequestToJoin&&this.props.outOfQuotaQP?this.state.ownerTeam?D.div({className:"content-link-sync-modal__buttons u-mar-bottom-s"},this.props.outOfQuotaQP?D.div({},O(R,{importance:"primary",className:"content-link-sync-modal__request-to-join-button",disabled:this.state.state===this.ASKING,onClick:this.onRequestButtonClicked},L(this.state.ownerTeam.is_limited?"Join the team":"Request to join")),O(R,{importance:"tertiary",className:"content-link-sync-modal__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onSyncButtonClicked},L("Upgrade to add folder")),"can_view"===this.props.accessLevel?this._renderPreviewLink():void 0):void 0):D.div({}):D.div({className:"content-link-sync-modal__buttons u-mar-bottom-s"},O(R,{importance:"primary",className:"content-link-sync-modal__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onSyncButtonClicked},L(this.props.outOfQuotaQP?"Upgrade to add folder":this.props.targetFile?"Add folder to Dropbox":"Add to Dropbox")),"can_view"===this.props.accessLevel?this._renderPreviewLink():void 0)},renderButtonsVariant:function(){return D.div({className:"content-link-sync-modal--pro-variant__buttons"},O(R,{importance:"primary",className:"content-link-sync-modal--pro-variant__add-to-dropbox-button",disabled:this.state.state===this.ASKING,onClick:this.onUpgradeButtonClicked},L("Upgrade to add folder")))},requestCallback:function(){return this.props.outOfQuotaQP?w.redirect(T({path:"/pro/buy"}).updateQuery({oqa:this.props.outOfQuotaQP})):(this.props.targetFile&&F.log(this.userId,"UNMOUNTED_SEARCH_SYNC","SYNC_MODAL",{ns_id:this.props.syncNSId}),this.props.onMountSharedFolder())},onSyncButtonClicked:function(){return this.setState({state:this.ASKING}),!this.props.outOfQuotaQP&&this.props.canRequestToJoin?this.activateRequestModal():this.requestCallback()},onPreviewButtonClicked:function(){var e;return null!=this.props.previewCallback?(F.log(this.userId,"UNMOUNTED_SEARCH_PREVIEW","SYNC_MODAL",{ns_id:this.props.syncNSId}),this.props.previewCallback()):(e=null!=this.props.previewUrl?T.parse(this.props.previewUrl):w.get_uri().removeQuery("sm"),e.updateQuery({from_sync_modal:!0}),w.redirect(e))},onRequestButtonClicked:function(){return this.setState({state:this.ASKING}),P(["modules/clean/teams/membership_discovery_util"],(function(e){return function(t){return t.sendTeamRequest(e.state.ownerTeam.id,function(){return k.close()})}})(this))},activateRequestModal:function(){if(this.props.canRequestToJoin)return P(["modules/clean/teams/membership_request_modal"],(function(e){return function(t){var n;return n=t.MembershipRequestModal,k.showInstance(O(n,{senderName:e.props.senderName,team:e.state.ownerTeam,folderName:l.em_snippet(e.props.folderName,15),requestCallback:e.requestCallback}))}})(this))},componentDidMount:function(){if(this.props.canRequestToJoin)return P(["modules/clean/teams/membership_discovery_util"],(function(e){return function(t){var n;return n=t.getDiscoverableTeamForFolder,e.setState({state:e.ASKING}),n(e.props.syncNSId,function(t){return e.setState({state:e.ASK,ownerTeam:t})})}})(this))}})})}.call(this),function(){define("modules/clean/sharing/shared_content_link_sync_utils",["external/react","modules/clean/ajax","modules/clean/api_v2/root_aware_client","modules/clean/browse_interface","modules/clean/multiaccount_login","modules/clean/sharing/api/client","modules/clean/sharing/constants","modules/clean/sharing/role_selector_modal","modules/clean/sharing/shared_content_link_sync_modal","modules/clean/viewer","modules/core/browser","modules/core/exception","modules/core/i18n","modules/core/notify"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h){var m,_,f,g,y,b,assert;return y=t.WebRequest,_=n.ApiV2RootAwareClient,f=o.FolderShareApiClient,m=a.ACCESS_LEVEL,assert=p.assert,b=u.i18n_default_project("sharing")._,g={mountSharedFolder:function(e,t,n,o,a,l){var p,u,m,_,v,S;if(null==o&&(o=!1),null==a&&(a=null),null==l&&(l=!1),t){if(!d.get_viewer().is_role_signed_in(t))return void r.show_modal({role:t,on_success:function(){return g.mountSharedFolder(e,t,n)}})}else if(d.get_viewer().is_paired)return u=function(t){return n="PREVIEW_PAGE",g.mountSharedFolder(e,t,n)},void new i(u).show();return S=d.get_viewer(),t?v=S.get_uid_by_role(t):(assert(!S.is_paired,"role can not be unspecified for paired viewer"),v=S.get_user_ids()[0]),m=b("Adding to your Dropbox..."),S.is_paired&&(S.get_user_by_id(v).is_team?(m=b("Adding to your %(team_name)s Dropbox..."),m=m.format({team_name:S.team_name})):m=b("Adding to your personal Dropbox...")),h.success(m),_=function(e){var t,n,r;return n=e,null!=a&&(n+=a.ns_path),t=d.get_viewer().get_user_by_id(v),r=s.browse_uri_for_fq_path(t,n),r.updateQuery({from_scl_sync_modal:o}),c.redirect(r)},l?y({url:"/share_action/rejoin",subject_user:v,data:{ns_id:e},success:_,error:function(){return h.error(b("We were unable to complete your request."))}}):(p=new f({userId:v}),p.mount({contentId:e,origin:n}).then(function(e){return _(e.path_lower)}).catch(function(e){return h.error(b("We were unable to complete your request."))}))},showSharedContentSyncModal:function(t,n){var s,r,o,a;if(null!=t?t.sync_ns_id:void 0)return s=!1,t.can_request_to_join&&(s=t.can_request_to_join),o="SYNC_MODAL",a=t.sync_owner_name||t.ownerName,r=g.mountSharedFolder.bind(null,t.sync_ns_id,t.sync_role,o,!0,n),l.showInstance(e.createElement(l,{accessLevel:t.access_level,canRequestToJoin:s,folderName:t.sync_folder_name,folderSize:t.sync_folder_size,outOfQuotaQP:t.sync_out_of_quota_qp,usageRemaining:t.sync_usage_remaining,usageNeeded:t.sync_usage_needed,senderName:t.sync_sender_name,ownerName:a,targetFile:n,previewCallback:null!=n?c.redirect.bind(c,t.sync_preview_url):void 0,previewUrl:t.sync_preview_url,onMountSharedFolder:r,syncNSId:t.sync_ns_id,expProSharingOverquotaModal:t.expProSharingOverquotaModal,ownerProfilePhotoUrl:t.ownerProfilePhotoUrl}))},proSharingOverquotaModalExperiment:function(e,t,n,s){var r,o;return t.expProSharingOverquotaModal=s,"V1"===s||"V2"===s||"V3"===s?(r=new f({userId:n,client:new _}),o=t.nsId||t.sync_ns_id,r.listMembers({contentId:o}).then(function(e){var n,s,r,o,a;if(s=e.users.filter(function(e){return e.access_type===m.OWNER}),1===(null!=s?s.size:void 0))return r=s.entries().next().value,r[0],n=r[1],t.ownerName=null!=n&&null!=(o=n.account)?o.display_name:void 0,t.ownerProfilePhotoUrl=null!=n&&null!=(a=n.account)?a.profile_photo_url:void 0}).finally(function(){return e(t)})):e(t)}}})}.call(this),define("modules/clean/sharing/sharing_settings_constants",["require","exports"],function(e,t){"use strict";t.MEMBER_POLICY="member_policy",t.ACL_UPDATE_POLICY="acl_update_policy",t.DOWNLOAD_POLICY="download_policy",t.PASS_POLICY="pass_policy",t.AUDIENCE_POLICY="audience",t.ACCESS_LEVEL_POLICY="access_level",t.FOLDER_LINK_AUDIENCE_POLICY="shared_link_policy",t.PASSWORD_POLICY="password",t.EXPIRY_POLICY="expiry",t.DROPDOWN="dropdown",t.TOGGLE="toggle",t.PASSWORD_INPUT="password_input",t.EXPIRY_INPUT="expiry_input",t.FILE_SETTINGS="file_settings",t.FOLDER_SETTINGS="folder_settings",t.LINK_SETTINGS="link_settings"}),define("modules/clean/sharing/sharing_settings_dropdown",["require","exports","external/react","modules/clean/react/bubble_menu","modules/clean/react/sprite"],function(e,t,n,s,r){"use strict";function o(e){var t=e.customButton||n.createElement("button",{className:"c-btn c-btn--secondary sharing-settings-dropdown__button"},n.createElement("span",{className:"sharing-settings-dropdown__button-label"},e.optionsDict[e.currentValue].label),n.createElement(r,{alt:"",className:"u-l-fr",group:"web",name:"arrow-down-gray"})),o=e.valuesList.map(function(t){var o=n.createElement("span",null);return t===e.currentValue&&(o=n.createElement(r,{alt:"",group:"web",name:"check_gray"})),n.createElement(s.BubbleMenuItem,{checked:t===e.currentValue,key:t,onClick:function(){return e.onValueSelected(t)}},n.createElement("div",{className:"sharing-settings-dropdown-item"},n.createElement("div",{className:"sharing-settings-dropdown-item__left-margin"},o),n.createElement("div",{className:"sharing-settings-dropdown-item__label"},n.createElement("div",{className:"sharing-settings-dropdown-item__title"},e.optionsDict[t].label),n.createElement("div",{className:"sharing-settings-dropdown-item__description u-font-meta"},e.optionsDict[t].description))))});return n.createElement(s.BubbleMenu,{targetButton:t,targetFixed:!0,position:e.openUp?s.BubbleMenu.POSITIONS.TOP_ALIGN_RIGHT:s.BubbleMenu.POSITIONS.BOTTOM_ALIGN_RIGHT,className:"sharing-settings-dropdown",items:o,shouldShowArrow:!1})}t.SettingDropdown=o}),define("modules/clean/sharing/sharing_settings_modal",["require","exports","tslib","external/classnames","external/react","external/underscore","modules/clean/datetime","modules/clean/em_string","modules/clean/previews/util","modules/clean/react/calendar","modules/clean/react_format","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/pass/store","modules/clean/react/tabs/tab_nav","modules/clean/react/tabs/tab_util","modules/clean/sharing/components/button_group","modules/clean/sharing/views/hover_close_button","modules/clean/sharing/constants","modules/clean/sharing/settings_modal_components","modules/clean/sharing/ui_util","modules/clean/previews/util","modules/constants/python","modules/core/i18n","modules/clean/sharing/api/types/metadata","modules/clean/sharing/sharing_settings_dropdown","modules/clean/sharing/sharing_settings_constants","modules/clean/sharing/sharing_settings_util"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,E,w,C,N,T){"use strict";var P=E.i18n_default_project("sharing")._,M=r.createElement,A=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleTogglePasswordPolicy=function(e){n.props.onOptionChange(N.PASSWORD_POLICY,{status:e}),n.setState({passwordInputDisabled:"on"===n.props.currentPolicy.get(N.PASSWORD_POLICY).status})},n.handleChangePasswordClick=function(){n.setState({passwordInputDisabled:!1}),n.props.onOptionChange(N.PASSWORD_POLICY,{status:"on",value:""})},n.state={passwordInputDisabled:!0},n}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=o.extend({},this.props);return t=o.extend(t,{currentTab:this.state.currentTab,onChangePasswordClick:this.handleChangePasswordClick,onTabSelected:function(t){e.setState({currentTab:t})},onTogglePasswordPolicy:this.handleTogglePasswordPolicy,passwordInputDisabled:this.state.passwordInputDisabled}),M(F,t)},t})(r.Component);t.SharingSettingsModal=A;var k=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDefaultProps=function(){return{hasDisplayableMembers:!1,hasNonOwnerMembers:!1}},t.prototype.render=function(){var e;return e=this.props.isLoading?r.createElement("div",{className:"sharing-settings-modal__loading-text"},P("Loading...")):r.createElement("div",{className:"sharing-settings-modal"},this.renderHeader(),this.renderTabs(),this.renderTabContent(),r.createElement("div",{className:"sharing-settings-modal__footer"},this.renderButtons())),r.createElement(u.Modal,{altAction:this.props.altAction,style:"bare"},e)},t.prototype.renderHeader=function(){var e,t={folder_name:i.em_snippet(this.props.folderName,y.SNIPPET_SIZES.FILENAME)};return e=P("Sharing settings for “%(folder_name)s”").format(t),r.createElement("div",{className:"sharing-settings-modal__header"},r.createElement("div",{className:"sharing-settings-modal__title-row"},r.createElement("div",{className:"u-l-fr"},r.createElement(g,{onClick:function(){return u.Modal.close()}})),r.createElement("div",{className:"u-l-b"},e)))},t.prototype.renderTabs=function(){return r.createElement(m,{tabs:this.getTabs(),onChange:this.props.onTabSelected,defaultSelectedIndex:0,variant:_.variants.UNDERLINE})},t.prototype.getTabs=function(){var e=this,t={value:N.FILE_SETTINGS,label:P("File settings")},n={value:N.FOLDER_SETTINGS,label:P("Folder settings")},s={value:N.LINK_SETTINGS,label:P("Link settings")},r=this.props.isFolder?[n]:[t];return!this.props.isTeamSharedFolder&&this.props.linkMetadata&&r.push(s),r.filter(function(t){return e.getTabInfo(t.value).policies.length>0})},t.prototype.getCurrentTab=function(){return this.props.currentTab||this.getTabs()[0].value},t.prototype.renderTabContent=function(){var e=this,t=this.getTabInfo(this.getCurrentTab()),n=r.createElement("div",null);return t.bannerContent&&(n=r.createElement("div",{className:"sharing-settings-modal__banner u-font-center"},t.bannerContent)),r.createElement("div",null,n,r.createElement("div",{className:"sharing-settings-modal__tab-content"},r.createElement("div",{className:"tab-content-header"},r.createElement("div",{className:"tab-content-header__title"},t.title),r.createElement("div",{className:"tab-content-header__description u-font-meta"},t.description)),r.createElement("div",null,t.policies.map(function(t){var n=e.getPolicyDict(t);return e.renderPolicy(t,n)}))))},t.prototype.getLinkSettingsBannerContent=function(){return this.props.linkMetadata.link_permissions.some(function(e){return e.allow})?this.props.linkMetadata.link_permissions.set_password.reason===w.VisibilityDisallowedReason.user_account_type?this.props.user.is_team?r.createElement("a",{href:"/team/upgrade",target:"_blank"},P("Upgrade to %(trademark_business)s to enable expiration and password settings").format({trademark_business:I.TRADEMARK_BUSINESS})):r.createElement("a",{href:"/upgrade?oqa=sfp",target:"_blank"},P("Upgrade to Dropbox %(trademark_plus)s to enable expiration and password settings.").format({trademark_plus:I.TRADEMARK_PLUS})):void 0:P("You don’t have permission to modify these link settings")},t.prototype.getFolderSettingsBannerContent=function(){if(!this.props.shouldHideHeader&&this.props.isFolder){var e=P("These settings will apply to all folders inside “%(folder_name)s”.").format({folder_name:this.props.folderName});if(this.props.isInContentManager)return e;if(this.props.showContentManagerBridge){var t=v.genContentManagerBridgeUri(this.props.isLimitedTeam,this.props.folderPath);return r.createElement("div",null,e,r.createElement("div",null,P("You can change these settings in the Admin Console.")+" ",r.createElement("a",{href:t.toString(),target:"_blank"},P("Open in new tab."))))}return this.isTeamFolderTree()?r.createElement("div",null,e,r.createElement("div",null,r.createElement("a",{href:"/team",target:"_blank"},P("To edit, ask your admin.")))):this.props.permissions.change_options.allow?void 0:P("You don’t have permission to change the settings on this folder.")}},t.prototype.isTeamFolderTree=function(){return this.props.isTeamSharedFolder||this.props.isFolderInsideTeamFolderTree},t.prototype.getMemberPolicyQuestion=function(){return P(this.isTeamFolderTree()?"Who can be added to folders?":"Who can be invited to this folder?")},t.prototype.getAclUpdatePolicyQuestion=function(){return P(this.isTeamFolderTree()?"Who can manage access to folders?":"Who can manage access to this folder?")},t.prototype.getDownloadsPolicyDescription=function(){return P(this.isTeamFolderTree()?"Lets people download the folders. People with edit access can always download.":this.props.isFolder?"Lets people download this folder. People with edit access can always download.":"Lets people download this file. People with edit access can always download.")},t.prototype.getPassPolicyDescription=function(){return P(this.props.isFolder?"Shows who viewed the files.":"Shows who viewed the file.")},t.prototype.getFolderSettingPolicies=function(){var e=[];return Boolean(this.props.ownerTeam)&&(e.push(N.MEMBER_POLICY),e.push(N.FOLDER_LINK_AUDIENCE_POLICY)),e.push(N.ACL_UPDATE_POLICY),this.canChangePolicy(N.DOWNLOAD_POLICY)&&e.push(N.DOWNLOAD_POLICY),y.PASS_CONTROL_AVAILABILITY.SHOW_FOLDER_SETTINGS&&e.push(N.PASS_POLICY),e},t.prototype.getLinkSettingPolicies=function(){return S.is_user_no_comment_enabled(this.props.user)?[N.AUDIENCE_POLICY,N.ACCESS_LEVEL_POLICY,N.EXPIRY_POLICY,N.PASSWORD_POLICY]:[N.AUDIENCE_POLICY,N.EXPIRY_POLICY,N.PASSWORD_POLICY]},t.prototype.getFileSettingPolicies=function(){var e=[];this.canChangePolicy(N.DOWNLOAD_POLICY)&&e.push(N.DOWNLOAD_POLICY);var t=h.getPassPermissions(this.props.contentId),n=l.is_pass_ga_receive_enabled(this.props.user)&&null!=t&&h.getPassPermissions(this.props.contentId).canReadPresence;return(l.is_pass_enabled(this.props.user)||n)&&e.push(N.PASS_POLICY),e},t.prototype.canChangePolicy=function(e){return this.props.getEffectivePolicyValue(e,this.props.policyUpdate)[1]},t.prototype.getMemberPolicyTeamLabel=function(){return P("Only people at %(team_name)s").format({team_name:i.em_snippet(this.props.ownerTeam.name,8)})},t.prototype.getAclUpdatePolicyEditorsDescription=function(){return this.props.ownerTeam?P("Anyone at %(team_name)s with edit access can add new members and change link settings.").format({team_name:i.em_snippet(this.props.ownerTeam.name,12)}):P("Anyone with edit access can add new members and change link settings.")},t.prototype.getPolicyDict=function(e){var t=this;switch(e){case N.MEMBER_POLICY:return{title:P("Members"),description:this.getMemberPolicyQuestion(),optionsDict:{team:{label:this.getMemberPolicyTeamLabel()},anyone:{label:P("Anyone")}},optionsList:["team","anyone"],type:N.DROPDOWN};case N.ACL_UPDATE_POLICY:return{title:P("Management"),description:this.getAclUpdatePolicyQuestion(),optionsDict:{owner:{label:P(this.isTeamFolderTree()?"Only Team Admins":"Only me"),description:P(this.isTeamFolderTree()?"Only Team Admins can add new members and change link settings.":"Only you (the owner) can add new members and change link settings.")},editors:{label:P("Anyone with edit access"),description:this.getAclUpdatePolicyEditorsDescription()}},optionsList:["owner","editors"],type:N.DROPDOWN};case N.DOWNLOAD_POLICY:return{title:P("Downloads"),description:this.getDownloadsPolicyDescription(),optionsDict:{allow:{label:P("On")},disallow:{label:P("Off")}},optionsList:["allow","disallow"],type:N.TOGGLE};case N.PASS_POLICY:return{title:P("Viewer info"),description:this.getPassPolicyDescription(),optionsDict:{enabled:{label:P("On")},disabled:{label:P("Off")}},optionsList:["enabled","disabled"],type:N.TOGGLE};case N.AUDIENCE_POLICY:return{title:P("Link access"),description:P("Who can open the shared link?"),optionsDict:T.getAudienceOptionsDict(this.props.isFolder,this.props.ownerTeam&&this.props.ownerTeam.name,this.props.hasNonOwnerMembers,this.props.hasDisplayableMembers),optionsList:this.props.linkMetadata.audience_options.valueSeq().toArray(),type:N.DROPDOWN,extras:function(e){return t.renderAudiencePolicyExtras(e)}};case N.ACCESS_LEVEL_POLICY:return{title:P("Link permission"),description:P("What can users with links do?"),optionsDict:{viewer:{label:P("Can comment"),description:P("Lets them view and comment, but not edit.")},viewer_no_comment:{label:P("Can view"),description:P("Lets them view only. They can’t see comments.")}},optionsList:["viewer","viewer_no_comment"],type:N.DROPDOWN};case N.FOLDER_LINK_AUDIENCE_POLICY:if(!this.props.ownerTeam)throw new Error("Policy only valid for teams");return{title:P("Link restrictions"),description:P("Limits who can access this folder via a link."),optionsDict:{anyone:{label:P("No restrictions"),description:P("Show all access options for links.")},team:{label:P("Team and invite-only"),description:P("Show “Only people at %(team_name)s” and “Only                               invited members.”").format({team_name:i.em_snippet(this.props.ownerTeam.name,12)})},members:{label:P("Invite-only"),description:P("Show “Only invited members” only.")}},optionsList:["anyone","team","members"],type:N.DROPDOWN};case N.PASSWORD_POLICY:return{title:P("Password protection"),description:P("Add a password to the shared link"),optionsDict:{on:{label:P("On")},off:{label:P("Off")}},optionsList:["on","off"],type:N.PASSWORD_INPUT};case N.EXPIRY_POLICY:return{title:P("Expiration"),description:P("Disables the shared link on a specific date"),optionsDict:{on:{label:P("On")},off:{label:P("Off")}},optionsList:["on","off"],type:N.EXPIRY_INPUT};default:throw new Error("Policy name not found")}},t.prototype.getFolderSettingsDescription=function(){return P(this.isTeamFolderTree()?"Only team admins can change these settings":this.canChangePolicy(N.ACL_UPDATE_POLICY)?"Only you (the owner) can change these settings":"Only the owner can change these settings")},t.prototype.getLinkSettingsDescription=function(){return P("owner"===this.props.currentPolicy.get(N.ACL_UPDATE_POLICY)?this.isTeamFolderTree()?"Only team admins can change these settings":this.canChangePolicy(N.AUDIENCE_POLICY)?"Only you (the owner) can change these settings":"Only the owner can change these settings":"Only editors can change these settings")},t.prototype.getTabInfo=function(e){switch(e){case N.FILE_SETTINGS:return{title:P("File settings"),bannerContent:void 0,description:"",policies:this.getFileSettingPolicies()};case N.FOLDER_SETTINGS:return{title:P("Folder settings"),bannerContent:this.getFolderSettingsBannerContent(),description:this.getFolderSettingsDescription(),policies:this.getFolderSettingPolicies()};case N.LINK_SETTINGS:return{title:P("Link settings"),bannerContent:this.getLinkSettingsBannerContent(),description:this.getLinkSettingsDescription(),policies:this.getLinkSettingPolicies()};default:throw new Error("tabName not found")}},t.prototype.renderPolicy=function(e,t){var n,o,a=this,i=t.title,l=t.description,d=t.optionsDict,c=t.optionsList,p=t.type,u=t.extras,h=void 0===u?null:u;g=this.props.getEffectivePolicyValue(e,this.props.policyUpdate),n=g[0],o=g[1];var m;if(p===N.DROPDOWN)m=r.createElement(C.SettingDropdown,{currentValue:n,valuesList:c,optionsDict:d,onValueSelected:function(t){return a.props.onOptionChange(e,t)}});else if(p===N.TOGGLE)m=r.createElement(f.ButtonGroup,{options:this.getButtonGroupOptions(c,d),value:n,onSelectValue:function(t){return a.props.onOptionChange(e,t)}});else if(p===N.PASSWORD_INPUT)m=this.renderPasswordInput(e,n,d,c);else{if(p!==N.EXPIRY_INPUT)throw new Error("Selector type not found");m=this.renderExpiryInput(e,n,d,c)}var _=r.createElement("div",null);return h&&(_=h(n)),r.createElement("div",{className:s({policy:!0,"policy--no-permissions":!o})},r.createElement("div",{className:"policy__left"},r.createElement("div",{className:"policy__title"},i),r.createElement("div",{className:"policy__description u-font-meta"},l)),r.createElement("div",{className:"policy__selector"},m),r.createElement("div",{className:"policy__extras"},_));var g},t.prototype.renderAudiencePolicyExtras=function(e){var t=this.props.linkMetadata,n=r.createElement("div",null);if(t.audience_restricting_shared_folder&&t.audience_restricting_shared_folder.audience===e){var s=void 0,o=t.audience_restricting_shared_folder.name;s=1===t.audience_options.size?c.reactFormat(P("This setting is applied via a parent folder.              To change access, go to <strong>%(folder_name)s</strong> link settings."),{folder_name:o,strong:r.createElement("strong",null)}):c.reactFormat(P("This setting is limited via a parent folder.              To see more options, go to <strong>%(folder_name)s</strong> link settings."),{folder_name:o,strong:r.createElement("strong",null)}),n=r.createElement("div",{className:"policy__graybox"},s)}else this.props.isFolder&&e!==w.LinkAudience.members&&(n=r.createElement("div",{className:"policy__audience-extras"},P("Applies to all items in this folder")));return n},t.prototype.renderPasswordInput=function(e,t,n,s){var o=this,a=t,i=r.createElement("div",null);if("on"===a.status){var l=r.createElement("div",null);this.props.passwordInputDisabled&&this.props.linkMetadata.link_permissions.set_password.allow&&(l=r.createElement("button",{className:"password-input__change-button button-as-link",onClick:this.props.onChangePasswordClick},"Change")),i=r.createElement("div",{className:"password-input u-pad-top-s"},r.createElement("label",{htmlFor:"password-input"},"Password:"),r.createElement("br",null),r.createElement("input",{className:"c-input password-input__input",disabled:this.props.passwordInputDisabled,onChange:function(t){o.props.onOptionChange(e,{status:"on",value:t.target.value})},id:"password-input",placeholder:P("Enter a new password"),value:this.props.passwordInputDisabled?123456:a.value||"",type:"password"}),l)}return r.createElement("div",null,r.createElement(f.ButtonGroup,{options:this.getButtonGroupOptions(s,n),value:a.status,onSelectValue:this.props.onTogglePasswordPolicy}),i)},t.prototype.renderExpiryInput=function(e,t,n,s){var o=this,i=t,l=r.createElement("div",null),c=a.daysAfterToday(30);return"on"===i.status&&(l=r.createElement("div",{className:"u-pad-top-s"},r.createElement("div",null,P("Link deactivates on:")),r.createElement(d.Calendar,{alignAtLeft:!1,disabled:!this.props.linkMetadata.link_permissions.set_expiry.allow,firstDay:a.daysAfterToday(1),initDate:i.value?new Date(i.value):c,lastDay:a.daysAfterToday(365),onDateChange:function(t){return o.props.onOptionChange(e,{status:"on",value:t})}}))),r.createElement("div",null,r.createElement(f.ButtonGroup,{options:this.getButtonGroupOptions(s,n),value:i.status,onSelectValue:function(t){o.props.onOptionChange(e,{status:t,value:i.value||c})}}),l)},t.prototype.getButtonGroupOptions=function(e,t){return e.map(function(e){return{value:e,label:t[e].label}})},t.prototype.allowSaveSettings=function(){return!(!this.props.policyUpdate||0===o.keys(this.props.policyUpdate).length)&&!(this.props.policyUpdate.password&&"on"===this.props.policyUpdate.password.status&&!this.props.passwordInputDisabled&&(!this.props.policyUpdate.password.value||""===this.props.policyUpdate.password.value))},t.prototype.renderButtons=function(){var e;if(this.props.permissions.unshare.allow&&(this.props.isSharedFolder||!this.props.isFolder)){var t=void 0;t=P(this.props.isFolder?this.props.isFolderInsideTeamFolderTree?"Reset membership":"Unshare folder":"Unshare file"),e=r.createElement("div",{className:"u-l-fl"},r.createElement("button",{className:"button-as-link",style:{lineHeight:"32px"},onClick:this.props.onUnshare},t))}
return r.createElement("div",{className:"clearfix sharing-settings-modal__buttons"},e,r.createElement(b.SettingsModalButtons,{disableSave:!this.allowSaveSettings(),isAccepting:this.props.isSubmitting,onAccept:this.props.onSaveSettings,onDismiss:this.props.onDismiss}))},t})(r.Component);t.SharingSettingsModalContentsView=k;var F=p(k,["/static/css/sharing/share_modal-vflqkhEAI.css"])}),define("modules/clean/sharing/sharing_settings_util",["require","exports","modules/clean/em_string","modules/clean/sharing/sharing_settings_constants","modules/core/i18n"],function(e,t,n,s,r){"use strict";var o=r.i18n_default_project("sharing")._;t.canChangePolicy=function(e,t,n,r,o,a){switch(e){case s.AUDIENCE_POLICY:return r&&r.link_permissions.change_audience.allow&&r.audience_options.size>1;case s.PASSWORD_POLICY:return r&&"members"!==n.get(s.AUDIENCE_POLICY)&&(r.link_permissions.set_password.allow||r.link_permissions.remove_password.allow&&"off"!==t.get(s.PASSWORD_POLICY).status);case s.EXPIRY_POLICY:return r&&"members"!==n.get(s.AUDIENCE_POLICY)&&(r.link_permissions.set_expiry.allow||r.link_permissions.remove_expiry.allow&&"off"!==t.get(s.EXPIRY_POLICY).status);case s.DOWNLOAD_POLICY:return!(!o||a)&&("allow"===t.get(s.DOWNLOAD_POLICY)?o.set_download_policy&&o.set_download_policy.allow:o.remove_download_policy&&o.remove_download_policy.allow);case s.PASS_POLICY:return!(!o||a)&&("enabled"===t.get(s.PASS_POLICY)?o.disable_pass&&o.disable_pass.allow:o.enable_pass&&o.enable_pass.allow);default:throw new Error("Link policy not found")}},t.isCommonSharingSettingsPolicy=function(e){return[s.AUDIENCE_POLICY,s.DOWNLOAD_POLICY,s.EXPIRY_POLICY,s.PASS_POLICY,s.PASSWORD_POLICY].indexOf(e)!==-1},t.getAudienceOptionsDict=function(e,t,s,r){var a=r&&!s;return{public:{label:o("Anyone with the link"),description:o(e?"Anyone who has the link can access this folder.":"Anyone who has the link can access this file.")},team:{label:o("Only people at %(team_name)s").format({team_name:n.em_snippet(t||"",8)}),description:o("Only people in your company can use the link.")},members:{label:o(a?"Only you":"Only invited members"),description:o(a?"Only you can use the link":"Only invited members can use the link.")}}}}),function(){define("modules/clean/sharing/strings",["modules/clean/sharing/constants","modules/core/i18n"],function(e,t){var n,s,r,o,a,i,l,d,c,p,u,h,m,_,f;return n=e.ACCESS_LEVEL,o=e.MEMBER_ACTION,c=t.i18n_default_project("sharing")._,p={},p[""+n.OWNER]=c("Owner"),p[""+n.WRITER]=c("Can edit"),p[""+n.READER]=c("Can view"),p[""+n.READER_NO_COMMENT]=c("View-only"),s=p,u={},u[""+n.OWNER]=c("Owner"),u[""+n.WRITER]=c("Can edit"),u[""+n.READER]=c("Can comment"),u[""+n.READER_NO_COMMENT]=c("Can view"),r=u,h={},h[""+o.MAKE_EDITOR]=c("People can edit, delete, comment, and add the file to their Dropbox"),h[""+o.MAKE_VIEWER]=c("People can view, download, and comment"),h[""+o.MAKE_VIEWER_NO_COMMENT]=c("People can only view and download the files"),l=h,m={},m[""+o.MAKE_EDITOR]=c("People can edit, delete, comment, and add the files to their Dropbox"),m[""+o.MAKE_VIEWER]=c("People can view, download, and comment"),m[""+o.MAKE_VIEWER_NO_COMMENT]=c("People can only view and download the file"),a=m,_={},_[""+o.MAKE_EDITOR]=c("Lets them view, comment, and edit."),_[""+o.MAKE_VIEWER]=c("Lets them view and comment, but not edit."),_[""+o.MAKE_VIEWER_NO_COMMENT]=c("Lets them view only. They can’t see comments."),d=_,f={},f[""+o.MAKE_EDITOR]=c("Lets them view, comment, and edit."),f[""+o.MAKE_VIEWER]=c("Lets them view and comment, but not edit."),f[""+o.MAKE_VIEWER_NO_COMMENT]=c("Lets them view only. They can’t see comments."),i=f,{ACCESS_NAME:s,ACCESS_NAME_NO_COMMENT:r,MEMBER_ACTION_FOLDER:l,MEMBER_ACTION_FILE:a,MEMBER_ACTION_FOLDER_NO_COMMENT:d,MEMBER_ACTION_FILE_NO_COMMENT:i}})}.call(this),function(){define("modules/clean/sharing/views/comments_help",["external/classnames","external/react","modules/clean/react/css","modules/clean/react/image","modules/clean/sharing/views/hover_close_button","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,s,r,o,a){var i,l,d,c,p;return p=o.static_url,l=a._,d=t.createElement,c=t.DOM,i=t.createClass({displayName:"ShareModalCommentsHelp",mixins:[t.addons.PureRenderMixin],propTypes:{onClose:t.PropTypes.func.isRequired,onButtonClick:t.PropTypes.func.isRequired,isFeedbackRequest:t.PropTypes.bool},renderText:function(){return this.props.isFeedbackRequest?[c.h1({key:"heading"},l("Get feedback on your work")),c.p({key:"content"},l("This will ask recipients to leave comments on your file and post your message as a comment."))]:c.p({},l("New! You can now post your message as a comment on the file. Anyone who views this file can see this comment."))},render:function(){return c.div({className:e(["bubble-dropdown","right-bottom","u-font-center","u-pad-m","u-l-b","comments-help-dialog"])},c.div({className:"close-button u-font-right"},d(r,{onClick:this.props.onClose})),d(s,{src:p("/static/images/sharing/sharing-invite-users-vflfTH_fj.png"),srcHiRes:p("/static/images/sharing/sharing-invite-users@2x-vflgGHzXi.png")}),this.renderText(),c.button({className:"c-btn c-btn--primary",onClick:this.props.onButtonClick},l("Try it out")),c.div({className:"bubble-arrow-border"}),c.div({className:"bubble-arrow"}))}}),i=n(i,["/static/css/components/bubble_dropdown-vflTPbDJ3.css"])})}.call(this),define("modules/clean/sharing/views/exp_share_link_upsell",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/image","modules/core/i18n","modules/clean/react_format","modules/clean/static_urls","modules/constants/python"],function(e,t,n,s,r,o,a,i,l,d){"use strict";var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return s.createElement("div",{className:"share-link-upgrade__content"},s.createElement(o,{className:"unified-share-modal__illo",src:l.static_url("/static/images/sharing/sharing-invite-users-vflfTH_fj.png"),srcHiRes:l.static_url("/static/images/sharing/sharing-invite-users@2x-vflgGHzXi.png")}),s.createElement("div",{className:"share-link-upgrade__footer"},s.createElement("div",{className:"share-link-upgrade__footer-content"},s.createElement("p",{className:"u-mar-top-s share-link-upgrade__copy"},i.reactFormat(a._("Get %(trademark_plus)s to add more shared content to your Dropbox."),{trademark_plus:d.TRADEMARK_PLUS})),s.createElement("a",{className:"c-btn c-btn--primary",href:"/pro/out-of-space?oqa=sf_sloq"},a._("Upgrade")))))},t})(s.Component);t.ExpShareLinkUpsellV1=r(c,["/static/css/sharing/exp_oq_shared_link_upsellV1-vflBUzAf2.css"]),t.ExpShareLinkUpsellV2=r(c,["/static/css/sharing/exp_oq_shared_link_upsellV2-vflFsqt8O.css"])}),define("modules/clean/sharing/views/inherited_members",["require","exports","tslib","external/classnames","external/react","modules/clean/em_string","modules/clean/filepath","modules/clean/react/sprite","modules/clean/sharing/constants","modules/core/i18n"],function(e,t,n,s,r,o,a,i,l,d){"use strict";var c=r.createElement,p=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={areMembersExpanded:!1},n}return n.__extends(t,e),t.prototype.onToggleShowMemberList=function(){this.setState({areMembersExpanded:!this.state.areMembersExpanded})},t.prototype.renderMembersList=function(){return this.state.areMembersExpanded?r.createElement("div",null,r.createElement("div",{className:"u-mar-top-xs u-mar-horizontal-xs u-pad-top-xs inherited-member-list__divider"}),r.createElement("div",null,r.createElement("ul",{className:"u-pad-horizontal-s u-pad-vertical-xs inherited-member-list__member"},this.props.children))):void 0},t.prototype.render=function(){var e,t=this,n=a.filename(a.parent_dir(this.props.contentInfo.displayPath()));e="Dropbox"===n?d._("Members of %(team_name)s shared workspace").format({team_name:o.em_snippet(this.props.teamName,l.SNIPPET_SIZES.DISPLAY_NAME)}):d._("Members of “%(folder_name)s” folder").format({folder_name:o.em_snippet(n,l.SNIPPET_SIZES.FILENAME)});var p=this.props.members.length,u=d.ungettext("%(members_count)s member","%(members_count)s members",p).format({members_count:p}),h=s([{"u-mar-bottom-xs":!0,"inherited-member-list__outer-expanded":this.state.areMembersExpanded,"inherited-member-list__outer-closed":!this.state.areMembersExpanded}]),m=s([{"inherited-member-list__inner":!this.state.areMembersExpanded}]);return r.createElement("div",{className:h},r.createElement("div",{className:m},r.createElement("div",{className:"o-flag",onClick:function(){return t.onToggleShowMemberList()}},r.createElement("a",{href:"#",className:"u-pad-horizontal-xxs o-flag__fix inherited-member-list__triangle",onClick:function(){return t.onToggleShowMemberList()}},c(i,{alt:d._("Toggle whether inherited members are displayed or hidden"),group:"web",name:this.state.areMembersExpanded?"triangle_open_1x":"triangle_closed_1x"})),r.createElement("div",{className:"o-flag__flex u-pad-vertical-xs u-pad-right-s"},r.createElement("div",{className:"o-flag"},r.createElement("div",{className:"o-flag__fix"},c(i,{alt:"",className:"unified-share-modal__title-icon",group:"web",name:"folder_user_32"})),r.createElement("div",{className:"o-flag__flex u-pad-left-s"},r.createElement("div",{className:"u-font-strong"},e),r.createElement("div",{className:"u-font-meta"},u)),r.createElement("div",{className:"o-flag__fix u-pad-right-xxs"},d._("Remove",{comment:"Shown on button that can be clicked to remove access to subfolder"}))))),r.createElement("div",null,this.renderMembersList())))},t})(r.Component);t.InheritedMembers=p}),function(){define("modules/clean/sharing/views/member_list",["external/immutable","external/react","external/underscore","modules/clean/react/modal","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api/types/metadata","modules/clean/sharing/content_info","modules/clean/sharing/views/inherited_members","modules/clean/sharing/views/member_list_item","modules/clean/sharing/views/modal_viewers_line","modules/clean/sharing/views/viewer_info","modules/clean/sharing/views/viewer_list_modal","modules/clean/sharing/ui_util","modules/clean/user","modules/clean/viewer","modules/core/i18n"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_){var f,g,y,b,v,S,I,E,w,C,N,T,P,M;return b=s.Modal,I=o.SharingMembership,f=a.ContentInfo,y=i.InheritedMembers,S=l.SharingMemberListItem,v=d.ModalViewersLine,E=c.ViewerInfo,w=p.ViewerListModal,g=u.GoldenGate,P=u.logTiburonEvent,M=u.makeMemberSortCmp,C=_.i18n_default_project("sharing")._,N=t.createElement,T=t.DOM,t.createClass({displayName:"SharingMemberList",propTypes:{actionHandler:t.PropTypes.instanceOf(r),areMembersFullyLoaded:t.PropTypes.bool,canInviteMembers:t.PropTypes.bool,canMakeViewerNoComment:t.PropTypes.bool,canRelinquishMembership:t.PropTypes.bool,canUpdateConfidentiality:t.PropTypes.bool,contentInfo:t.PropTypes.instanceOf(f).isRequired,disabled:t.PropTypes.bool,groupSeenStateInfo:t.PropTypes.object,membership:t.PropTypes.instanceOf(I).isRequired,onSetConfidentialClick:t.PropTypes.func,pendingMemberAction:t.PropTypes.instanceOf(e.Set).isRequired,presentAccountIds:t.PropTypes.instanceOf(e.Set),shouldShowPassUI:t.PropTypes.bool,teamName:t.PropTypes.string,user:t.PropTypes.instanceOf(h).isRequired},getDefaultProps:function(){return{disabled:!1,groupSeenStateInfo:{},presentAccountIds:new e.Set}},render:function(){var e,t,n,s,r,o;return n=M(this.props.user,this.props.presentAccountIds,this.props.shouldShowPassUI),s=this._membersByInheritance(),e=null!=(r=s.get(!1))?r.sort(n):void 0,t=null!=(o=s.get(!0))?o.sort(n):void 0,T.div({className:"sharing-member-list"},g.hasNewInheritedMembersUI(this.props.user.id)?this._renderNewInheritedUI(e,t):this._renderOldInheritedUI(e,t),this.props.areMembersFullyLoaded?void 0:T.div({className:"sharing-member-list__loading c-loader u-mar-horizontal-auto u-l-b"},C("Loading more members...")))},_renderNewInheritedUI:function(e,t){return T.ul({className:"o-list-ui u-trim-margin u-pad-horizontal-xs"},(null!=t?t.count():void 0)>0?N(y,{contentInfo:this.props.contentInfo,members:t,teamName:this.props.teamName},t.map(this._renderMembersListItem)):void 0,(null!=e?e.count():void 0)>0?T.div({className:"u-pad-horizontal-s"},e.map(this._renderMembersListItem).toArray()):void 0)},_renderOldInheritedUI:function(e,t){return[(null!=e?e.count():void 0)>0?T.ul({className:"o-list-ui u-trim-margin u-pad-horizontal-m"},e.map(this._renderMembersListItem).toArray()):void 0,(null!=t?t.count():void 0)>0?[T.h5({className:"sharing-member-list__inherited-separator u-pad-vertical-xs u-pad-horizontal-s u-font-meta u-font-strong",key:"separator"},[C("Can access via parent folders"),this.props.canUpdateConfidentiality?T.button({className:"button-as-link u-l-fr",onClick:this.props.onSetConfidentialClick},C("Manage access")):void 0]),T.ul({className:"o-list-ui u-trim-margin u-pad-horizontal-m u-pad-top-xs",key:"inherited-members"},t.map(this._renderMembersListItem).toArray())]:void 0]},_renderMembersListItem:function(e){var t,n;return n=e.memberKey(),t=e.memberId()in this.props.groupSeenStateInfo?this._renderGroupViewersLine(e):null,N(S,{actionHandler:this.props.actionHandler,canInviteMembers:this.props.canInviteMembers,canMakeViewerNoComment:this.props.canMakeViewerNoComment,canRelinquishMembership:this.props.canRelinquishMembership,contentInfo:this.props.contentInfo,disabled:this.props.disabled,groupViewersLine:t,hasGroupSeenStateInfo:null!=t,isMemberActionPending:this.props.pendingMemberAction.has(n),isPresent:this.props.shouldShowPassUI&&this._isMemberCurrentlyViewing(e),key:n,member:e,user:this.props.user})},_isMemberCurrentlyViewing:function(e){return!this._memberIsAssumed(e)&&this.props.presentAccountIds.has(e.account_id)},_memberIsAssumed:function(e){return e.account_id===this.props.user.account_id&&m.get_viewer().is_assume_user_session},_membersByInheritance:function(){return null==this.props.membership?e.Map():this.props.membership.groups.valueSeq().concat(this.props.membership.invitees.valueSeq()).concat(this.props.membership.users.valueSeq()).groupBy((function(e){return function(t){return e._shouldSortByInherited()&&t.is_inherited}})(this))},_shouldSortByInherited:function(){return g.canSetFolderConfidential(this.props.user.id)||!g.canActOnInheritedMembers(this.props.user.id)},_renderGroupViewersLine:function(e){var t,n;return t=this.props.groupSeenStateInfo[e.memberId()],n=t.map(function(e){return new E(e)}).filter((function(e){return function(t){return null!=t.time_last_seen||e.props.presentAccountIds.has(t.account_id)}})(this)),0===n.length?null:T.span({className:"sharing-member-info__group-seen-state",onClick:(function(n){return function(){return b.showInstance(N(w,{contentInfo:n.props.contentInfo,groupName:e.displayName(),onCancel:n.props.actionHandler.openShareModal,presentAccountIds:n.props.presentAccountIds,seenStateInfo:t,user:n.props.user})),P(n.props.contentInfo,n.props.user.id,"OPEN_GROUP_VIEWER_LIST_MODAL",{group_id:e.memberId()})}})(this)},N(v,{currentUserAccountId:this.props.user.account_id,presentAccountIds:this.props.presentAccountIds,viewers:n}))}})})}.call(this),define("modules/clean/sharing/views/member_list_item",["require","exports","tslib","external/classnames","external/react","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/size","modules/clean/datetime","modules/clean/em_string","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/views/sharing_bubble_menu","modules/clean/sharing/views/viewer_info","modules/clean/static_urls","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f){"use strict";var g=_.i18n_default_project("sharing"),y=g._,b=g.ungettext,v={FIRST_LINE:"FIRST_LINE",SECOND_LINE:"SECOND_LINE"},S=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.shouldLinkMemberName=function(e){return"group"===e&&this.props.member instanceof c.GroupMembershipInfo&&(!!this.props.member.same_team&&(!!this.props.user.is_team_admin||!!this.props.member.is_member&&this.props.member.group_management_type!==c.GroupManagementType.system_managed))},t.prototype.renderAvatar=function(e,t){var n,s=this.props.member.displayName()||"";this.props.member instanceof h.ViewerInfo||(n=this.props.member.initials),n=n||f.getInitials(s);var l="CIRCLE";return"group"===t&&(l="SQUARE"),r.createElement("div",{className:"o-flag__fix"},r.createElement(o,{dimension:i.AVATAR_DIMENSION_BY_SIZE.MEDIUM,photoUrl:e,shape:l,defaultAvatar:r.createElement(a,{dimension:i.AVATAR_DIMENSION_BY_SIZE.MEDIUM,shape:l,initials:n,name:s})}))},t.prototype.renderNameTitleAndText=function(e,t,n,s){if(!e)return null;if(this.shouldLinkMemberName(t)&&this.props.member instanceof c.GroupMembershipInfo){var o="/team#groups/%(id)s".format({id:this.props.member.group_id});return r.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"sharing-member-info__group-name-link sharing-member-info__display-name",title:n},s)}return r.createElement("span",{className:"sharing-member-info__display-name",title:n},s)},t.prototype.renderDisabledMessage=function(e){return e?[r.createElement("span",{className:"u-font-meta dot"},"·"),r.createElement("span",{className:"u-font-danger"}," ",e)]:null},t.prototype.renderSeenStateMessage=function(e){return e?[r.createElement("span",{className:"u-font-meta dot"},"·"),r.createElement("span",{className:"u-font-meta sharing-member-info__last-seen-text"},e)]:null},t.prototype.renderGroupCountMessage=function(e,t){return e===v.FIRST_LINE?[r.createElement("span",{className:"u-font-meta dot"},"·"),r.createElement("span",{className:"u-font-meta sharing-member-info__group-count-text"},t)]:null},t.prototype.renderOffTeamMessage=function(e){return e?[r.createElement("span",{className:"u-font-meta dot"},"·"),r.createElement("span",{className:"u-font-meta"},e)]:null},t.prototype.renderDisplayName=function(e,t,n,o,a){var i=this.props.member.displayName(),c="";this.props.isPresent?c=y("Currently viewing"):n&&(c=y("Viewed %(time_str)s").format({time_str:l.ago(n,!1)}));var u="";t&&t.disabled&&(u=y("Deleted"));var h="";u||c||!this.props.user.is_team||this.props.member.same_team||(h=y("Outside of your Dropbox team"));var m=0,_=0,f=0,g=0;if(i){c&&(m=new d("  ·  %s".format(c)).length),u&&(_=new d("  ·  %s".format(u)).length),a===v.FIRST_LINE&&(f=new d("  ·  %s".format(o)).length),h&&(g=new d("  ·  %s".format(h)).length);var b=p.SNIPPET_SIZES.DISPLAY_NAME-m-_-f-g,S=d.em_snippet(i,b),I="";S!==i&&(I=i);var E=s({"u-font-meta":this.props.isMemberActionPending,"u-font-strong":!0,"u-ellip":!0});return r.createElement("div",{className:E},this.renderNameTitleAndText(i,e,I,S),this.renderDisabledMessage(u),this.renderSeenStateMessage(c),this.renderGroupCountMessage(a,o),this.renderOffTeamMessage(h))}},t.prototype.renderMemberDetails=function(e,t,n,s){var o;return"group"===e?this.props.groupViewersLine?o=this.props.groupViewersLine:n===v.SECOND_LINE&&(o=t):s&&s.email&&s.email_verified&&(o=d.em_snippet(s.email,p.SNIPPET_SIZES.EMAIL)),r.createElement("div",{className:"u-font-meta u-ellip sharing-member-info__details"},o)},t.prototype.renderSharingBubbleMenu=function(){var e,t=this;if(this.props.isMemberActionPending)e=r.createElement("img",{src:m.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:y("Changing access")});else if(this.props.isViewOnly||this.props.member instanceof h.ViewerInfo)e=r.createElement("span",null);else{var n=this.props.member.permissions.get("make_viewer_no_comment"),s=n&&n.allow&&this.props.canMakeViewerNoComment,o=this.props.member.permissions.set("make_viewer_no_comment",new c.PermissionSetting({allow:s})),a=this.props.member.memberId()===this.props.user.account_id&&this.props.canRelinquishMembership,i=function(e){if(!(t.props.member instanceof h.ViewerInfo))return t.props.actionHandler&&t.props.actionHandler.handleMemberAccessChange(t.props.member,e)};e=r.createElement(u.SharingBubbleMenu,{allowRelinquishMembership:a,canInviteMembers:this.props.canInviteMembers,canMakeViewerNoComment:s,contentInfo:this.props.contentInfo,currentAccess:this.props.member.access_type,disabled:this.props.disabled,isInherited:this.props.member.is_inherited,memberPermissions:o,onAccessChange:i,pendingAccessChange:this.props.pendingAccessChange})}return r.createElement("div",{className:"o-flag__fix"},e)},t.prototype.render=function(){var e,t=null,n="invitee",o=null;if(this.props.member instanceof c.UserMembershipInfo){if(t=this.props.member.account,n="user",!t)return null;o=t.profile_photo_url||null,e=this.props.member.time_last_seen}else this.props.member instanceof c.GroupMembershipInfo?(n="group","team"===this.props.member.group_type&&(o=m.static_url("/static/images/icons/team_24@2x-vflR8kGKs.png"))):this.props.member instanceof h.ViewerInfo&&(t={email:this.props.member.email,email_verified:!!this.props.member.email},n="user",o=this.props.member.photo_circle_url,e=this.props.member.time_last_seen);var a="";"group"===n&&this.props.member instanceof c.GroupMembershipInfo&&this.props.member.member_count&&(a=b("%(member_num)s member","%(member_num)s members",this.props.member.member_count).format({member_num:this.props.member.member_count}));var i=null;a&&(i=this.props.groupViewersLine?v.FIRST_LINE:v.SECOND_LINE);var l=s({"sharing-member-info":!0,"o-flag":!0,"u-pad-right-m":!this.props.isViewOnly});return r.createElement("li",{className:"sharing-member-list__item o-flag"},r.createElement("div",{className:"o-flag__flex"},r.createElement("div",{className:l},this.renderAvatar(o,n),r.createElement("div",{className:"sharing-member-info__contact o-flag__flex"},this.renderDisplayName(n,t,e,a,i),this.renderMemberDetails(n,a,i,t)))),this.renderSharingBubbleMenu())},t})(r.Component);S.displayName="SharingMemberListItem",S.defaultProps={canInviteMembers:!1,canMakeViewerNoComment:!1,canRelinquishMembership:!1,disabled:!1,isPresent:!1,isViewOnly:!1,groupViewersLine:void 0},t.SharingMemberListItem=S}),function(){define("modules/clean/sharing/views/modal_content",["external/classnames","external/immutable","external/react","external/react-dom","external/underscore","modules/clean/contacts/tokenizer","modules/clean/contacts/types","modules/clean/contacts/util","modules/clean/em_string","modules/clean/growth/experiments/shared_folder_paywall_view","modules/clean/react/css","modules/clean/react/image","modules/clean/react/pass/constants","modules/clean/react/sprite","modules/clean/react/bubble","modules/clean/react/tooltip","modules/clean/react_format","modules/clean/sharing/actions/share_modal","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/content_info","modules/clean/sharing/ui_util","modules/clean/sharing/views/constants","modules/clean/sharing/views/comments_help","modules/clean/sharing/views/exp_share_link_upsell","modules/clean/sharing/views/hover_close_button","modules/clean/sharing/views/member_list","modules/clean/sharing/views/modal_link_info","modules/clean/sharing/views/sharing_bubble_menu","modules/clean/static_urls","modules/clean/user","modules/core/i18n"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g,y,b,v,S,I,E,w,C,N,T,P,M,A,k){var F,x,L,R,O,D,U,B,q,H,V,G,W,K,Y,z,j,Q,X,J,Z,$,ee,te,ne,se,re,oe,ae,ie,le,de,ce,pe,ue,he,me,_e,fe,ge,ye;return U=o.ContactsTokenizer,u.PASS_FETCHING_STATUS,pe=u.fetchingStatusIsSuccessful,ce=u.fetchingStatusIsComplete,re=_.Tooltip,oe=_.TooltipPosition,he=f.reactFormat,V=y.FolderPolicy,K=y.LinkMetadata,j=y.MemberCounts,Q=y.MemberPermissions,J=y.PermissionSetting,ee=y.SharedContentLinkMetadata,ne=y.SharingMembership,F=b.ACCESS_VALUES,b.COMMENTING,Z=b.SNIPPET_SIZES,se=b.TRUELINK,B=v.ContentInfo,R=S.CONTACT_ERROR_LEVEL,ue=S.genContentManagerBridgeUri,G=S.GoldenGate,_e=S.shouldEnforceMemberLimits,ye=S.validateContact,Y=I.MODES,z=I.MODE_VALUES,x=I.BANNERS,L=I.BANNER_VALUES,O=I.CONTENT_NAME_MESSAGE_LEVELS,D=I.CONTENT_NAME_MESSAGE_LEVEL_VALUES,W=I.LINK_ONLY_REASON,q=w.ExpShareLinkUpsellV1,H=w.ExpShareLinkUpsellV2,X=T.ModalLinkInfo,te=P.SharingBubbleMenu,fe=M.static_url,le=n.createElement,de=n.DOM,me=k.i18n_default_project("sharing"),ae=me._,ge=me.ungettext,ie=n.createClass({displayName:"ShareModalContent",statics:{MODES:Y},propTypes:{actionHandler:n.PropTypes.instanceOf(g).isRequired,areMembersFullyLoaded:n.PropTypes.bool,banner:n.PropTypes.oneOf(L),canInviteEditor:n.PropTypes.bool.isRequired,canInviteViewer:n.PropTypes.bool.isRequired,canInviteViewerNoComment:n.PropTypes.bool.isRequired,canMakeViewerNoComment:n.PropTypes.bool.isRequired,canRelinquishMembership:n.PropTypes.bool,canShareLink:n.PropTypes.bool.isRequired,canUpdateConfidentiality:n.PropTypes.bool,contactsError:n.PropTypes.shape({level:n.PropTypes.string,message:n.PropTypes.oneOfType([n.PropTypes.string,n.PropTypes.array])}),contentInfo:n.PropTypes.instanceOf(B).isRequired,contentNameMessage:n.PropTypes.string,contentNameMessageLevel:n.PropTypes.oneOf(D),displayContentNameTooltip:n.PropTypes.bool,displayContentNameBanner:n.PropTypes.bool,folderPolicy:n.PropTypes.instanceOf(V),groupSeenStateInfo:n.PropTypes.object,hasDisplayableMembers:n.PropTypes.bool.isRequired,hasNonOwnerMembers:n.PropTypes.bool.isRequired,headerId:n.PropTypes.string,icon:n.PropTypes.string,initialContentName:n.PropTypes.string,initialRecipientRawInput:n.PropTypes.string,initialRecipientTokens:n.PropTypes.array,isAddMessageAsCommentChecked:n.PropTypes.bool,isAddMessageAsCommentHelpShown:n.PropTypes.bool,isConfidentialFolder:n.PropTypes.bool,isContentNameFocused:n.PropTypes.bool,isFolderInsideTeamFolderTree:n.PropTypes.bool,isInContentManager:n.PropTypes.bool,isLimitedTeam:n.PropTypes.bool,isLinkMetadataLoaded:n.PropTypes.bool.isRequired,isMetadataLoaded:n.PropTypes.bool.isRequired,isPassEnabled:n.PropTypes.bool,isTeamSharedFolder:n.PropTypes.bool,isTokenizerEmpty:n.PropTypes.bool.isRequired,linkMetadata:n.PropTypes.oneOfType([n.PropTypes.instanceOf(K),n.PropTypes.instanceOf(ee)]),linkOnlyReason:n.PropTypes.oneOf(r.values(W)),linkSeenStateInfo:n.PropTypes.array,memberCounts:n.PropTypes.instanceOf(j),memberCountWithRecipients:n.PropTypes.number,members:n.PropTypes.instanceOf(ne),mode:n.PropTypes.oneOf(z),name:n.PropTypes.string,onSettingsClick:n.PropTypes.func,onLinkViewersClick:n.PropTypes.func,onSetConfidentialClick:n.PropTypes.func,ownerTeam:n.PropTypes.shape({id:n.PropTypes.string.isRequired,name:n.PropTypes.string.isRequired}),passFetchingStatus:n.PropTypes.number,pendingMemberAction:n.PropTypes.instanceOf(t.Set).isRequired,presentAccountIds:n.PropTypes.instanceOf(t.Set),recipientAccess:n.PropTypes.oneOf(F).isRequired,recipientMessage:n.PropTypes.string.isRequired,recipientTokens:n.PropTypes.array,shareFolderPromise:n.PropTypes.instanceOf(Promise),sharingPaywallInfo:n.PropTypes.shape({foldersToUnshare:n.PropTypes.object,isFolderOwner:n.PropTypes.bool,isInExperiment:n.PropTypes.bool,maxOwned:n.PropTypes.number,numOwned:n.PropTypes.number,onLearnMoreClick:n.PropTypes.func,onManageSharedFoldersClick:n.PropTypes.func,onUpgradeClick:n.PropTypes.func}),shouldBlockMemberListOnPassLoad:n.PropTypes.bool,showContentManagerBridge:n.PropTypes.bool,showPassFileSettings:n.PropTypes.bool,suppressLinkUI:n.PropTypes.bool,teamGroupInfo:n.PropTypes.shape({id:n.PropTypes.string,name:n.PropTypes.string}),user:n.PropTypes.instanceOf(A).isRequired,expSubgrowthProOverquotaCreateSharedLink:n.PropTypes.string},getDefaultProps:function(){return{contactsError:{level:null,message:null},headerId:"unified-share-modal-title",linkMetadata:null,members:null,initialRecipientRawInput:"",initialRecipientTokens:[],isTeamSharedFolder:!1,mode:Y.MEMBERSHIP,onFolderSettingsClick:null,onLinkViewersClick:null}},componentDidMount:function(){if(this.logTTI(),this.refs.contentNameInput)return s.findDOMNode(this.refs.contentNameInput).focus()},componentDidUpdate:function(e,t){return this.logTTI()},logTTI:function(){return this.props.mode===Y.LINK_ONLY&&this.props.isLinkMetadataLoaded?this.props.actionHandler.logIfHaventBefore("VIEW_LINK_ONLY_MODAL"):this.props.isMetadataLoaded&&(this.props.actionHandler.logIfHaventBefore("VIEW_SHARE_MODAL"),!this._shouldRenderMainLoading())?this.props.actionHandler.logIfHaventBefore("MEMBER_LIST_LOADED",{member_count:this._getMemberNum()}):void 0},render:function(){return de.div({className:"unified-share-modal unified-share-modal--"+this.props.mode},this._renderHeaderSection(),this._renderToSection(),this._renderErrorMessageSection(),this._renderConfidentialFolderSection(),this._renderMainSection(),this._renderPaywallSection(),this._renderFooterSection())},_renderHeaderSection:function(){var t,n,s,r,o;return n=this._getMemberNum(),s=this.props.user.is_team&&(null!=(r=this.props.memberCounts)?r.users_outside_team:void 0)>0&&null!=this.props.ownerTeam?ge("%(outside_team_count)s outside your Dropbox team","%(outside_team_count)s outside your Dropbox team",this.props.memberCounts.users_outside_team).format({outside_team_count:this.props.memberCounts.users_outside_team}):void 0,t=n?s?ge("%(member_num)s member (%(outside_team_string)s)","%(member_num)s members (%(outside_team_string)s)",n,{comment:'Description of the count of total folder members and count of outside-of-team folder members, like "10 members (3 outside of your Dropbox team)"'}):ge("%(member_num)s member","%(member_num)s members",n):"",t=t.format({member_num:n+((null!=(o=this.props.memberCounts)?o.exceeds_count:void 0)?"+":""),outside_team_string:s}),de.div({className:"unified-share-modal__section"},de.div({className:"unified-share-modal__close u-l-fr o-flag__fix"},le(C,{className:"u-mar-left-s u-mar-top-xs",onClick:(function(e){return function(){return e.props.actionHandler.onClickX(e.refs.tokenizer)}})(this)})),de.div({className:"unified-share-modal__header o-flag"},de.span({className:"o-flag__fix"},le(h,{alt:"",className:"unified-share-modal__title-icon",group:"web",name:this.props.icon})),de.div({className:e("unified-share-modal__title","o-flag__flex",n?"unified-share-modal__title--member-count":void 0)},this.props.contentInfo.pathExists()?de.h3({className:"u-font-strong",id:this.props.headerId},l.em_snippet(this.props.contentInfo.name(),Z.FILENAME)):this._renderContentNameInput(),n?de.h4({className:"u-trim-margin u-font-meta"},t):void 0),se.TRUELINK_UI[this.props.user.id]?de.span({className:"u-l-fr o-flag__fix"},this._renderContentSettings()):void 0))},_renderContentNameInput:function(){return de.div({className:"unified-share-modal__content-name"},null==this.props.contentNameMessage||!this.props.isContentNameFocused&&this.props.contentNameMessageLevel!==O.ERROR?void 0:le(m,{arrow:m.ARROW.TOP,className:e({"unified-share-modal__content-name__tooltip":!0,"unified-share-modal__content-name__tooltip-error":this.props.contentNameMessageLevel===O.ERROR,"u-font-strong":!0})},de.div({className:e(["u-pad-top-xxs","u-pad-bottom-xxs","u-pad-left-xs","u-pad-right-xs"])},this.props.contentNameMessage)),de.input({className:e(["u-trim-padding","u-trim-margin","u-l-ib","u-font-strong"]),id:this.props.headerId,ref:"contentNameInput",onChange:(function(e){return function(t){return e.props.actionHandler.handleContentNameChange(t.target.value)}})(this),onFocus:(function(e){return function(){return e.props.actionHandler.handleContentNameFocusChange(!0)}})(this),onBlur:(function(e){return function(){return e.props.actionHandler.handleContentNameFocusChange(!1)}})(this),onKeyUp:(function(e){return function(t){var n,r;if((null!=(n=e.refs.tokenizer)&&null!=(r=n.refs.tokenizer)?r.refs.input:void 0)&&13===t.keyCode)return s.findDOMNode(e.refs.tokenizer.refs.tokenizer.refs.input).focus()}})(this),placeholder:this.props.isContentNameFocused?void 0:ae("Folder name"),defaultValue:this.props.initialContentName}))},_renderToSection:function(){var t,n
;return this._shouldRenderPaywallBlocker()?null:this.props.linkOnlyReason===W.LINKS_PAGE?null:this.props.mode===Y.LINK_ONLY?this._renderNoPermissionSection():this.props.isMetadataLoaded?this.props.showContentManagerBridge?this._renderContentManagerBridge():this.props.canInviteEditor||this.props.canInviteViewer?_e(this.props.user,this.props.isTeamSharedFolder,this.props.isFolderInsideTeamFolderTree)&&(null!=(t=this.props.memberCounts)?t.total_unique_users:void 0)>=G.SHARING_TOTAL_LIMIT?this._renderOverLimitSection():(n=this.props.contentInfo.isFile()&&!this.props.canInviteEditor&&!this.props.canInviteViewerNoComment,de.div({className:"unified-share-modal__section unified-share-modal__section--to"},de.div({className:"o-flag"},de.label({className:"o-flag__fix u-font-strong",htmlFor:"unified-share-modal-contacts-tokenizer"},this.props.isTeamSharedFolder?ae("Add groups:",{comment:"Label for with whom to share"}):ae("To:",{comment:"Label for with whom to share"})),de.div({className:"unified-share-modal__to-input-box o-flag__flex"},le(U,{ref:"tokenizer",context:"tiburon",customContactFilter:this.props.isTeamSharedFolder?function(e){return e.type!==a.FB&&e.group_id}:this.props.isInContentManager?function(e){return e.type!==a.FB}:(function(e){return function(t){return t.type!==a.FB&&t.email!==e.props.user.email}})(this),focusOnMount:this.props.contentInfo.pathExists(),id:"unified-share-modal-contacts-tokenizer",onContentsChange:this.props.actionHandler.recipientsChange,populatedInputData:{tokens:this.props.initialRecipientTokens,value:this.props.initialRecipientRawInput},customContactValidator:(function(e){return function(t){return ye(t,e.props.user,e.props.ownerTeam,e.props.folderPolicy,e.props.isTeamSharedFolder,e.props.isFolderInsideTeamFolderTree,e.props.memberCountWithRecipients)}})(this),placeholder:ae(this.props.isTeamSharedFolder?"Group names":this.props.user.is_team?"Email, name, or group":"Email or name"),shouldLogContactSearch:!0,showContactImport:!this.props.isTeamSharedFolder,teamGroupInfo:this.props.isTeamSharedFolder?this.props.teamGroupInfo:null,user:this.props.user})),de.div({className:e({"o-flag__fix":!0})},n?le(re,{position:oe.BOTTOM,tooltip_contents:ae("Only folders can be shared with edit access"),tooltip_classname:"sharing-access-menu__tooltip"},de.span({className:"ax-visually-hidden"},ae("Only folders can be shared with edit access")),this._renderToSectionAccessDropdown()):this._renderToSectionAccessDropdown())))):this._renderNoPermissionSection():de.div({className:"unified-share-modal__section unified-share-modal__section--to"},de.div({className:"unified-share-modal__to-placeholder"}," "))},_renderToSectionAccessDropdown:function(){return le(te,{asButton:!0,canMakeViewerNoComment:this.props.canMakeViewerNoComment,contentInfo:this.props.contentInfo,currentAccess:this.props.recipientAccess,disabled:this.props.showContentManagerBridge,memberPermissions:new Q({make_editor:new J({allow:this.props.canInviteEditor}),make_viewer:new J({allow:this.props.canInviteViewer}),make_viewer_no_comment:new J({allow:this.props.canInviteViewerNoComment})}),onAccessChange:this.props.actionHandler.changeRecipientAccess})},_shouldRenderContentSettingsShareButton:function(){var e;return this.props.isMetadataLoaded&&this.props.mode!==Y.LINK_ONLY&&(this.props.contentInfo.isFolder()&&this.props.contentInfo.pathExists()||this.props.contentInfo.isFile()&&this.props.showPassFileSettings||(e=this.props.mode)===Y.SHARE||e===Y.SHARE_SENDING)&&!this._shouldRenderPaywallBlocker()},_shouldRenderFooterSection:function(){return this._renderLinkRowInFooter()?this._shouldRenderLinkRow():this._shouldRenderContentSettingsShareButton()},_renderFooterSection:function(){if(this._shouldRenderFooterSection())return de.div({className:"unified-share-modal__section unified-share-modal__section--footer clearfix"},this._renderLinkRowInFooter()?this._renderLinkRowContent():this._renderContentSettingsShareButton())},_renderContentSettingsShareButton:function(){if(this._shouldRenderContentSettingsShareButton())return de.div({},se.TRUELINK_UI[this.props.user.id]?void 0:de.div({className:"u-l-fl"},this._renderContentSettings()),de.div({className:"u-l-fr"},function(){switch(this.props.mode){case Y.SHARE:case Y.SHARE_SENDING:return de.button({className:"unified-share-modal__share-send c-btn c-btn--primary",disabled:this.props.mode===Y.SHARE_SENDING||this.props.isTokenizerEmpty||this.props.contactsError.level===R.ERROR||null!=this.props.contentNameMessage,onClick:(function(e){return function(){return e.props.actionHandler.handleShareClick(e.refs.tokenizer,e.refs.contentNameInput)}})(this)},ae(this.props.mode===Y.SHARE_SENDING?this.props.isTeamSharedFolder?"Adding...":"Sharing...":this.props.isTeamSharedFolder?"Add":"Share"));default:return null}}.call(this)))},_renderContentSettings:function(){var e;if(this.props.isMetadataLoaded)return this.props.contentInfo.isFolder()&&this.props.contentInfo.pathExists()||this.props.contentInfo.isFile()&&this.props.showPassFileSettings?de.button({"aria-label":ae("Settings"),className:"unified-share-modal__settings u-font-meta c-borderless-button",disabled:this.props.mode===Y.SHARE_SENDING,onClick:(function(e){return function(){return e.props.onSettingsClick()}})(this)},le(h,{alt:"",className:"u-mar-right-xs u-l-ib u-l-ib--m",group:"web",name:"settings"}),se.TRUELINK_UI[this.props.user.id]?void 0:ae(this.props.contentInfo.isFile()?"File settings":"Folder settings")):!this.props.contentInfo.isFolder()&&(this._canSendFeedbackRequest()||(null!=(e=this.props.recipientMessage)?e.length:void 0)>0)?this._renderFeedbackCheckbox():void 0},_renderErrorMessageSection:function(){return this.props.contactsError.message?de.div({className:e(["unified-share-modal__section","unified-share-modal__error-message","u-font-center",this.props.contactsError.level===R.WARN?"unified-share-modal__warn":void 0,this.props.contactsError.level===R.ERROR?"unified-share-modal__error":void 0])},this.props.contactsError.message):null},_shouldRenderMainLoading:function(){var e,t,n,s;return n=this.props.isMetadataLoaded,t=this.props.hasNonOwnerMembers||this.props.areMembersFullyLoaded,s=!this.props.isPassEnabled||this._isPassInfoLoaded(),e=this.props.shouldBlockMemberListOnPassLoad&&!s,!n||!t||e},_renderMainSection:function(){if(this.props.mode===Y.LINK_ONLY)return this._renderMainLinkOnly();if(this._shouldRenderMainLoading())return this._renderMainLoading();switch(this.props.mode){case Y.MEMBERSHIP:return this._renderMainMembership();case Y.SHARE:case Y.SHARE_SENDING:return this._renderMainShare();default:return null}},_shouldRenderPaywallBlocker:function(){var e,t,n;return null!==this.props.sharingPaywallInfo&&(!((null!=(n=this.props.sharingPaywallInfo.foldersToUnshare)?n.size:void 0)>0)&&(e=this.props.contentInfo.isFolder()&&!this.props.contentInfo.isSharedFolder(),t=this.props.sharingPaywallInfo.numOwned>=this.props.sharingPaywallInfo.maxOwned,this.props.sharingPaywallInfo.isInExperiment&&e&&t))},_shouldRenderPaywallBanner:function(){var e,t,n,s;return null!==this.props.sharingPaywallInfo&&((null!=(s=this.props.sharingPaywallInfo.foldersToUnshare)?s.size:void 0)>0||(t=this.props.sharingPaywallInfo.isFolderOwner,n=this.props.sharingPaywallInfo.numOwned<this.props.sharingPaywallInfo.maxOwned,e=this.props.contentInfo.isFolder()&&!this.props.contentInfo.isSharedFolder(),this.props.sharingPaywallInfo.isInExperiment&&(this.props.contentInfo.isSharedFolder()&&t||e&&n)))},_renderPaywallSection:function(){var t;return this.props.isMetadataLoaded&&this._shouldRenderPaywallBanner()?(this.props.actionHandler.logPaywallEvent("show_sharing_paywall_banner_in_share_modal"),t=0===this.props.sharingPaywallInfo.numOwned?ge("You can own %(max)s shared folder.","You can own %(max)s shared folders.",this.props.sharingPaywallInfo.maxOwned).format({max:this.props.sharingPaywallInfo.maxOwned}):ge("You own %(num)s shared folder (max is %(max)s).","You own %(num)s shared folders (max is %(max)s).",this.props.sharingPaywallInfo.numOwned).format({num:this.props.sharingPaywallInfo.numOwned,max:this.props.sharingPaywallInfo.maxOwned}),de.div({className:e(["paywall-banner","unified-share-modal__section","unified-share-modal__no-permission","u-font-center"])},t," ",de.button({className:"button-as-link",onClick:this.props.sharingPaywallInfo.onLearnMoreClick},ae("Learn more")))):null},_renderNoPermissionSection:function(){var e;return de.div({className:"unified-share-modal__section unified-share-modal__no-permission u-font-center"},this.props.mode===Y.LINK_ONLY?this.props.contentInfo.isOSXPackage()?ae(se.TRUELINK_UI[this.props.user.id]?"Package files can’t be shared.":"This package file can only be shared as a link."):this.props.linkOnlyReason===W.INSIDE_SHARED_FOLDER?se.TRUELINK_UI[this.props.user.id]?ae("You don’t have permission to share this folder."):de.span({},ae("This folder can only be shared as a link because it’s in a shared folder.")+" ",de.a({href:"/help/1931",target:"_blank"},ae("Learn more"))):se.TRUELINK_UI[this.props.user.id]?ae("This folder can’t be shared"):this.props.linkOnlyReason===W.CONTAINS_SHARED_FOLDER?de.span({},ae("This folder can only be shared as a link because it contains a shared folder.")+" ",de.a({href:"/help/1931",target:"_blank"},ae("Learn more"))):ae("This folder can only be shared as a link."):this.props.isTeamSharedFolder&&this._shouldRenderTeamFolderNoPermissionMessage(this.props.members)?ae("This folder is automatically shared with all members of %(team_name)s").format({team_name:this.props.ownerTeam.name}):this.props.isTeamSharedFolder?he(ae("Only <admin_link>admins</admin_link> and <group_link>group managers</group_link> can change team folder membership."),{admin_link:de.a({href:"/team?_tk=left_nav_team",target:"_blank"}),group_link:de.a({href:"/help/7232#transfer",target:"_blank"})}):ae(this.props.contentInfo.isFolder()?se.TRUELINK_UI[this.props.user.id]&&(null!=(e=this.props.permissions)?e.change_options.allow:void 0)?"To add new members, you’ll need to add them to the parent folder.":"You don’t have permission to manage membership of this folder":"You don’t have permission to manage membership of this file"))},_renderConfidentialFolderSection:function(){if(this.props.isConfidentialFolder&&this.props.canUpdateConfidentiality)return de.div({className:"unified-share-modal__section unified-share-modal__confidential-folder u-font-center"},de.span({},he(ae("<b>Invite only.</b> Members of parent folders can’t access."),{b:de.b()}),this.props.contentInfo.pathExists()?[" ",de.a({onClick:this.props.onSetConfidentialClick},ae("Restore access"))]:void 0))},_renderContentManagerBridge:function(){var e;return e=ue(this.props.isLimitedTeam,this.props.contentInfo.displayPath()),de.div({className:"unified-share-modal__section unified-share-modal__no-permission u-font-center"},de.span({},ae("You can manage folder membership in the Admin Console. "),de.a({href:e.toString(),target:"_blank"},ae("Open in new tab."))))},_renderOverLimitSection:function(){return de.div({className:"unified-share-modal__section unified-share-modal__no-permission u-font-center"},de.div({},ae("This folder is over its %(member_limit)s-member limit.",{comment:"member limit is a number greater than 200"}).format({member_limit:G.SHARING_TOTAL_LIMIT})),de.div({},ae("Please remove some members.")," ",de.a({href:"/help/9292",target:"_blank"},ae("Learn more."))))},_shouldRenderTeamFolderNoPermissionMessage:function(e){return null!=e&&null!=e.groups&&e.groups.some(function(e,t){var n,s;return"team"===e.group_type&&(null!=(n=e.permissions.make_editor)?n.allow:void 0)&&(null!=(s=e.permissions.make_viewer)?s.allow:void 0)})},_isOwnerOfAtLeastOneGroup:function(e){return null!=e&&null!=e.groups&&e.groups.some(function(e,t){return e.is_owner})},_renderMainLoading:function(){return de.div({className:e(["unified-share-modal__main","unified-share-modal__section",this._shouldRenderFooterSection()?void 0:"unified-share-modal__main--no-footer"])},this._renderLinkRow(),de.div({className:"u-font-center u-font-meta u-pad-top-xl"},de.div({className:"c-loader"},ae("Loading..."))))},_renderMainLinkOnly:function(){return se.TRUELINK_UI[this.props.user.id]&&this.props.linkOnlyReason!==W.LINKS_PAGE?null:de.div({className:e(["unified-share-modal__main","unified-share-modal__main--link-only","unified-share-modal__section",this._isPassInfoLoaded()?"unified-share-modal__main--pass-loaded":void 0])},this._renderLinkRow())},_renderMainMembership:function(){var t,n;return de.div({className:e(["unified-share-modal__main","unified-share-modal__section",this._shouldRenderFooterSection()?void 0:"unified-share-modal__main--no-footer",this._shouldRenderPaywallBlocker()?"unified-share-modal__main--paywall":void 0,this._isPassInfoLoaded()?"unified-share-modal__main--pass-loaded":void 0])},this._renderLinkRow(),this._shouldRenderPaywallBlocker()?(this.props.actionHandler.logPaywallEvent("view_shared_folder_paywall"),le(d,{actionHandler:this.props.actionHandler,maxOwned:this.props.sharingPaywallInfo.maxOwned,numOwned:this.props.sharingPaywallInfo.numOwned,onLearnMoreClick:this.props.sharingPaywallInfo.onLearnMoreClick,onUpgradeClick:this.props.sharingPaywallInfo.onUpgradeClick,onManageClick:this.props.sharingPaywallInfo.onManageSharedFoldersClick})):this.props.hasNonOwnerMembers?le(N,{actionHandler:this.props.actionHandler,areMembersFullyLoaded:this.props.areMembersFullyLoaded,canInviteMembers:this.props.canInviteEditor||this.props.canInviteViewer,canMakeViewerNoComment:this.props.canMakeViewerNoComment,canRelinquishMembership:this.props.canRelinquishMembership,canUpdateConfidentiality:this.props.canUpdateConfidentiality,contentInfo:this.props.contentInfo,disabled:this.props.showContentManagerBridge,groupSeenStateInfo:this.props.groupSeenStateInfo,membership:this.props.members,onSetConfidentialClick:this.props.onSetConfidentialClick,pendingMemberAction:this.props.pendingMemberAction,presentAccountIds:this.props.presentAccountIds,shouldShowPassUI:this.props.isPassEnabled&&pe(this.props.passFetchingStatus),teamName:null!=(n=this.props.ownerTeam)?n.name:void 0,user:this.props.user,viewer:this.props.viewer}):this.props.banner===x.INPUT_CONTENT_NAME?de.div({className:e(["unified-share-modal__input-content-name-banner","u-font-center","u-font-meta","u-mar-top-xs"])},le(p,{src:fe("/static/images/sharing/illo-name-folder-vfl38PzAv.png"),srcHiRes:fe("/static/images/sharing/illo-name-folder@2x-vflzK0uJv.png")}),de.h3({className:e(["u-font-strong","u-mar-top-xs"])},ae("Name your shared folder")),de.p({className:e(["u-pad-left-xxl","u-pad-right-xxl"])},ae("Shared folders are for collaborting on projects, client works, and organizing departments"))):de.div({className:e(["unified-share-modal__no-members-banner","u-font-center","u-font-meta","u-font-center","u-font-meta"])},this.props.isTeamSharedFolder?null!=this.props.teamGroupInfo?[de.p({className:"u-mar-top-xxl"},de.a({onClick:this._addEveryoneGroup},ae("Add everyone at %(team_name)s").format({team_name:this.props.ownerTeam.name}))),de.p({},ae("Or, add groups to this team folder.")+" ",de.a({href:"/team#groups/newgroup"},ae("Create a group")))]:de.p({className:"u-mar-top-xxl"},ae("Add groups to this team folder.")+" ",de.a({href:"/team#groups/newgroup"},ae("Create a group"))):(t=se.TRUELINK_UI[this.props.user.id],t||"V1"!==this.props.expSubgrowthProOverquotaCreateSharedLink?t||"V2"!==this.props.expSubgrowthProOverquotaCreateSharedLink?de.div({},le(p,{className:"unified-share-modal__illo",src:fe("/static/images/sharing/sharing-invite-users-vflfTH_fj.png"),srcHiRes:fe("/static/images/sharing/sharing-invite-users@2x-vflgGHzXi.png")}),de.p({className:"u-mar-top-s"},ae("Add people you want to share with"))):le(H):le(q))))},_renderMainShare:function(){return de.div({className:"unified-share-modal__main unified-share-modal__section u-pad-horizontal-m"},this.props.isTeamSharedFolder?void 0:de.textarea({placeholder:ae("Add a message (optional)"),onChange:(function(e){return function(t){return e.props.actionHandler.changeRecipientMessage(t.target.value)}})(this),value:this.props.recipientMessage}))},_renderLinkRow:function(){if(!this._renderLinkRowInFooter())return this._renderLinkRowContent()},_renderLinkRowContent:function(){var e,t;if(this._shouldRenderLinkRow())return t=!this.props.contentInfo.isMounted()&&this.props.isPassEnabled&&this._isPassInfoLoaded()&&this.props.isMetadataLoaded,t||this.props.isLinkMetadataLoaded&&(this.props.isMetadataLoaded||this.props.mode===Y.LINK_ONLY)?de.div({className:"unified-share-modal__link-info"},le(X,{actionHandler:this.props.actionHandler,canShareLink:this.props.canShareLink||this.props.mode===Y.LINK_ONLY,contentInfo:this.props.contentInfo,hasDisplayableMembers:this.props.hasDisplayableMembers,hasNonOwnerMembers:this.props.hasNonOwnerMembers,isLimitedTeam:this.props.isLimitedTeam,linkMetadata:this.props.linkMetadata,linkSeenStateInfo:this.props.linkSeenStateInfo,mode:this.props.mode,onLinkViewersClick:this.props.onLinkViewersClick,shareFolderPromise:this.props.shareFolderPromise,teamName:null!=(e=this.props.ownerTeam)?e.name:void 0,presentAccountIds:this.props.presentAccountIds,user:this.props.user})):this.props.mode===Y.LINK_ONLY?de.div({className:"unified-share-modal__link-info--loading"},de.div({className:"c-loader c-loader--spinner--blue u-l-b u-mar-horizontal-auto"},ae("Loading…"))):this.props.contentInfo.isTeamSharedFolder()?void 0:de.div({className:"unified-share-modal__link-info--filler"})},_renderFeedbackCheckbox:function(){var e,t;return t=this._canSendFeedbackRequest(),e=ae(t?"I want feedback on this file":"Post this message as a comment"),de.div({className:"u-pad-top-xs"},de.div({className:"unified-share-modal__add-message-as-comment-checkbox-container"},de.input({type:"checkbox",id:"add_message_as_comment",name:"add_message_as_comment",checked:this.props.isAddMessageAsCommentChecked,onChange:this._handleAddMessageAsCommentChange}),this.props.isAddMessageAsCommentHelpShown?le(E,{onClose:this._commentsHelpClosed,onButtonClick:this._commentsHelpButtonClicked,isFeedbackRequest:t}):void 0),de.label({htmlFor:"add_message_as_comment"},e))},_getMemberNum:function(){var e;return null!=this.props.memberCounts?this.props.memberCounts.total_unique_users:null!=(e=this.props.members)?e.getMemberCount():void 0},_isPassInfoLoaded:function(){return ce(this.props.passFetchingStatus)},_handleAddMessageAsCommentChange:function(e){return this.props.actionHandler.setAddMessageAsCommentChecked(e.target.checked)},_commentsHelpClosed:function(){return this.props.actionHandler.setAddMessageAsCommentHelpClosed()},_commentsHelpButtonClicked:function(){return this.props.actionHandler.setAddMessageAsCommentHelpClosed(),this.props.actionHandler.setAddMessageAsCommentChecked(!0)},_canSendFeedbackRequest:function(){return!this._renderLinkRowInFooter()},_addEveryoneGroup:function(){var e;return null!=(e=this.refs.tokenizer)?e.addExternalContacts([i.teamGroupInfoToContact(this.props.teamGroupInfo)]):void 0},_renderLinkRowInFooter:function(){return this.props.mode!==Y.LINK_ONLY&&(this.props.mode!==Y.SHARE&&this.props.mode!==Y.SHARE_SENDING&&(!!this.props.isMetadataLoaded&&se.TRUELINK_UI[this.props.user.id]))},_shouldRenderLinkRow:function(){return!(se.TRUELINK_UI[this.props.user.id]&&this.props.isLinkMetadataLoaded&&!this.props.linkMetadata)&&(!this.props.suppressLinkUI&&this.props.canShareLink)}}),$=c(ie,["/static/css/react/contacts_tokenizer-vflR5K70C.css","/static/css/scooter/scooter-scoped-vfl0UVTY2.css","/static/css/sharing/share_modal-vflqkhEAI.css"]),{ShareModalContent:$,MODES:Y}})}.call(this),define("modules/clean/sharing/views/modal_link_info",["require","exports","tslib","jquery","external/classnames","external/react","modules/clean/clipboard_v2","modules/clean/em_string","modules/clean/react_format","modules/clean/react/sprite","modules/clean/react/util","modules/clean/sharing/api/types/metadata","modules/clean/sharing/constants","modules/clean/sharing/link_description","modules/clean/sharing/sharing_settings_dropdown","modules/clean/sharing/sharing_settings_util","modules/clean/sharing/ui_util","modules/clean/sharing/views/constants","modules/clean/sharing/views/modal_viewers_line","modules/clean/sharing/views/viewer_info","modules/core/i18n","modules/core/notify"],function(e,t,n,s,r,o,a,i,l,d,c,p,u,h,m,_,f,g,y,b,v,S){"use strict";var I=v.i18n_default_project("sharing")._,E=(function(e){function t(t,n){var s=e.call(this,t,n)||this;return s.handleCreateLinkClicked=function(){if(s.isSharedContentLink())throw Error("Should not display this for shared content link");if(s.props.actionHandler)return s.props.actionHandler.createSharedLink()},s.handleCopyLinkClicked=function(){return s.state.showingUrl||(f.logTiburonEvent(s.props.contentInfo,s.props.user.id,"CLICK_TIB_COPY_LINK"),s.props.actionHandler&&s.props.actionHandler.turnLinkOnIfQualified()),c.setStatePromise(s,{showingUrl:!s.state.showingUrl}).then(function(){if(s.urlField){var e=s.urlField;e.focus(),e.select(),s.clipboard.do_copy()}})},s.state={showingUrl:!1},s.clipboard=null,s}return n.__extends(t,e),t.prototype.componentWillMount=function(){this.clipboard=new a(this.props.linkMetadata&&this.props.linkMetadata.url,function(){return S.success(I("Link copied to clipboard"))},function(){S.error(I("Unable to copy the link, please copy manually"))},this.handleCopyLinkClicked)},t.prototype.componentDidMount=function(){this.setupCopy()},t.prototype.componentDidUpdate=function(){this.setupCopy()},t.prototype.setupCopy=function(){var e=s(".copy-link-button");e.length&&this.clipboard.setupCopy(e,s(".copy-link-container"))},t.prototype.render=function(){return this.props.linkMetadata||this.isSharedContentLink()?this.renderLink():this.props.contentInfo&&!this.props.contentInfo.isMounted()?this.renderUnmountedLinkInfo():this.props.canShareLink?this.renderNoLink():null},t.prototype.renderLink=function(){var e=this;if(!this.props.linkMetadata)return null;var t=null;this.props.linkMetadata instanceof p.SharedContentLinkMetadata&&(t=this.renderSharedContentLinkInfo());var n;if(this.state.showingUrl)n=o.createElement("span",null,t,o.createElement("span",null,o.createElement("label",{className:"ax-visually-hidden",htmlFor:"unified-share-modal-link-url",key:"link-label"},I("Shared link URL")),o.createElement("input",{className:"unified-share-modal-link-info__url",id:"unified-share-modal-link-url",key:"link-url-input",onClick:this.handleUrlClick,readOnly:!0,ref:function(t){return e.urlField=t},type:"text",value:this.props.linkMetadata.url})));else{var s=null;this.props.linkMetadata instanceof p.LinkMetadata?s=h.formatLinkDescription(this.props.linkMetadata):this.props.linkMetadata instanceof p.SharedContentLinkMetadata&&(s=this.renderSharedContentLinkInfo());var a=null;null!==s&&(a=o.createElement("span",{className:r({"unified-share-modal-link-info__description":!0,"unified-share-modal-link-info__description--content-link":this.isSharedContentLink()})},s)),n=o.createElement("span",null,a,this.renderLinkViewers())}var i=null;return this.isSharedContentLink()?this.props.linkMetadata&&this.props.linkMetadata.url?i=this.renderCopyLink():this.isSharingFolder()||(i=this.renderGetLink()):i=o.createElement("span",null,this.renderLinkSettings(),this.renderDivider(),this.renderCopyLink()),o.createElement("div",{className:"unified-share-modal-link-info o-flag"},o.createElement("div",{className:"o-flag__fix"},this.renderLinkIcon()),o.createElement("div",{className:this.detailsClassName()},n),o.createElement("ul",{className:"unified-share-modal-link-info__actions o-flag__fix"},i))},t.prototype.renderLinkSettings=function(){return!this.state.showingUrl&&this.props.actionHandler?o.createElement("li",{className:"u-l-ib"},o.createElement("button",{className:"button-as-link",onClick:this.props.actionHandler.handleLinkSettingsClick},I("Link settings"))):null},t.prototype.renderDivider=function(){return this.state.showingUrl?null:o.createElement("span",{className:"u-l-ib u-mar-left-xs u-mar-right-xs"},"•")},t.prototype.renderCopyLink=function(){var e;return e=this.state.showingUrl?I("Hide link"):a.is_supported()?o.createElement("span",{className:"copy-link-button"},I("Copy link")):I("Show link"),o.createElement("li",{className:"u-l-ib"},o.createElement("button",{className:"button-as-link copy-link-container",onClick:this.handleCopyLinkClicked},e))},t.prototype.renderGetLink=function(){var e=this,t=function(){e.props.actionHandler&&e.props.actionHandler.turnLinkOnIfQualified().then(function(){e.props.actionHandler&&e.props.actionHandler.shareIfFileFolder()})};return o.createElement("li",{className:"u-l-ib"},o.createElement("button",{className:"button-as-link",onClick:t},I("Get link")))},t.prototype.renderUnmountedLinkInfo=function(){var e=this.renderLinkViewers();return e||(e=I("No one else has viewed the link")),o.createElement("div",{className:r({"unified-share-modal-link-info":!0,"o-flag":!0,"u-mar-horizontal-s":!this.isSharedContentLink(),"u-mar-bottom-s":!0,"u-pad-top-s":!0})},o.createElement("div",{className:"o-flag__fix"},this.renderLinkIcon()),o.createElement("div",{className:this.detailsClassName()},e))},t.prototype.detailsClassName=function(){return"unified-share-modal-link-info__details o-flag__flex"},t.prototype.renderNoLink=function(){var e;return e=this.props.linkSeenStateInfo&&this.props.linkSeenStateInfo.length?o.createElement("span",null,I("You haven’t created a link yet"),this.renderLinkViewers()):I("No link created yet"),o.createElement("div",{className:"unified-share-modal-link-info unified-share-modal-link-info--no-link o-flag"},o.createElement("div",{className:"o-flag__fix"},o.createElement("div",{className:"unified-share-modal-link-info__icon"},o.createElement(d,{alt:"",group:"web",name:"shared_link_gray"}))),o.createElement("div",{className:this.detailsClassName()},e),o.createElement("div",{className:"unified-share-modal-link-info__actions o-flag__fix"},o.createElement("button",{className:"button-as-link",onClick:this.handleCreateLinkClicked},I("Create a link"))))},t.prototype.handleUrlClick=function(e){e.target.select()},t.prototype.renderLinkViewers=function(){if(!(this.props.presentAccountIds&&this.props.linkSeenStateInfo&&this.props.linkSeenStateInfo.length))return null;var e=this.props.linkSeenStateInfo.map(function(e){return new b.ViewerInfo(e)});return o.createElement("button",{className:"unified-share-modal-link-info__viewers button-as-link",onClick:this.props.onLinkViewersClick},o.createElement(y.ModalViewersLine,{currentUserAccountId:this.props.user.account_id,presentAccountIds:this.props.presentAccountIds,viewers:e}))},t.prototype.isSharedContentLink=function(){return u.TRUELINK.TRUELINK_UI[this.props.user.id]},t.prototype.renderLinkIcon=function(){return o.createElement("div",{className:"unified-share-modal-link-info__icon"},o.createElement(d,{alt:"",group:"web",name:"shared_link_white"}))},t.prototype.isSharingFolder=function(){return Boolean(this.props.shareFolderPromise)},t.prototype.renderSharedContentLinkInfo=function(){if(!(this.props.actionHandler&&this.props.linkMetadata&&this.props.linkMetadata instanceof p.SharedContentLinkMetadata))return null;if(this.isSharingFolder()||this.props.linkMetadata instanceof p.SharedContentLinkMetadata&&this.props.linkMetadata.current_audience===p.LinkAudience.default_on)return o.createElement("div",null,I("Updating link"),o.createElement("div",{className:"c-loader"}));var e,t=this.props.linkMetadata.audience_options.size>1;this.props.linkMetadata.current_audience===p.LinkAudience.members?e=this.props.hasDisplayableMembers&&!this.props.hasNonOwnerMembers?l.reactFormat(I("<strong>Only you</strong> can use the link"),{strong:o.DOM.strong()}):l.reactFormat(I("<strong>Only invited members</strong> with the link can view"),{strong:o.DOM.strong()}):this.props.linkMetadata.current_audience===p.LinkAudience.team?e=l.reactFormat(I("<strong>Only people at %(team_name)s</strong> with the link can view"),{strong:o.DOM.strong(),team_name:i.em_snippet(this.props.teamName||"",10)}):this.props.linkMetadata.current_audience===p.LinkAudience.public&&(e=l.reactFormat(I("<strong>Anyone</strong> with the link can view"),{strong:o.DOM.strong()}));var n;if(t){var s=o.createElement("button",{className:"c-borderless-button change-audience-button"},e,o.createElement(d,{alt:"",className:"u-l-ib u-l-ib--m u-mar-left-xs",group:"web",name:"arrow-down-gray"}));n=o.createElement(m.SettingDropdown,{currentValue:this.props.linkMetadata.current_audience,valuesList:this.props.linkMetadata.audience_options.valueSeq().toArray(),optionsDict:_.getAudienceOptionsDict(this.props.contentInfo&&this.props.contentInfo.isFolder()||!1,this.props.teamName||"",this.props.hasNonOwnerMembers||!1,this.props.hasDisplayableMembers||!1),onValueSelected:this.props.actionHandler.handleSelectLinkAudience,customButton:s,openUp:this.props.mode!==g.MODES.LINK_ONLY})}else n=e;var r=[];this.props.linkMetadata.expiry&&r.push(h.formatSharedContentLinkExpiry(this.props.linkMetadata,!0)),this.props.linkMetadata.password_protected&&this.props.linkMetadata.expiry&&r.push(this.renderDivider()),this.props.linkMetadata.password_protected&&r.push(I("Password protected"));var a;if(this.props.linkMetadata.audience_restricting_shared_folder&&this.props.linkMetadata.audience_restricting_shared_folder.audience===this.props.linkMetadata.current_audience){var c="";this.props.linkMetadata.audience_restricting_shared_folder&&(c=this.props.linkMetadata.audience_restricting_shared_folder.name),a=I("Applied via %(folder_name)s").format({folder_name:c})}else this.props.contentInfo&&this.props.contentInfo.isFolder()&&this.props.linkMetadata.current_audience!==p.LinkAudience.members&&(a=I("Applies to all items in this folder"));return o.createElement("div",null,o.createElement("div",null,n),o.createElement("div",null,r),a)},t})(o.Component);E.displayName="ModalLinkInfo",t.ModalLinkInfo=E}),define("modules/clean/sharing/views/modal_viewers_line",["require","exports","tslib","external/react","modules/clean/em_string","modules/clean/react_format","modules/clean/react/title_bubble","modules/clean/sharing/constants","modules/core/i18n","modules/core/user_i18n"],function(e,t,n,s,r,o,a,i,l,d){"use strict";var c=(function(){function e(){}return e.prototype.formatOne=function(e){return l._("<NameSpan>%(first_user)s</NameSpan> is viewing now").format({first_user:e})},e.prototype.formatTwo=function(e,t){return l._("<NameSpan>%(first_user)s</NameSpan> and <NameSpan>%(second_user)s</NameSpan> are viewing").format({first_user:e,second_user:t})},e.prototype.formatMulti=function(e,t,n){return l.ungettext("<NameSpan>%(first_user)s</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d other are viewing</PositioningTarget>","<NameSpan>%(first_user)s</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d others are viewing</PositioningTarget>",n).format({first_user:e,second_user:t,in_bubble_count:n})},e})(),p=(function(){function e(){}return e.prototype.formatOne=function(e){return l._("<NameSpan>You</NameSpan> are viewing now")},e.prototype.formatTwo=function(e,t){return l._("<NameSpan>You</NameSpan> and <NameSpan>%(second_user)s</NameSpan> are viewing now").format({second_user:t})},e.prototype.formatMulti=function(e,t,n){return l.ungettext("<NameSpan>You</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d other are viewing</PositioningTarget>","<NameSpan>You</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d others are viewing</PositioningTarget>",n).format({second_user:t,in_bubble_count:n})},e})(),u=(function(){function e(){}return e.prototype.formatOne=function(e){return l._("<NameSpan>%(first_user)s</NameSpan> viewed").format({first_user:e})},e.prototype.formatTwo=function(e,t){return l._("<NameSpan>%(first_user)s</NameSpan> and <NameSpan>%(second_user)s</NameSpan> viewed").format({first_user:e,second_user:t})},e.prototype.formatMulti=function(e,t,n){
return l.ungettext("<NameSpan>%(first_user)s</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d other viewed</PositioningTarget>","<NameSpan>%(first_user)s</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d others viewed</PositioningTarget>",n).format({first_user:e,second_user:t,in_bubble_count:n})},e})(),h=(function(){function e(){}return e.prototype.formatOne=function(e){return l._("<NameSpan>You</NameSpan> viewed")},e.prototype.formatTwo=function(e,t){return l._("<NameSpan>You</NameSpan> and <NameSpan>%(second_user)s</NameSpan> viewed").format({second_user:t})},e.prototype.formatMulti=function(e,t,n){return l.ungettext("<NameSpan>You</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d other viewed</PositioningTarget>","<NameSpan>You</NameSpan>, <NameSpan>%(second_user)s</NameSpan>, <PositioningTarget>and %(in_bubble_count)d others viewed</PositioningTarget>",n).format({second_user:t,in_bubble_count:n})},e})(),m=(function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.prototype.render=function(){for(var e=null,t=[],n=[],s=!0,r=0,o=this.props.viewers;r<o.length;r++){var a=o[r],i=this.props.presentAccountIds.has(a.account_id);a.account_id===this.props.currentUserAccountId?e=a:i?t.push(a):n.push(a),i||(s=!1)}var l;l=e?s?new p:new h:s?new c:new u;var d=e?[e]:[];return d.push.apply(d,t.concat(n)),this.buildViewerComponent(d,l)},t.prototype.buildViewerComponent=function(e,t){var n,r=function(e){return o.reactFormat(e,{NameSpan:s.createElement("span",null)})};switch(e.length){case 0:return s.createElement("span",null);case 1:n=r(t.formatOne(this.getName(e,0,!1)));break;case 2:n=r(t.formatTwo(this.getName(e,0),this.getName(e,1)));break;default:n=this.buildComplexTooltip(e,t)}return s.createElement("div",{className:"viewer-list-line"},n)},t.prototype.getName=function(e,t,n){void 0===n&&(n=!0);var s=e[t].display_name;return n&&(s=d.getShortName(s)),r.em_snippet(s,i.SNIPPET_SIZES.DISPLAY_NAME)},t.prototype.buildComplexTooltip=function(e,t){for(var n=e.length,r=n-2,i=[this.getName(e,2,!1)],d=Math.min(10,n),c=3;c<d;c++)i.push(s.createElement("br",null),this.getName(e,c,!1));var p=n-d;if(p){var u=l.ungettext("and %(num_additional)d more…","and %(num_additional)d more…",p,{comment:"text in a list of members, indicates there are also num_additional members not shown"}).format({num_additional:p});i.push(s.createElement("br",null),u)}var h=t.formatMulti(this.getName(e,0),this.getName(e,1),r),m=o.reactFormat(h,{NameSpan:s.createElement("span",null),PositioningTarget:s.createElement("span",{className:a.POSITIONING_TARGET_CLASS})});return s.createElement(a,{content:s.createElement("div",null,i),children:s.createElement("span",null,m),position:a.POSITIONS.BOTTOM,isTargetPositionFixed:!0})},t})(s.Component);t.ModalViewersLine=m}),define("modules/clean/sharing/views/sharing_bubble_menu",["require","exports","tslib","external/classnames","external/react","modules/clean/react/bubble_menu","modules/clean/react/sprite","modules/clean/sharing/constants","modules/clean/sharing/strings","modules/core/i18n"],function(e,t,n,s,r,o,a,i,l,d){"use strict";var c=d.i18n_default_project("sharing")._,p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getMemberActionInfo=function(){var e=l.ACCESS_NAME;this.props.canMakeViewerNoComment&&(e=l.ACCESS_NAME_NO_COMMENT);var t=l.MEMBER_ACTION_FOLDER;this.props.canMakeViewerNoComment&&(t=l.MEMBER_ACTION_FOLDER_NO_COMMENT);var n=l.MEMBER_ACTION_FILE;this.props.canMakeViewerNoComment&&(n=l.MEMBER_ACTION_FILE_NO_COMMENT);var s=c("Remove");return this.props.allowRelinquishMembership&&(s=c("Remove my access")),[[i.MEMBER_ACTION.MAKE_EDITOR,{value:i.ACCESS_LEVEL.WRITER,title:e[i.ACCESS_LEVEL.WRITER],folder_description:t[i.MEMBER_ACTION.MAKE_EDITOR],file_description:n[i.MEMBER_ACTION.MAKE_EDITOR]}],[i.MEMBER_ACTION.MAKE_VIEWER,{value:i.ACCESS_LEVEL.READER,title:e[i.ACCESS_LEVEL.READER],folder_description:t[i.MEMBER_ACTION.MAKE_VIEWER],file_description:n[i.MEMBER_ACTION.MAKE_VIEWER]}],[i.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT,{value:i.ACCESS_LEVEL.READER_NO_COMMENT,title:e[i.ACCESS_LEVEL.READER_NO_COMMENT],folder_description:t[i.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT],file_description:n[i.MEMBER_ACTION.MAKE_VIEWER_NO_COMMENT]}],[i.MEMBER_ACTION.MAKE_OWNER,{value:i.ACCESS_LEVEL.OWNER,title:c("Make owner")}],[i.MEMBER_ACTION.REMOVE,{value:"remove",title:r.createElement("div",{className:"u-font-danger"},s)}]]},t.prototype.renderMenuItem=function(e){var t=this,n=e.value,s=e.title,i=e.file_description,l=e.folder_description,d=null;d=this.props.contentInfo&&this.props.contentInfo.isFolder()?l:i;var c=null;n!==this.props.currentAccess&&(c=function(){return t.props.onAccessChange(n)});var p=null;return n===this.props.currentAccess&&(p=r.createElement(a,{alt:"",group:"web",name:"check_gray"})),r.createElement(o.BubbleMenuItem,{className:"sharing-access-menu-item",key:n,onClick:c},r.createElement("div",{className:"sharing-access-menu-item__left-margin u-l-ib u-l-ib--t"},p),r.createElement("div",{className:"sharing-access-menu-item__label u-l-ib u-l-ib--t"},r.createElement("div",{className:"u-font-nowrap u-font-black sharing-access-menu-item__title"},s),r.createElement("div",{className:"u-font-wrap u-font-meta sharing-access-menu-item__description"},d)))},t.prototype.renderCurrentAccessText=function(e){var t=s({"sharing-access-menu__current-access":!0,"u-font-nowrap":!0,"c-btn--disabled":e,"sharing-access-menu__current-access--button":this.props.asButton,"c-btn":this.props.asButton,"c-btn--secondary":this.props.asButton,"u-trim-margin":this.props.asButton,"c-borderless-button":!this.props.asButton,"change-access-button":!this.props.asButton&&!e}),n=l.ACCESS_NAME[this.props.currentAccess];this.props.canMakeViewerNoComment&&(n=l.ACCESS_NAME_NO_COMMENT[this.props.currentAccess]);var o=null;return e||(o=[r.createElement("div",{className:"gray-arrow",key:"gray"},r.createElement(a,{alt:"",className:"u-l-ib u-l-ib--m u-mar-left-xs",group:"web",name:"arrow-down-gray"})),r.createElement("div",{className:"blue-arrow",key:"blue"},r.createElement(a,{alt:"",className:"u-l-ib u-l-ib--m u-mar-left-xs",group:"web",name:"arrow-down-blue"}))]),r.createElement("button",{className:t},n,o)},t.prototype.render=function(){for(var e=[],t=0,n=this.getMemberActionInfo();t<n.length;t++){var s=n[t],a=s[0],l=s[1];(l.value===this.props.currentAccess||this.props.memberPermissions&&this.props.memberPermissions.get(a)&&this.props.memberPermissions.get(a).allow||l.value===i.MEMBER_ACTION.REMOVE&&this.props.allowRelinquishMembership)&&e.push(this.renderMenuItem(l))}if(e.length<=1||this.props.pendingAccessChange)return this.renderCurrentAccessText(!0);var d=0;return this.props.asButton&&(d=-5),r.createElement(o.BubbleMenu,{targetButton:this.renderCurrentAccessText(this.props.disabled||!1),targetFixed:!0,position:o.BubbleMenu.POSITIONS.BOTTOM_ALIGN_RIGHT,className:"sharing-access-menu o-list-ui o-list-ui--dividers",items:e,shouldShowArrow:!1,disabled:this.props.disabled,verticalDisplacement:d})},t})(r.Component);p.displayName="SharingBubbleMenu",p.defaultProps={allowRelinquishMembership:!1,asButton:!1,canInviteMembers:!1,canMakeViewerNoComment:!1,disabled:!1,pendingAccessChange:void 0},t.SharingBubbleMenu=p}),define("modules/clean/sharing/views/viewer_info",["require","exports"],function(e,t){"use strict";var n=(function(){function e(e){e.when_last_seen&&(this.time_last_seen=new Date(1e3*e.when_last_seen));var t=e.seen_state_user;this.account_id=t.user_id,this.display_name=t.display_name,this.email=t.email,this.photo_circle_url=t.photo_circle_url,this.same_team=!0}return e.prototype.displayName=function(){return this.display_name},e.prototype.memberId=function(){return""},e})();t.ViewerInfo=n}),define("modules/clean/sharing/views/viewer_list_modal",["require","exports","tslib","external/react","modules/clean/react/modal","modules/clean/sharing/views/member_list_item","modules/clean/sharing/ui_util","modules/clean/sharing/views/viewer_info","modules/core/i18n"],function(e,t,n,s,r,o,a,i,l){"use strict";var d=s.createElement,c=(function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.prototype.render=function(){return d(r.Modal,{autoclose:!1,className:"viewer-list-modal",buttonComponent:s.createElement("span",null),onDismissCompleted:this.props.onCancel,title:this._modalTitle()},this._createMemberList())},t.prototype._modalTitle=function(){return this.props.groupName?l._("Members of %(group_name)s who viewed").format({group_name:this.props.groupName}):l._("People who viewed this link")},t.prototype._createMemberList=function(){var e=this.props.seenStateInfo.map(function(e){return new i.ViewerInfo(e)}),t=a.makeMemberSortCmp(this.props.user,this.props.presentAccountIds,!0);return e.sort(t),s.createElement("div",{className:"sharing-member-list"},s.createElement("ul",{className:"o-list-ui u-trim-margin"},e.map(this._renderMemberListItem.bind(this))))},t.prototype._renderMemberListItem=function(e){return d(o.SharingMemberListItem,{canInviteMembers:!1,canMakeViewerNoComment:!1,canRelinquishMembership:!1,contentInfo:this.props.contentInfo,disabled:!1,isMemberActionPending:!1,isPresent:this.props.presentAccountIds.has(e.account_id),isViewOnly:!0,key:e.account_id,member:e,user:this.props.user})},t})(s.Component);t.ViewerListModal=c}),define("modules/clean/sharing/wizard/exp_share_a_folder_wizard_modal",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/image","modules/clean/react/flag","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/radio","modules/clean/react/tooltip","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,s,r,o,a,i,l,d,c,p,u){"use strict";var h=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"new-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:u._("Your Dropbox is full"),buttonComponent:this.getButtons()},this.renderContent())},t.prototype.getButtons=function(){var e=s.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"},s.createElement("button",{className:"c-btn c-btn--secondary",onClick:this.handleSubmit},u._("Share anyway")),s.createElement("a",{className:"c-btn c-btn--primary u-mar-left-s",href:"/pro/out-of-space?oqa=sfcu"},u._("Add more space")));return s.createElement(a.Flag,{spacing:"s",rightAttachment:e})},t.prototype.renderContent=function(){return s.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderRadio(),this.renderFooter())},t.prototype.renderRadio=function(){var e=s.createElement(d.RadioItem,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},s.createElement("span",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},u._("I’d like to create and share a new folder"),this.renderWarningTooltip())),t=s.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},u._("I’d like to share an existing folder"))),n={value:this.state.option,requestChange:this.handleChange};return s.createElement("div",{className:"radio-input"},s.createElement(d.RadioGroup,{legend:u._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.renderWarningTooltip=function(){var e=s.createElement(o,{src:p.static_url("/static/images/out-of-space-lp/error-vflis8APx.png"),srcHiRes:p.static_url("/static/images/out-of-space-lp/error@2x-vflgzXrb2.png")}),t=u._("If you create and share a new folder, your contents will not sync to your Dropbox");return s.createElement(c.Tooltip,{tooltip_classname:"exp-shared-folder-wizard__tooltip",position:c.TooltipPosition.TOP,tooltip_contents:t},e)},t.prototype.renderFooter=function(){return s.createElement("div",{className:"exp-shared-folder-wizard__footer u-mar-top-s"},i.reactFormat(u._("You currently have <warning>0 MB</warning> of personal Dropbox space left."),{warning:s.createElement("span",{className:"exp-shared-folder-wizard__footer--warning"})}))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(s.Component);h.defaultProps={user:{},onSubmit:function(){},expProOQCreateSFVariant:"OFF"};var m=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"new-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:u._("Share a folder from your personal Dropbox"),buttonComponent:this.getButtons()},this.renderContent())},t.prototype.getButtons=function(){var e=s.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"},s.createElement("button",{className:"button-as-link",onClick:this.handleSubmit},u._("Continue sharing")),s.createElement("span",{className:"exp-shared-folder-wizard__buttons-or"},"or"),s.createElement("a",{className:"c-btn c-btn--primary",href:"/pro/out-of-space?oqa=sfcu"},u._("Upgrade now")));return s.createElement(a.Flag,{spacing:"s",rightAttachment:e})},t.prototype.renderContent=function(){return s.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderHeader(),this.renderRadio())},t.prototype.renderHeader=function(){return s.createElement("div",{className:"exp-shared-folder-wizard__header"},u._("Your Dropbox is full. You currently have 0 MB of personal Dropbox space left.")," ",s.createElement("br",null),u._("What would you like to do?"))},t.prototype.renderRadio=function(){var e=s.createElement(d.RadioItem,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title--bold u-l-ib u-pad-left-xs"},u._("Create and share a new folder")),s.createElement("div",{className:"exp-shared-folder-wizard__option-subtext u-l-ib u-pad-left-xs"},s.createElement("span",{className:"exp-shared-folder-wizard__option-subtext--warning"},u._("If you create and share a new folder, it will not sync to your Dropbox.")))),t=s.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title--bold u-l-ib u-pad-left-xs"},u._("Share an existing folder")),s.createElement("div",{className:"exp-shared-folder-wizard__option-subtext u-l-ib u-pad-left-xs"},u._("If you share an existing folder, you will only be able to view contents."))),n={value:this.state.option,requestChange:this.handleChange};return s.createElement("div",{className:"radio-input"},s.createElement(d.RadioGroup,{legend:u._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(s.Component),_=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={option:"existing-folder"},n.handleChange=n.handleChange.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n}return n.__extends(t,e),t.prototype.render=function(){return s.createElement(l.Modal,{autoClose:!1,className:"shared-folder-wizard exp-shared-folder-wizard",title:u._("Your Dropbox is full"),buttonComponent:this.getButtons()},this.renderHeader(),this.renderContent())},t.prototype.getButtons=function(){var e=s.createElement("div",{className:"exp-shared-folder-wizard__buttons u-mar-top-l"},s.createElement("button",{className:"button-as-link",onClick:this.handleSubmit},u._("Continue anyway")),s.createElement("span",{className:"exp-shared-folder-wizard__buttons-or"},"or"),s.createElement("a",{className:"c-btn c-btn--primary",href:"/pro/out-of-space?oqa=sfcu"},u._("Upgrade your plan")));return s.createElement(a.Flag,{spacing:"s",rightAttachment:e})},t.prototype.renderContent=function(){return s.createElement("form",{className:"exp-shared-folder-wizard__contents",onSubmit:this.handleSubmit},this.renderRadio())},t.prototype.renderHeader=function(){return s.createElement("div",{className:"exp-shared-folder-wizard__header"},i.reactFormat(u._("You have 0 MB of personal Dropbox space left. If you create and share a new folder, it will not sync to your Dropbox. <a>Upgrade your plan to sync more shared folders.</a>"),{a:s.createElement("a",{href:"/pro/out-of-space?oqa=sfcu","aria-label":u._("Link to upgrade page")})}))},t.prototype.renderRadio=function(){var e=s.createElement("div",{className:"c-radio-wrapper u-pad-m"},s.createElement("input",{disabled:!0,type:"radio",value:"new-folder",id:"radio-existing-folder-disabled","aria-checked":"false"}),s.createElement("label",{className:"c-radio-content",htmlFor:"radio-existing-folder-disabled"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title--disabled u-l-ib u-pad-left-xs"},u._("I’d like to create and share a new folder")))),t=s.createElement(d.RadioItem,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},s.createElement("div",{className:"exp-shared-folder-wizard__option-title u-l-ib u-pad-left-xs"},u._("I’d like to share an existing folder"))),n={value:this.state.option,requestChange:this.handleChange};return s.createElement("div",{className:"radio-input"},s.createElement(d.RadioGroup,{legend:u._("Share a Folder options"),displayLegend:!1,valueLink:n},e,t))},t.prototype.handleChange=function(e){this.setState({option:e})},t.prototype.handleSubmit=function(e){e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.option)},t})(s.Component);t.ExpShareAFolderWizardModalV3=r(h,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflJyXsMK.css"]),t.ExpShareAFolderWizardModalV4=r(m,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflJyXsMK.css"]),t.ExpShareAFolderWizardModalV5=r(_,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflJyXsMK.css"])}),function(){var e=function(e,n){function s(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return s.prototype=n.prototype,e.prototype=new s,e.__super__=n.prototype,e},t={}.hasOwnProperty;define("modules/clean/sharing/wizard/share_a_folder_wizard_modal",["external/react","modules/clean/react/css","modules/clean/react/flag","modules/clean/react/image","modules/clean/react/input","modules/clean/react_format","modules/clean/react/modal","modules/clean/react/radio","modules/core/i18n","modules/clean/user","modules/clean/static_urls","modules/clean/viewer"],function(t,n,s,r,o,a,i,l,d,c,p,u){var h,m,_,f,g,y,b,v,S,I,E,w;return o.text,E=a.reactFormat,_=i.Modal,f=l.RadioGroup,g=l.RadioItem,y=l.RadioItemVariant,w=p.static_url,S=t.createElement,I=t.DOM,v=d.i18n_default_project("sharing")._,b=t.createClass({displayName:"ShareAFolderWizardModal",propTypes:{onSubmit:t.PropTypes.func,user:t.PropTypes.instanceOf(c).isRequired},getInitialState:function(){return{option:"new-folder"}},render:function(){return S(_,{autoClose:!1,className:"shared-folder-wizard",buttonComponent:I.span(),title:function(){switch(this.props.user.role){case"work":return v("Share a folder from your %(team_name)s Dropbox").format({team_name:u.get_viewer().team_name});case"personal":return v("Share a folder from your personal Dropbox")}}.call(this)},this._renderContent())},_renderContent:function(){return I.form({className:"shared-folder-wizard__contents",onSubmit:(function(e){return function(t){var n;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),e.props.onSubmit(e.state.option)}})(this)},this._renderHeader(),this._renderRadio(),this._renderButtons())},_renderHeader:function(){return I.div({className:"shared-folder-wizard__header u-mar-bottom-s"},v("What would you like to do?"))},_renderRadio:function(){var e;return e={value:this.state.option,requestChange:this._handleChange},I.div({className:"radio-input"},S(f,{variant:y.Normal,legend:v("Share a Folder options"),displayLegend:!1,valueLink:e},this._renderRadioItems()))},_renderRadioItems:function(){var e,t;return t=S(g,{className:"u-pad-m",value:"new-folder",key:"new-folder-option"},I.div({className:"new-folder_title u-l-ib u-pad-left-xs"},v("I’d like to create and share a new folder"))),e=S(g,{className:"u-pad-m",value:"existing-folder",key:"existing-folder-option"},I.div({className:"existing-folder_title u-l-ib u-pad-left-xs"},v("I’d like to share an existing folder"))),[t,e]},_handleChange:function(e){return this.setState({option:e})},_renderButtons:function(){return I.div({className:"u-mar-top-m clearfix"},I.div({className:"u-l-fr"},I.button({className:"c-btn c-btn--primary",onClick:(function(e){return function(t){var n;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),e.props.onSubmit(e.state.option)}})(this)},v("Next"))))}}),h=(function(t){function n(e,t,s){n.__super__.constructor.call(this,e,t,s),this.state.showInterstitial=!0}return e(n,t),n.prototype.render=function(){return this.state.showInterstitial?S(_,{autoClose:!1,className:"shared-folder-wizard-interstitial",buttonComponent:I.span(),title:v("Your Dropbox is full")},this._renderInterstitial()):n.__super__.render.call(this)},n.prototype._renderInterstitial=function(){return I.div({className:"shared-folder-wizard-interstitial"},I.div({className:"shared-folder-wizard-interstitial__content"},I.div({className:"shared-folder-wizard-interstitial__header"},E(v("You currently have <warning>0 MB</warning> of personal Dropbox space left."),{warning:I.span({className:"shared-folder-wizard-interstitial__header--warning"})})),I.div({className:"shared-folder-wizard-interstitial__body"},v("If you create and share a new folder, you can add contents, but it will not sync to your Dropbox."))),I.div({className:"shared-folder-wizard-interstitial__image"},S(r,{src:w("/static/images/pro/overquota/spot-overquota-folder-vflUsxn3C.svg")})),S(s.Flag,{spacing:"s",rightAttachment:I.div({className:"shared-folder-wizard-interstitial__buttons u-mar-top-l"},I.button({className:"c-btn c-btn--secondary",onClick:(function(e){return function(t){return t.nativeEvent.preventDefault(),e.setState({showInterstitial:!1})}})(this)},v("Share anyway")),I.a({className:"c-btn c-btn--primary u-mar-left-s",href:"/upgrade?oqa=sfcu"},v("Add more space")))}))},n})(b),m=(function(t){function n(e,t,s){n.__super__.constructor.call(this,e,t,s)}return e(n,t),n.prototype.render=function(){return S(_,{autoClose:!1,className:"shared-folder-wizard",buttonComponent:I.span(),title:v("Share a folder from your personal Dropbox")},this._renderContentV2())},n.prototype._renderContentV2=function(){return I.form({className:"shared-folder-wizard__contents",onSubmit:(function(e){return function(t){return t.nativeEvent.preventDefault(),e.props.onSubmit(e.state.option)}})(this)},this._renderHeader(),this._renderRadio(),this._renderUpsell())},n.prototype._renderUpsell=function(){return I.div({className:"shared-folder-wizard-upsell u-mar-top-l"},I.div({className:"shared-folder-wizard-upsell__content"},I.div({className:"shared-folder-wizard-upsell__header"},E(v("You currently have <warning>0 MB</warning> of personal Dropbox space left."),{warning:I.span({className:"shared-folder-wizard-upsell__header--warning"})})),I.div({className:"shared-folder-wizard-upsell__body"},"If you create and share a new folder, you can add contents, but it will not sync to your Dropbox.")),I.div({className:"shared-folder-wizard-upsell__image"},S(r,{src:w("/static/images/pro/overquota/spot-overquota-folder-vflUsxn3C.svg")})),S(s.Flag,{spacing:"s",rightAttachment:I.div({className:"shared-folder-wizard-upsell__buttons u-mar-top-l"},I.button({className:"c-btn c-btn--secondary"},v("Share anyway")),I.a({className:"c-btn c-btn--primary u-mar-left-s",href:"/upgrade?oqa=sfcu"},v("Add more space")))}))},n})(b),b=n(b,["/static/css/sharing/wizard_modals-vfl2L3rOp.css"]),h=n(h,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflJyXsMK.css"]),m=n(m,["/static/css/sharing/wizard_modals-vfl2L3rOp.css","/static/css/sharing/exp_wizard_modals-vflJyXsMK.css"]),{ShareAFolderWizardModal:b,ExpShareAFolderWizardModalV1:h,ExpShareAFolderWizardModalV2:m}})}.call(this),function(){define("modules/clean/sharing/wizard/share_existing_folder_wizard_modal",["external/react","modules/clean/react/css","modules/clean/react/input","modules/clean/react/modal","modules/clean/react/tree_view","modules/core/i18n","modules/clean/user","modules/clean/viewer"],function(e,t,n,s,r,o,a,i){var l,d,c,p,u,h;return n.text,d=s.Modal,l=r.FolderTreeView,u=e.createElement,h=e.DOM,p=o.i18n_default_project("sharing")._,c=e.createClass({displayName:"ShareExistingFolderWizardModal",propTypes:{onBack:e.PropTypes.func,onSubmit:e.PropTypes.func,user:e.PropTypes.instanceOf(a).isRequired},getInitialState:function(){return{folderPath:null,errorMsg:null}},render:function(){return u(d,{autoClose:!1,className:"existing-shared-folder-wizard",buttonComponent:h.span(),onDismissCompleted:function(){return d.close()},title:function(){switch(this.props.user.role){case"work":return p("Choose a folder from your %(team_name)s Dropbox").format({team_name:i.get_viewer().team_name});case"personal":return p("Choose a folder from your personal Dropbox")}}.call(this)},this._renderContent())},_renderContent:function(){return h.form({className:"existing-shared-folder-wizard__contents",onSubmit:(function(e){return function(){return e.props.onSubmit(e.state.folderPath,e._setError)}})(this)},this._renderError(),this._renderTreeView(),this._renderButtons())},_renderError:function(){var e;if(null!=this.state.folderPath&&(null!=(e=this.state.errorMsg)?e.length:void 0)>0)return h.div({className:"text-input-error-wrapper"},h.div({className:"text-input-error-text u-font-danger"},this.state.errorMsg))},_renderTreeView:function(){return h.div({className:"wizard-tree-view"},u(l,{user:this.props.user,onFolderSelected:this._setFolderPath,ref:"treeView"}))},_renderButtons:function(){return h.div({className:"u-mar-top-m clearfix"},h.div({className:"u-l-fr"},h.button({className:"c-btn c-btn--primary",disabled:!this._isValid(),onClick:(function(e){return function(t){var n;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),e.props.onSubmit(e.state.folderPath,e._setError)}})(this)},p("Next"))),h.div({className:"u-l-fl"},h.button({className:"button-as-link",style:{lineHeight:"32px"},onClick:(function(e){return function(t){var n,s;return"function"==typeof(n=t.nativeEvent).preventDefault&&n.preventDefault(),d.close(),"function"==typeof(s=e.props).onBack?s.onBack():void 0}})(this)},p("Back"))))},_setFolderPath:function(e){return this.setState({folderPath:e,errorMsg:null})},_setError:function(e){var t;return this.setState({errorMsg:null!=e&&null!=(t=e.path)?t.message_text:void 0})},_isValid:function(){return null!=this.state.folderPath&&null==this.state.errorMsg}}),c=t(c,["/static/css/sharing/wizard_modals-vfl2L3rOp.css"]),{ShareExistingFolderWizardModal:c}})}.call(this),function(){var e=[].slice;define("modules/clean/sharing/wizard/wizard_modals",["external/react","modules/core/notify","modules/clean/account/email","modules/clean/account/email_verify_reasons","modules/clean/analytics","modules/clean/legacy_pyxl_controllers/ajax_form","modules/clean/react/modal","modules/clean/sharing/api","modules/constants/browse","modules/clean/sharing/constants","modules/clean/sharing/share_modal_util","modules/clean/sharing/wizard/share_existing_folder_wizard_modal","modules/clean/sharing/wizard/share_a_folder_wizard_modal","modules/clean/sharing/wizard/exp_share_a_folder_wizard_modal"],function(t,n,s,r,o,a,i,l,d,c,p,u,h,m){var _,f,g,y,b,v,S,I,E,w,C,N,T,P,M,A,k,F;return _=s.EmailVerification,C=o.SharingExperimentsLogger,S=i.Modal,w=l.SharingApi,N=c.TRUELINK,T=p.generateModalSessionId,M=p.showNewFolderShareModal,F=p.showShareModal,E=u.ShareExistingFolderWizardModal,I=h.ShareAFolderWizardModal,f=h.ExpShareAFolderWizardModalV1,g=h.ExpShareAFolderWizardModalV2,y=m.ExpShareAFolderWizardModalV3,b=m.ExpShareAFolderWizardModalV4,v=m.ExpShareAFolderWizardModalV5,P=function(e,t,s,r){var o,i,l;return l=function(){if(!F(e,{fqPath:t,isFolder:!0,exists:!0,origin:"WIZARD",shouldFetchNsId:!0,modalSessionId:null!=r?r:void 0}))throw new Error("Tiburon UI must be allowed")},o=function(e){var t;if(t=a.extract_errors(e.responseText),t!==!1)return"string"==typeof t?n.error(t):"function"==typeof s?s(t):void 0},N.TRUELINK_UI[e.id]?l():(i=new w(e),i.validate_shareable_existing_sf_path(t,l,o))},k=function(n,s,r){return null!=r&&C.log(n.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:r}),S.showInstance(t.createElement(E,{user:n,onBack:s,onSubmit:function(t,s){var o;return o=function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],null!=r&&C.log(n.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD_ERROR",{modalSessionId:r}),s.apply(null,t)},null!=r&&C.log(n.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:r}),P(n,t,o)}}))},A=function(e){var n,s,o;if(_.get_for_user(e).verified_or_show(r.SHARE_FOLDER))return o=T(),C.log(e.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_A_FOLDER_WIZARD",{modalSessionId:o}),n=d.EXP_SUBGROWTH_PRO_OQ_CREATE_SF,s=(function(){switch(n){case"V1":return f;case"V2":return g;case"V3":return y;case"V4":return b;case"V5":return v;default:return I}})(),S.showInstance(t.createElement(s,{user:e,onSubmit:function(t){return null!=o&&C.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_A_FOLDER_WIZARD",{target:t,modalSessionId:o}),"new-folder"===t?M(e,o,e.cdm_tmf_path):"existing-folder"===t?k(e,A.bind(this,e,o),o):void 0},expProOQCreateSFVariant:n}))},{shareExistingFolder:P,showShareAFolderWizardModal:A}})}.call(this),define("modules/clean/teams/admin/api/admin_console_api_client",["require","exports","modules/clean/api_v2/client","modules/clean/filepath","modules/clean/viewer"],function(e,t,n,s,r){"use strict";var o=(function(){function e(e){void 0===e&&(e=!1);var t=r.get_viewer();t.work_user&&(this.teamMemberId=t.work_user.team_member_id),this.userId=t.get_uid_by_role("work"),this.rpcClient=new n.TeamActionsClient,this.isCMForCDM=e}return e.prototype.setPermanentDeletePolicy=function(e){var t={permanent_delete_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_permanent_delete_policy",t)},e.prototype.setMultipleAccountsPolicy=function(e){var t={multiple_accounts_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_multiple_accounts_policy",t)},e.prototype.setFileRequestPolicy=function(e){var t={file_request_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_file_request_policy",t)},e.prototype.setOfficeAddInPolicy=function(e){var t={office_addin_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_office_addin_policy",t)},e.prototype.setSharedLinkPolicy=function(e,t){var n={sharing_outside_enabled:e};1==e&&(n.default_visibility=t);return this.rpcClient.rpc(this.userId,"team/sharing/set_shared_link_policy",n)},e.prototype.setSharedFolderSharingPolicy=function(e){var t={sharing_outside_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_shared_folder_sharing_policy",t)},e.prototype.setSharedFolderJoiningPolicy=function(e){var t={joining_outside_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_shared_folder_joining_policy",t)},e.prototype.setCommentingPolicy=function(e){var t={commenting_enabled:e};return this.rpcClient.rpc(this.userId,"team/sharing/set_commenting_policy",t)},e.prototype.setPasswordStrength=function(e,t){
var n="enabled"===e?t:"minimal_requirements",s={password_strength_policy:n};return this.rpcClient.rpc(this.userId,"team/set_password_requirements",s)},e.prototype.resetAllPasswords=function(){return this.rpcClient.rpc(this.userId,"team/reset_all_passwords")},e.prototype.setPaperPolicy=function(e,t,n,s){var r={paper_enabled:e};t&&(r.dropbox_terms="agree");var o={paper_deployment_type:n,enabled_members_update:{users_to_add:this.make_user_selector_list(s.users_to_add),users_to_remove:this.make_user_selector_list(s.users_to_remove)}};r.paper_deployment_mode=o;return this.rpcClient.rpc(this.userId,"team/paper/set_paper_policy",r)},e.prototype.setPaperSharingPolicy=function(e,t){var n={external_sharing_allowed:void 0===e||e,default_visibility:t};return this.rpcClient.rpc(this.userId,"team/paper/set_paper_sharing_policy",n)},e.prototype.setRequestMembershipPolicy=function(e){var t={request_membership:e};return this.rpcClient.rpc(this.userId,"team/set_request_membership_policy",t)},e.prototype.setSuggestMembersPolicy=function(e){var t={suggest_members_enabled:e};return this.rpcClient.rpc(this.userId,"team/set_suggest_members_policy",t)},e.prototype.deviceManagementGetExcludedUsers=function(){return this.rpcClient.rpc(this.userId,"team/device_management/get_excluded_users",null)},e.prototype.deviceManagementUpdateExcludedUsers=function(e,t){var n={users_to_add:e,users_to_remove:t};return this.rpcClient.rpc(this.userId,"team/device_management/update_excluded_users",n)},e.prototype.deviceManagementConfigureSettings=function(e){return this.rpcClient.rpc(this.userId,"team/device_management/configure_settings",e)},e.mapValueToRolloutMethod=function(e){return 0===e?"unlink_all":1===e?"unlink_most_inactive":"add_member_to_exceptions"},e.prototype.deviceManagementConfigureSettingsForAcf=function(t,n,s,r,o){var a={is_enabled:!0,can_user_remove_device:n,rollout_method:{".tag":e.mapValueToRolloutMethod(o)},users_to_add:t.users_to_add,users_to_remove:t.users_to_remove};a.desktop_devices_limit=s==-1?{".tag":"unlimited"}:{limited:Number(s),".tag":"limited"},a.mobile_devices_limit=r==-1?{".tag":"unlimited"}:{limited:Number(r),".tag":"limited"};return this.rpcClient.rpc(this.userId,"team/device_management/configure_settings",a)},e.prototype.deviceManagementExclusionList=function(e){return this.rpcClient.rpc(this.userId,"team/device_management/update_excluded_users",e)},e.prototype.deviceManagementConfigureSettingsDisable=function(){var e={is_enabled:!1};return this.rpcClient.rpc(this.userId,"team/device_management/configure_settings",e)},e.prototype.deviceManagementRemoveDevice=function(e,t,n){var s={user_id:e,device_id:t,delete_data:n};return this.rpcClient.rpc(this.userId,"team/device_management/remove_device",s)},e.prototype.deviceManagementRemoveClient=function(e,t,n,s){var r={user_id:e,device_id:t,client_unique_identifier:n,delete_data:s};return this.rpcClient.rpc(this.userId,"team/device_management/remove_client",r)},e.prototype.webSessionManagementConfigureSettings=function(e,t){var n={remember_session_expires:e,idle_session_timeout:t};return this.rpcClient.rpc(this.userId,"team/web_session_management/configure_settings",n)},e.prototype.teamFolderArchive=function(e,t){void 0===t&&(t=!1);var n={team_folder_id:String(e),force_async_off:!t};return this.rpcClient.rpc(this.userId,"team/team_folder/archive",n)},e.prototype.teamFolderUnarchive=function(e){var t={team_folder_id:String(e)};return this.rpcClient.rpc(this.userId,"team/team_folder/activate",t)},e.prototype.teamFolderCreate=function(e){var t={name:e};return this.rpcClient.rpc(this.userId,"team/team_folder/create",t)},e.prototype.teamFoldersList=function(e){void 0===e&&(e=1e3);var t={limit:e};return this.rpcClient.rpc(this.userId,"team/team_folder/list",t)},e.prototype.teamFolderRename=function(e,t){var n={team_folder_id:String(e),name:t};return this.rpcClient.rpc(this.userId,"team/team_folder/rename",n)},e.prototype.teamFolderPermanentlyDelete=function(e){var t={team_folder_id:String(e)};return this.rpcClient.rpc(this.userId,"team/team_folder/permanently_delete",t)},e.prototype.setGroupsCreationPolicy=function(e){var t={group_creation:e};return this.rpcClient.rpc(this.userId,"team/groups/set_creation_policy",t)},e.prototype.setNTSBlockTrafficPolicy=function(e){var t={block_traffic_enabled:e};return this.rpcClient.rpc(this.userId,"team/nts/set_block_traffic_policy",t)},e.prototype.configureSso=function(e,t,n,s,r){var o={sso_policy:e,saml_cert:t,sign_in_url:n,sign_out_url:s,nameid_format:r};return this.rpcClient.rpc(this.userId,"team/configure_sso",o)},e.prototype.configureGoogleLoginPolicy=function(e){var t={google_login_enabled:e};return this.rpcClient.rpc(this.userId,"team/configure_google_login_policy",t)},e.prototype.setResellerSupportSetting=function(e){var t={reseller_support_enabled:e};return this.rpcClient.rpc(this.userId,"team/change_reseller_support",t)},e.prototype.folderCreate=function(e,t,n){"/"!=t&&(t+="/");var s="ns:"+e+t+n,r={path:s},o={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/create_folder",r,o)},e.prototype.confidentialFolderCreate=function(e,t,n){"/"!=t&&(t+="/");var s="ns:"+e+t+n,r={path:s,confidentiality:"confidential"},o={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/share_folder_internal",r,o)},e.prototype.bulkFileDelete=function(e){for(var t=[],n=null,s=0,r=e.length;s<r;s++)n=e[s],t.push({path:"ns:"+n.ns_id+n.ns_path});var o={entries:t},a={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/delete_batch_with_changeset_sync",o,a)},e.prototype.fileRename=function(e,t,n){var s="ns:"+e+t,r=t.substring(0,t.lastIndexOf("/"))+"/"+n,o="ns:"+e+r,a={from_path:s,to_path:o,autorename:!0},i={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/move",a,i)},e.prototype.shareFolder=function(e,t,n){void 0===n&&(n=null);var s="ns:"+e+t,r={path:s};if(n)for(var o=0;o<n._keys.length;++o){var a=n._keys[o],i=n[a];"resolved_member_policy"!=a&&i&&(r[a]={".tag":i})}var l={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/share_folder",r,l)},e.prototype.validateFolderPath=function(e,t,n,s){var r="ns:"+e+t,o={path:r,actions:n,list_members_arg:s},a={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/validate_folder_path",o,a)},e.prototype.restoreFile=function(e,t,n){var s="ns:"+e+t,r={path:s,rev:n},o={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/restore",r,o)},e.prototype.permanentDeleteFile=function(e,t){var n="ns:"+e+t,s={path:n},r={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/permanently_delete",s,r)},e.prototype.listRevisions=function(e,t){var n="ns:"+e+t,s={path:n},r={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/list_revisions",s,r)},e.prototype.setTSDWritePolicy=function(e){var t={is_writable:e};return this.rpcClient.rpc(this.userId,"team/team_folder/set_tsd_writable_setting",t)},e.prototype.setInfinitePolicy=function(e){var t={setting:e};return this.rpcClient.rpc(this.userId,"team/set_infinite_policy",t)},e.prototype.setSmartSyncDesktopPolicy=function(e){var t={setting:e};return this.rpcClient.rpc(this.userId,"team/set_smart_sync_desktop_policy",t)},e.prototype.getTeamFolderNsPathForFile=function(e){return this.isCMForCDM?e.fq_path:"/"+e.fq_path.split("/").slice(2).join("/")},e.prototype.bulkFileMove=function(e,t,n){for(var r,o,a=[],i=null,l=0,d=t.length;l<d;l++)r=t[l],i=this.getTeamFolderNsPathForFile(r),o=s.filename(r.fq_path),a.push({from_path:"ns:"+e+i,to_path:"ns:"+e+n+"/"+o});var c={entries:a,autorename:!0},p={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/move_batch_sync",c,p)},e.prototype.bulkFileCopy=function(e,t,n){for(var r,o,a=[],i=null,l=0,d=t.length;l<d;l++)r=t[l],i=this.getTeamFolderNsPathForFile(r),o=s.filename(r.fq_path),a.push({from_path:"ns:"+e+i,to_path:"ns:"+e+n+"/"+o});var c={entries:a,autorename:!0,allow_shared_folder:!0},p={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"files/copy_batch_sync",c,p)},e.prototype.setMemberSpaceLimits=function(e){var t={limit_level:e};return this.rpcClient.rpc(this.userId,"team/member_space_limits/set_default_limit",t)},e.prototype._create_user_selector_json=function(e){return{".tag":"email",email:e}},e.prototype.make_user_selector_list=function(e){return void 0===e&&(e=[]),e.map(this._create_user_selector_json)},e.prototype.memberSpaceLimitsUpdateExclusionList=function(e){var t=this.make_user_selector_list(e.users_to_add),n=this.make_user_selector_list(e.users_to_remove);return this.rpcClient.rpc(this.userId,"team/member_space_limits/update_excluded_users",{users_to_add:t,users_to_remove:n})},e.prototype.listAllMembers=function(e,t){void 0===t&&(t=null);var n={shared_folder_id:String(e)};t&&(n.path=t);var s={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"sharing/list_all_members",n,s)},e.prototype.teamFolderGetAccessPoints=function(e,t,n){var s={dropbox_id:e,team_folder_id:String(t),path:n};return this.rpcClient.rpc(this.userId,"team/team_folder/get_access_points",s)},e.prototype.teamFolderGetFileMetadata=function(e,t){void 0===t&&(t=null);var n={team_folder_id:String(e)};return t&&(n.path=t),this.rpcClient.rpc(this.userId,"team/team_folder/get_file_metadata",n)},e.prototype.getUserInfos=function(e){var t={account_ids:e},n={"Dropbox-API-Select-Admin":this.teamMemberId};return this.rpcClient.rpc(this.userId,"users/get_account_batch",t,n)},e.prototype.emmConfigureSettings=function(e,t){var n=this,s={};["users_to_add","users_to_remove"].forEach(function(e){return s[e]=n.make_user_selector_list(t[e])});var r={emm_policy:{".tag":e},exclusion_list:s};return this.rpcClient.rpc(this.userId,"team/emm/configure_settings",r)},e.prototype.emmRefreshToken=function(){return this.rpcClient.rpc(this.userId,"team/emm/refresh_token")},e.prototype.emmGenerateUsageReport=function(){var e={report_type:"mobile_app_usage"};return this.rpcClient.rpc(this.userId,"team/emm/generate_report",e)},e})();t.AdminConsoleApiClient=o,Object.defineProperty(t,"__esModule",{value:!0}),t.default=o}),function(){define("modules/clean/teams/membership_discovery_util",["modules/clean/ajax","modules/constants/python","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,s,r,o){var a,i,l,d,c,p,u,h,m;return a=t.TRADEMARK_BUSINESS,i=s._,m=s.ungettext,d=function(t,n){return e.WebRequest({url:"/team/discover/get_discoverable_team_for_folder",type:"POST",data:{ns_id:t},success:function(e){return e=JSON.parse(e),n(null!=e?e.team:void 0)},error:function(){return n()}})},u=function(t,s){return e.WebRequest({url:"/team/discover/join_ajax",data:{team_id:t,cont:"#"},success:function(e){switch(e=JSON.parse(e),null!=e?e.result:void 0){case"request_sent":r.success(i("Request to join sent."));break;case"can_join":n.redirect(e.url);break;case"max_team_size_achieved":r.error(i("This team has reached the maximum size. Please ask the admins of this team to upgrade to %(trademark_business)s, which allows teams to add as many members as possible.").format({trademark_business:a}));break;case"pending_approval":r.success(i("Your request to join is pending."));break;default:r.error(i("Invalid request"))}return"function"==typeof s?s(e):void 0},error:function(){return r.error(i("Error sending request.")),"function"==typeof s?s():void 0}})},p=function(t,n,s){return e.WebRequest({url:"/account/team/add_users",subject_user:n,data:{emails:t,team_id:s},success:function(e){var t;if(e=JSON.parse(e),e.num_invited)return t=m("Invitation sent.","Invitations sent.",e.num_invited),r.success(t)},error:function(){var e;return e=m("Error sending invitation.","Error sending invitations.",t.length),r.error(e)}})},c=function(t,s,a){return e.WebRequest({url:"/account/team/add_users",subject_user:s,data:{emails:t,team_id:a},success:function(e){var t;if(e=JSON.parse(e),e.num_invited)return t=m("Invitation sent.","Invitations sent.",e.num_invited),r.success(t)},error:function(){return h(t,function(){return n.redirect(new o({path:"/team/admin/requests",query:{invite_emails:t}}))})}})},h=function(t,n,s){return e.WebRequest({url:"/team/discover/suggest_ajax",data:{emails:JSON.stringify(t)},success:function(e){var s;return s=m("Suggestion sent.","Suggestions sent.",t.length),r.success(s),"function"==typeof n?n(e):void 0},error:function(){var e;return e=m("Error sending suggestion.","Error sending suggestions.",t.length),r.error(e),"function"==typeof s?s():void 0}})},l=function(t,n,s){return e.WebRequest({url:"/team/discover/filter_suggestable_ajax",type:"POST",data:{emails:JSON.stringify(t)},success:function(e){return e=JSON.parse(e),"function"==typeof n?n(e):void 0},error:function(){return"function"==typeof s?s():void 0}})},{getDiscoverableTeamForFolder:d,sendAdminTeamInvitations:c,sendTeamRequest:u,sendLimitedTeamInvitations:p,sendTeamSuggestions:h,filterSuggestableUsers:l}})}.call(this),define("modules/clean/teams/modals/create_team_prompt_modal",["require","exports","tslib","external/react","modules/clean/ajax","modules/clean/analytics","modules/clean/react/button","modules/clean/react/image","modules/clean/react/modal","modules/clean/static_urls","modules/core/browser","modules/core/i18n","modules/core/uri"],function(e,t,n,s,r,o,a,i,l,d,c,p,u){"use strict";var h;(function(e){e[e.CLICK_CREATE=0]="CLICK_CREATE",e[e.DISMISS=1]="DISMISS",e[e.CLICK_NEXT_TIME=2]="CLICK_NEXT_TIME"})(h||(h={}));var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickCreate=function(){var e=t.props.invitedMembers.map(function(e){return e.email}).filter(function(e){return"string"==typeof e&&""!==e}),n=new u({path:"/team",query:{tk:"tib_upsell",invite_members:e.join(",")}});c.redirect(n.toString()),t.logClick(h.CLICK_CREATE)},t.onClickNextTime=function(){l.Modal.close(),t.logClick(h.CLICK_NEXT_TIME)},t.onDismiss=function(){r.WebRequest({url:"/team/stop_show_create_team_modal"}),t.logClick(h.DISMISS)},t}return n.__extends(t,e),t.prototype.logClick=function(e){o.TeamsWebActionsLogger.log("share_crt_team_modal",{num_shared:this.props.invitedMembers.length,clicked_create:e===h.CLICK_CREATE,clicked_nxt_time:e===h.CLICK_NEXT_TIME,dismissed:e===h.DISMISS})},t.prototype.renderButtons=function(){return s.createElement("div",{className:"db-modal-buttons"},s.createElement(a.Button,{className:"dbmodal-button",importance:"primary",onClick:this.onClickCreate},p._("Create free work Dropbox")),s.createElement(a.Button,{className:"dbmodal-button",importance:"tertiary",onClick:this.onClickNextTime},p._("Ask me next time")))},t.prototype.render=function(){for(var e=[],t=0,n=this.props.invitedMembers;t<n.length;t++){var r=n[t];r.name&&r.name!==r.email&&e.push(r.name)}var o=p._("Work with these people often?");return 2===e.length&&2===this.props.invitedMembers.length?o=p._("Work with %(firstname_1)s and %(firstname_2)s often?").format({firstname_1:e[0],firstname_2:e[1]}):3===e.length&&3===this.props.invitedMembers.length&&(o=p._("Work with %(firstname_1)s, %(firstname_2)s, and %(firstname_3)s often?").format({firstname_1:e[0],firstname_2:e[1],firstname_3:e[2]})),s.createElement(l.Modal,{style:"clean",className:"create-team-modal-after-sharing",buttonComponent:this.renderButtons(),onDismiss:this.onDismiss,clickOutToClose:!1,showX:!0,width:500},s.createElement("div",null,s.createElement(i,{className:"create-team-modal__team-illo u-mar-top-l",alt:p._("Work together"),src:d.static_url("/static/images/teams/modals/illo_how-create-vfl99WbqQ.png"),srcHiRes:d.static_url("/static/images/teams/modals/illo_how-create@2x-vflvsB25f.png")}),s.createElement("h1",{className:"create-team-modal__header u-mar-top-m u-mar-bottom-s"},o),s.createElement("div",{className:"create-team-modal__subheader"},p._("Get a free 2 GB work Dropbox to organize projects in one place,               collaborate from anywhere, and stay in sync."))))},t})(s.Component);t.CreateTeamPromptModal=m});
//# sourceMappingURL=pkg-maestro-sharing.min.js-vfllB8dNf.map