(function(){define(["external/flash_detect","external/videojs/video","external/underscore","jquery","modules/clean/ajax","modules/clean/sprite","modules/constants/static","modules/core/browser","modules/core/i18n","require"],function(e,t,n,r,o,a,i,s,l,d){var u;return u=l._,{_video_counter:0,_displayTruncatedMessage:function(){return this._player.addClass("show-truncated-bar")},_retrieveMetadata:function(e){var t;return t=this._displayTruncatedMessage.bind(this),o.SilentBackgroundRequest({url:e,type:"GET",data:{},xhrFields:{withCredentials:!0},success:function(e){if(JSON.parse(e).is_truncated)return n.defer(t)}})},_registerTruncatedBar:function(){var e,r;return r=t.videojs.getComponent("Component"),e=t.videojs.extend(r,{createEl:function(e,t,o){var a;return null==e&&(e="div"),null==t&&(t={}),null==o&&(o={}),t=n.extend(t,{className:"truncated-bar"}),a=r.prototype.createEl.call(this,e,t,o),a.innerText=u("Youâ€™re watching a preview. To watch the full video, download or add it to your Dropbox."),a}}),t.videojs.registerComponent("TruncatedBar",e)},_canPlayFlash:function(){return e.installed&&e.majorAtLeast(10)},_makeSourceTag:function(e,t){return r("<source>",{src:e,type:t})},_makeVideoTag:function(e){var t;return t="video-"+this._video_counter,this._video_counter++,r("<video>",{class:"video-js vjs-default-skin vjs-big-play-centered",id:t,controls:e.controls})},_appendSprite:function(e,t){return e.prepend(r(a.make("web",t,{class:"vjs-"+t+"-icon"})))},_addCustomComponents:function(){return this._registerTruncatedBar(),this._player.addChild("TruncatedBar"),this._appendSprite(r(".vjs-play-control"),"play"),this._appendSprite(r(".vjs-play-control"),"pause"),this._appendSprite(r(".vjs-volume-menu-button"),"volume"),this._appendSprite(r(".vjs-volume-menu-button"),"volumeMuted"),this._appendSprite(r(".vjs-fullscreen-control"),"fullscreen-video"),this._appendSprite(r(".vjs-fullscreen-control"),"exit-fullscreen")},_onReady:function(e){var t;return"function"==typeof e.onReady&&e.onReady(),s.ipad&&(t=0,r(document).on("dropdownOpened modalOpened",function(e,n){return t+=n,r(this._player.el_).children("video").removeAttr("controls")}),r(document).on("dropdownClosed modalClosed",function(e,n){if(t-=n,0===t)return r(this._player.el_).children("video").attr("controls","controls")})),!e.metadata&&e.metadata_link?this._retrieveMetadata(e.metadata_link):e.metadata&&e.metadata.is_truncated?n.defer(this._displayTruncatedMessage):void 0},_getPlayerOptions:function(e){var t,n,r,o,a;for(o={preload:"auto",controls:!0,controlBar:{children:["progressControl","playToggle","currentTimeDisplay","timeDivider","durationDisplay","volumeMenuButton","playbackRateMenuButton","fullscreenToggle"],progressControl:{keepTooltipsInside:!0}},flash:{swf:i.static_url_video_js_swf,flashVars:{contentType:e.type}},techOrder:e.useFlash?["flash"]:["html5"]},a=["width","height","preload","poster","autoplay","playbackRates"],t=0,n=a.length;t<n;t++)r=a[t],null!=e[r]&&(o[r]=e[r]);return o},embed:function(e,n){var r;return null==n&&(n={}),null!=s.msie&&(n.useFlash=!0),n.useFlash&&!this._canPlayFlash()?void("function"==typeof n.onError&&n.onError("needflash")):(r=this._makeVideoTag(n).append(this._makeSourceTag(n.src,n.type)),e.append(r),this._player=t.videojs(r[0],this._getPlayerOptions(n),this._onReady.bind(this,n)),this._addCustomComponents(),n.onEnd&&this._player.on("ended",n.onEnd),n.onError&&this._player.on("error",n.onError),n.onPlay&&this._player.on("play",n.onPlay),n.onCanPlay&&this._player.on("canplay",n.onCanPlay),n.onWaiting&&this._player.on("waiting",n.onWaiting),n.onUserInactive&&this._player.on("userinactive",n.onUserInactive),"function"==typeof n.onEmbed&&n.onEmbed(),this._player)}}})}).call(this);
//# sourceMappingURL=video_loader.min.js-vflCoHsrz.map